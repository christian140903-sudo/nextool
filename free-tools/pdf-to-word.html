<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free PDF to Word Converter Online — Convert PDF to DOCX | NexTool</title>
<meta name="description" content="Convert PDF to Word DOCX free online. Extract text page by page, preserve paragraphs, download as .docx. 100% client-side, no upload, no signup. Fast and private.">
<meta name="keywords" content="pdf to word, pdf to docx, convert pdf to word, pdf to word converter free, pdf converter, free pdf to word, NexTool">
<meta name="robots" content="index, follow">
<meta property="og:title" content="Free PDF to Word Converter Online — Convert PDF to DOCX | NexTool">
<meta property="og:description" content="Convert PDF files to Word DOCX instantly in your browser. Extract text, preserve paragraphs, download .docx. 100% free, no upload needed.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/pdf-to-word.html">
<meta property="og:image" content="https://nextool.app/assets/og-default.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<link rel="canonical" href="https://nextool.app/free-tools/pdf-to-word.html">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free PDF to Word Converter Online — Convert PDF to DOCX | NexTool">
<meta name="twitter:description" content="Convert PDF to Word DOCX free online. No upload, no signup. Fast and private.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"NexTool PDF to Word Converter","applicationCategory":"UtilitiesApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"description":"Free online tool to convert PDF files to Word DOCX format. Extracts text page by page, preserves paragraphs. Runs 100% in your browser with no upload required."}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--border:#2a2a3a;--text:#e4e4eb;--text2:#9494a8;--primary:#6366f1;--accent:#a855f7;--pink:#ec4899;--green:#22c55e;--red:#ef4444;--cyan:#22d3ee;--yellow:#eab308;--radius:12px;--glass:rgba(17,17,24,0.7)}
html{scroll-behavior:smooth}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
/* NAV */
.nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{font-size:1.4rem;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-decoration:none}
.nav-links{display:flex;align-items:center;gap:1.5rem}
.nav-links a{color:var(--text2);text-decoration:none;font-size:.875rem;font-weight:500;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-cta{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff!important;padding:.5rem 1.2rem;border-radius:8px;font-weight:600;-webkit-text-fill-color:#fff!important}
.nav-cta:hover{opacity:.9}
.nav-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}
/* HERO */
.hero{text-align:center;padding:3rem 1.5rem 2rem;max-width:700px;margin:0 auto}
.hero h1{font-size:2.2rem;font-weight:800;line-height:1.2;margin-bottom:.75rem}
.hero h1 span{background:linear-gradient(135deg,var(--primary),var(--accent),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--text2);font-size:1rem}
/* TOOL */
.tool-container{max-width:960px;margin:0 auto;padding:0 1.5rem 3rem}
/* DROP ZONE */
.drop-zone{border:2px dashed var(--border);border-radius:var(--radius);padding:3rem 2rem;text-align:center;cursor:pointer;transition:all .3s;background:var(--glass);backdrop-filter:blur(16px);position:relative}
.drop-zone:hover,.drop-zone.dragover{border-color:var(--primary);background:rgba(99,102,241,.06)}
.drop-zone-icon{font-size:3rem;margin-bottom:.75rem;opacity:.6}
.drop-zone h3{font-size:1.1rem;font-weight:700;margin-bottom:.4rem;color:var(--text)}
.drop-zone p{font-size:.85rem;color:var(--text2)}
.drop-zone input{position:absolute;inset:0;opacity:0;cursor:pointer}
/* FILE INFO */
.file-info-bar{margin-top:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:.75rem 1rem;display:none;align-items:center;gap:.75rem}
.file-info-bar.visible{display:flex}
.file-icon{width:40px;height:40px;border-radius:8px;background:rgba(239,68,68,.12);display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:.75rem;font-weight:700;color:var(--red)}
.file-details{flex:1;min-width:0}
.file-name{font-size:.85rem;font-weight:600;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.file-meta{font-size:.75rem;color:var(--text2);margin-top:2px}
.file-remove{background:none;border:none;color:var(--text2);font-size:1rem;cursor:pointer;padding:4px 8px;border-radius:6px;transition:all .2s;flex-shrink:0}
.file-remove:hover{color:var(--red);background:rgba(239,68,68,.1)}
/* CONTROLS */
.controls{margin-top:1.5rem;display:none;flex-wrap:wrap;gap:.75rem;align-items:center}
.controls.visible{display:flex}
.controls button{background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.55rem 1.2rem;border-radius:8px;font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s;font-family:inherit}
.controls button:hover{border-color:var(--primary);background:rgba(99,102,241,.12)}
.controls button:disabled{opacity:.4;cursor:not-allowed;border-color:var(--border);background:var(--surface2)}
.convert-btn{background:linear-gradient(135deg,var(--primary),var(--accent))!important;border:none!important;color:#fff!important;padding:.6rem 2rem!important;font-size:.9rem!important}
.convert-btn:hover:not(:disabled){opacity:.9;transform:translateY(-1px);box-shadow:0 6px 24px rgba(99,102,241,.3)}
.convert-btn:disabled{opacity:.4!important;transform:none!important;box-shadow:none!important}
/* PROGRESS */
.progress-wrap{margin-top:1rem;display:none}
.progress-wrap.active{display:block}
.progress-bar{width:100%;height:6px;background:var(--surface2);border-radius:3px;overflow:hidden}
.progress-fill{height:100%;width:0%;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:3px;transition:width .3s}
.progress-text{font-size:.75rem;color:var(--text2);margin-top:.4rem;text-align:center}
/* RESULT */
.result-section{margin-top:2rem;display:none}
.result-section.visible{display:block}
.result-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem;flex-wrap:wrap;gap:.5rem}
.result-header h3{font-size:.95rem;font-weight:700}
.result-stats{display:flex;gap:.75rem;flex-wrap:wrap}
.stat-pill{display:inline-flex;align-items:center;gap:.4rem;padding:.3rem .7rem;background:var(--surface);border:1px solid var(--border);border-radius:20px;font-size:.75rem;font-weight:500;color:var(--text2)}
.stat-pill .dot{width:6px;height:6px;border-radius:50%}
.stat-pill .dot.red{background:var(--red)}
.stat-pill .dot.green{background:var(--green)}
.stat-pill .dot.blue{background:var(--primary)}
.download-btn{background:linear-gradient(135deg,var(--green),#16a34a)!important;border:none!important;color:#fff!important;padding:.6rem 2rem!important;font-size:.9rem!important;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s;font-family:inherit}
.download-btn:hover{opacity:.9;transform:translateY(-1px);box-shadow:0 6px 24px rgba(34,197,94,.3)}
/* PREVIEW */
.preview-container{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);max-height:500px;overflow-y:auto}
.preview-content{padding:1.5rem;font-family:'Courier New',monospace;font-size:.85rem;line-height:1.8;color:var(--text);white-space:pre-wrap;word-break:break-word}
.preview-page-header{color:var(--primary);font-weight:700;font-size:.8rem;padding:.4rem .8rem;background:rgba(99,102,241,.08);border-radius:6px;display:inline-block;margin:1rem 0 .5rem;font-family:'Inter',sans-serif}
/* CTA */
.cta-section{text-align:center;padding:4rem 1.5rem;max-width:700px;margin:0 auto}
.cta-section h2{font-size:1.8rem;font-weight:800;margin-bottom:.75rem}
.cta-section h2 span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.cta-section p{color:var(--text2);margin-bottom:1.5rem}
.cta-btn{display:inline-block;background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;padding:.75rem 2rem;border-radius:10px;font-weight:700;text-decoration:none;font-size:1rem;transition:transform .2s,box-shadow .2s}
.cta-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(99,102,241,.3)}
/* FOOTER */
.footer{border-top:1px solid var(--border);padding:3rem 2rem 2rem;max-width:1200px;margin:0 auto}
.footer-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:2rem;margin-bottom:2rem}
.footer-col h4{font-size:.85rem;font-weight:700;margin-bottom:.75rem;color:var(--text)}
.footer-col a{display:block;color:var(--text2);text-decoration:none;font-size:.8rem;margin-bottom:.4rem;transition:color .2s}
.footer-col a:hover{color:var(--primary)}
.footer-bottom{text-align:center;color:var(--text2);font-size:.75rem;padding-top:1.5rem;border-top:1px solid var(--border)}
/* FADE IN */
.fade-in{opacity:0;transform:translateY(20px);transition:opacity .6s,transform .6s}
.fade-in.visible{opacity:1;transform:translateY(0)}
/* TOAST */
.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.6rem 1.2rem;border-radius:10px;font-size:.85rem;font-weight:500;z-index:200;transition:transform .3s;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0)}
/* RESPONSIVE */
@media(max-width:768px){
  .nav-links{display:none;position:absolute;top:64px;left:0;right:0;background:var(--bg);border-bottom:1px solid var(--border);flex-direction:column;padding:1rem 2rem;gap:1rem}
  .nav-links.open{display:flex}
  .nav-toggle{display:block}
  .hero h1{font-size:1.6rem}
  .footer-grid{grid-template-columns:1fr}
  .drop-zone{padding:2rem 1rem}
  .controls{flex-direction:column}
  .controls button{width:100%}
  .result-header{flex-direction:column;align-items:flex-start}
  .preview-container{max-height:350px}
  .file-info-bar{flex-wrap:wrap}
}
</style>
</head>
<body>

<nav class="nav">
  <a href="/" class="nav-logo">NexTool</a>
  <button class="nav-toggle" onclick="document.querySelector('.nav-links').classList.toggle('open')" aria-label="Menu">&#9776;</button>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Tools</a>
    <a href="/free-tools/">Free Tools</a>
    <a href="/blog/">Blog</a>
    <a href="/pro.html" class="nav-cta">Get Pro &mdash; $29</a>
  </div>
</nav>

<section class="hero fade-in">
  <h1>Free <span>PDF to Word</span> Converter</h1>
  <p class="tool-summary" style="color:#94a3b8;font-size:15px;line-height:1.6;margin-bottom:24px;max-width:700px;margin-left:auto;margin-right:auto;">Convert PDF files to Word DOCX format instantly in your browser. Extracts text page by page, preserves paragraph structure, and generates a clean .docx file you can edit in Word, Google Docs, or LibreOffice. Your files never leave your device &mdash; 100% client-side, no signup required.</p>
</section>

<div class="tool-container fade-in">
  <div class="drop-zone" id="dropZone">
    <input type="file" id="fileInput" accept=".pdf,application/pdf">
    <div class="drop-zone-icon">&#128196;</div>
    <h3>Drop a PDF file here</h3>
    <p>or click to browse &mdash; select a .pdf file to convert</p>
  </div>

  <!-- File Info -->
  <div class="file-info-bar" id="fileInfoBar">
    <div class="file-icon">PDF</div>
    <div class="file-details">
      <div class="file-name" id="fileName"></div>
      <div class="file-meta" id="fileMeta"></div>
    </div>
    <button class="file-remove" onclick="clearFile()" title="Remove file">&times;</button>
  </div>

  <!-- Controls -->
  <div class="controls" id="controls">
    <button onclick="chooseNewFile()">Change File</button>
    <button class="convert-btn" id="convertBtn" onclick="convertPDF()">Convert to DOCX</button>
  </div>

  <!-- Progress -->
  <div class="progress-wrap" id="progressWrap">
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    <div class="progress-text" id="progressText">Preparing conversion...</div>
  </div>

  <!-- Result -->
  <div class="result-section" id="resultSection">
    <div class="result-header">
      <h3>Conversion Complete</h3>
      <button class="download-btn" id="downloadBtn" onclick="downloadDocx()">Download .docx</button>
    </div>
    <div class="result-stats" id="resultStats"></div>
    <div style="margin-top:.75rem;margin-bottom:.75rem;display:flex;align-items:center;justify-content:space-between">
      <span style="font-size:.8rem;font-weight:600;color:var(--text2)">Extracted Text Preview</span>
      <button onclick="copyText()" style="background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.35rem .8rem;border-radius:6px;font-size:.75rem;font-weight:600;cursor:pointer;font-family:inherit;transition:all .2s">Copy Text</button>
    </div>
    <div class="preview-container">
      <div class="preview-content" id="previewContent"></div>
    </div>
  </div>
</div>

<section class="cta-section fade-in">
  <h2>Need something <span>more powerful</span>?</h2>
  <p>Let us build it for you. Custom APIs, dashboards, automations &mdash; whatever you need.</p>
  <a href="/#contact" class="cta-btn">Start a Project &rarr;</a>
</section>

<!-- Cross Promo -->
<section style="max-width:900px;margin:40px auto;padding:0 24px;">
<div style="background:linear-gradient(135deg,rgba(99,102,241,0.1),rgba(168,85,247,0.08));border:1px solid rgba(99,102,241,0.15);border-radius:20px;padding:32px 28px;text-align:center;">
<div style="font-size:13px;color:#818cf8;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Founding Member</div>
<h3 style="font-size:22px;font-weight:800;color:#fff;margin:0 0 8px;">Get NexTool Pro</h3>
<p style="color:#94a3b8;font-size:14px;margin:0 auto 20px;max-width:500px;">No banners, clean output, enhanced features on all 250+ tools. One-time payment.</p>
<div style="display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;">
<a href="/pro.html" style="display:inline-block;padding:12px 28px;background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);color:#fff;border-radius:10px;font-weight:700;font-size:15px;text-decoration:none;">$29 &mdash; Get Pro</a>
<a href="/free-tools/" style="color:#94a3b8;font-size:14px;text-decoration:none;">Browse 250+ Free Tools &rarr;</a>
</div>
</div>
</section>


<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/box-shadow-generator.html" style="color:var(--primary);text-decoration:none">CSS Box Shadow Generator</a> · <a href="/free-tools/emoji-picker.html" style="color:var(--primary);text-decoration:none">Emoji Picker & Search</a> · <a href="/free-tools/json-to-yaml-converter.html" style="color:var(--primary);text-decoration:none">Free JSON to YAML Converter</a></p>
</div>
<footer class="footer fade-in">
  <div class="footer-grid">
    <div class="footer-col">
      <h4>Products</h4>
      <a href="/free-tools/">250+ Free Tools</a>
<a href="/pro.html">NexTool Pro</a>
<a href="/workspace.html">Workspace</a>
    </div>
    <div class="footer-col">
      <h4>Explore</h4>
      <a href="/free-tools/">Free Tools</a><a href="/blog/">Blog</a><a href="/pro.html">FAQ</a><a href="/pro.html">Pro &mdash; $29</a>
    </div>
    <div class="footer-col">
      <h4>Ecosystem</h4>
      <a href="/">NexTool Home</a><a href="/#contact">Contact</a><a href="https://github.com/christian140903-sudo/nextool" target="_blank">GitHub</a>
    </div>
  </div>
  <div class="footer-bottom">&copy; 2026 NexTool. AI-powered tools for everyone.</div>
</footer>

<div class="toast" id="toast"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.min.js"></script>
<script>
/* Set pdf.js worker */
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

var dropZone = document.getElementById('dropZone');
var fileInput = document.getElementById('fileInput');
var fileInfoBar = document.getElementById('fileInfoBar');
var fileNameEl = document.getElementById('fileName');
var fileMetaEl = document.getElementById('fileMeta');
var controlsEl = document.getElementById('controls');
var convertBtn = document.getElementById('convertBtn');
var progressWrap = document.getElementById('progressWrap');
var progressFill = document.getElementById('progressFill');
var progressText = document.getElementById('progressText');
var resultSection = document.getElementById('resultSection');
var resultStats = document.getElementById('resultStats');
var previewContent = document.getElementById('previewContent');

var currentFile = null;
var extractedPages = []; /* Array of {pageNum, text} */
var docxBlob = null;
var totalChars = 0;

/* ---- Drop Zone ---- */
dropZone.addEventListener('dragover', function(e) {
  e.preventDefault();
  dropZone.classList.add('dragover');
});
dropZone.addEventListener('dragleave', function() {
  dropZone.classList.remove('dragover');
});
dropZone.addEventListener('drop', function(e) {
  e.preventDefault();
  dropZone.classList.remove('dragover');
  var files = e.dataTransfer.files;
  if (files.length > 0) handleFile(files[0]);
});
fileInput.addEventListener('change', function() {
  if (fileInput.files.length > 0) handleFile(fileInput.files[0]);
  fileInput.value = '';
});

function handleFile(file) {
  if (!file.name.toLowerCase().endsWith('.pdf') && file.type !== 'application/pdf') {
    showToast('Please select a PDF file');
    return;
  }
  currentFile = file;
  extractedPages = [];
  docxBlob = null;
  totalChars = 0;

  fileNameEl.textContent = file.name;
  fileMetaEl.textContent = formatBytes(file.size);
  fileInfoBar.classList.add('visible');
  controlsEl.classList.add('visible');
  convertBtn.disabled = false;
  resultSection.classList.remove('visible');
  dropZone.style.display = 'none';
}

function chooseNewFile() {
  var inp = document.createElement('input');
  inp.type = 'file';
  inp.accept = '.pdf,application/pdf';
  inp.addEventListener('change', function() {
    if (inp.files.length > 0) handleFile(inp.files[0]);
  });
  inp.click();
}

function clearFile() {
  currentFile = null;
  extractedPages = [];
  docxBlob = null;
  totalChars = 0;
  fileInfoBar.classList.remove('visible');
  controlsEl.classList.remove('visible');
  resultSection.classList.remove('visible');
  dropZone.style.display = '';
}

/* ---- Convert ---- */
async function convertPDF() {
  if (!currentFile) {
    showToast('Please select a PDF file first');
    return;
  }

  convertBtn.disabled = true;
  progressWrap.classList.add('active');
  progressFill.style.width = '0%';
  progressText.textContent = 'Loading PDF...';
  resultSection.classList.remove('visible');

  try {
    var arrayBuffer = await currentFile.arrayBuffer();
    var pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
    var numPages = pdf.numPages;

    progressText.textContent = 'Extracting text from ' + numPages + ' page' + (numPages !== 1 ? 's' : '') + '...';

    extractedPages = [];
    totalChars = 0;

    for (var i = 1; i <= numPages; i++) {
      var pct = Math.round((i / numPages) * 70);
      progressFill.style.width = pct + '%';
      progressText.textContent = 'Extracting page ' + i + ' of ' + numPages + '...';

      var page = await pdf.getPage(i);
      var textContent = await page.getTextContent();

      /* Build text from items, respecting vertical positions for paragraph breaks */
      var text = '';
      var lastY = null;
      var lastItemEndX = 0;
      for (var j = 0; j < textContent.items.length; j++) {
        var item = textContent.items[j];
        if (item.str === undefined) continue;

        var y = item.transform[5];
        var x = item.transform[4];
        var itemHeight = item.height || 12;

        if (lastY !== null) {
          var yDiff = Math.abs(lastY - y);
          if (yDiff > itemHeight * 1.5) {
            /* Large vertical gap = new paragraph */
            text += '\n\n';
          } else if (yDiff > itemHeight * 0.3) {
            /* Small vertical gap = new line */
            text += '\n';
          } else if (x > lastItemEndX + 2) {
            /* Same line but horizontal gap = space */
            text += ' ';
          }
        }

        text += item.str;
        lastY = y;
        lastItemEndX = x + (item.width || 0);
      }

      text = text.trim();
      if (text.length > 0) {
        extractedPages.push({ pageNum: i, text: text });
        totalChars += text.length;
      }
    }

    if (extractedPages.length === 0) {
      showToast('No extractable text found in this PDF. The PDF may contain only images.');
      progressWrap.classList.remove('active');
      convertBtn.disabled = false;
      return;
    }

    /* Generate DOCX */
    progressFill.style.width = '75%';
    progressText.textContent = 'Generating DOCX file...';

    await generateDocx();

    progressFill.style.width = '100%';
    progressText.textContent = 'Conversion complete!';

    setTimeout(function() {
      progressWrap.classList.remove('active');
      progressFill.style.width = '0%';
    }, 2000);

    showResult(numPages);
    convertBtn.disabled = false;
    showToast('PDF converted successfully! ' + extractedPages.length + ' page' + (extractedPages.length !== 1 ? 's' : '') + ' extracted.');

  } catch (err) {
    console.error('Conversion error:', err);
    progressWrap.classList.remove('active');
    convertBtn.disabled = false;
    showToast('Error: ' + (err.message || 'Could not convert PDF'));
  }
}

/* ---- Generate DOCX using docx.js ---- */
async function generateDocx() {
  var children = [];

  for (var i = 0; i < extractedPages.length; i++) {
    var pg = extractedPages[i];

    /* Page header */
    children.push(
      new docx.Paragraph({
        children: [
          new docx.TextRun({
            text: 'Page ' + pg.pageNum,
            bold: true,
            size: 28,
            color: '6366f1',
            font: 'Arial'
          })
        ],
        spacing: { before: i > 0 ? 400 : 0, after: 200 },
        border: {
          bottom: { style: docx.BorderStyle.SINGLE, size: 1, color: 'cccccc' }
        }
      })
    );

    /* Split text into paragraphs */
    var paragraphs = pg.text.split(/\n\n+/);
    for (var j = 0; j < paragraphs.length; j++) {
      var paraText = paragraphs[j].trim();
      if (paraText.length === 0) continue;

      /* Split by single newlines into runs within the paragraph */
      var lines = paraText.split(/\n/);
      var runs = [];
      for (var k = 0; k < lines.length; k++) {
        if (k > 0) {
          runs.push(new docx.TextRun({ break: 1 }));
        }
        runs.push(new docx.TextRun({
          text: lines[k],
          size: 24,
          font: 'Calibri'
        }));
      }

      children.push(
        new docx.Paragraph({
          children: runs,
          spacing: { after: 120 }
        })
      );
    }

    /* Add page break between pages (except last) */
    if (i < extractedPages.length - 1) {
      children.push(
        new docx.Paragraph({
          children: [],
          pageBreakBefore: true
        })
      );
    }
  }

  var doc = new docx.Document({
    creator: 'NexTool PDF to Word Converter',
    title: currentFile.name.replace(/\.pdf$/i, ''),
    description: 'Converted from PDF by NexTool',
    sections: [{
      properties: {
        page: {
          margin: {
            top: 1440,
            right: 1440,
            bottom: 1440,
            left: 1440
          }
        }
      },
      children: children
    }]
  });

  docxBlob = await docx.Packer.toBlob(doc);
}

/* ---- Show Result ---- */
function showResult(totalPages) {
  resultSection.classList.add('visible');

  var statsHtml = '';
  statsHtml += '<span class="stat-pill"><span class="dot red"></span> Input: ' + formatBytes(currentFile.size) + '</span>';
  statsHtml += '<span class="stat-pill"><span class="dot green"></span> Output: ' + formatBytes(docxBlob.size) + '</span>';
  statsHtml += '<span class="stat-pill"><span class="dot blue"></span> ' + totalPages + ' page' + (totalPages !== 1 ? 's' : '') + '</span>';
  statsHtml += '<span class="stat-pill">' + totalChars.toLocaleString() + ' characters</span>';
  resultStats.innerHTML = statsHtml;

  /* Render preview */
  var previewHtml = '';
  for (var i = 0; i < extractedPages.length; i++) {
    var pg = extractedPages[i];
    previewHtml += '<span class="preview-page-header">Page ' + pg.pageNum + '</span>\n';
    previewHtml += escHtml(pg.text) + '\n\n';
  }
  previewContent.innerHTML = previewHtml;

  resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

/* ---- Download ---- */
function downloadDocx() {
  if (!docxBlob) {
    showToast('No DOCX file ready yet');
    return;
  }
  var filename = currentFile.name.replace(/\.pdf$/i, '') + '.docx';
  var url = URL.createObjectURL(docxBlob);
  var a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  setTimeout(function() { URL.revokeObjectURL(url); }, 1000);
  showToast('Downloaded ' + filename);
}

/* ---- Copy Text ---- */
function copyText() {
  if (extractedPages.length === 0) {
    showToast('No text to copy');
    return;
  }
  var allText = extractedPages.map(function(pg) {
    return '--- Page ' + pg.pageNum + ' ---\n' + pg.text;
  }).join('\n\n');

  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(allText).then(function() {
      showToast('Text copied to clipboard');
    });
  } else {
    var ta = document.createElement('textarea');
    ta.value = allText;
    document.body.appendChild(ta);
    ta.select();
    document.execCommand('copy');
    document.body.removeChild(ta);
    showToast('Text copied to clipboard');
  }
}

/* ---- Helpers ---- */
function formatBytes(bytes) {
  if (bytes === 0) return '0 B';
  var k = 1024, sizes = ['B', 'KB', 'MB', 'GB'];
  var i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
}

function escHtml(s) {
  return s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
}

function showToast(msg) {
  var t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(function() { t.classList.remove('show'); }, 2500);
}

/* IntersectionObserver fade-in */
var observer = new IntersectionObserver(function(entries) {
  entries.forEach(function(entry) {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');
      observer.unobserve(entry.target);
    }
  });
}, { threshold: 0.1 });
document.querySelectorAll('.fade-in').forEach(function(el) { observer.observe(el); });
</script>
<script src="/js/analytics-lite.js" defer></script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "How do I convert PDF to Word for free?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Simply drag and drop your PDF file into NexTool's PDF to Word Converter. The tool extracts text from every page and generates a .docx file you can download instantly. No signup, no upload to servers, and completely free."
      }
    },
    {
      "@type": "Question",
      "name": "Is it safe to convert PDF to Word online with this tool?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, completely safe. NexTool's PDF to Word Converter runs 100% in your browser using pdf.js and docx.js. Your PDF file is never uploaded to any server. All processing happens locally on your device, ensuring complete privacy and security."
      }
    },
    {
      "@type": "Question",
      "name": "What formatting is preserved when converting PDF to Word?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The converter extracts all text content from your PDF page by page, preserving paragraph breaks and line structure. The generated DOCX file uses clean formatting with proper page breaks between PDF pages. Note that complex layouts, images, and special fonts in the PDF are converted as plain text."
      }
    },
    {
      "@type": "Question",
      "name": "Can I convert scanned PDFs to Word?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "This tool works with text-based PDFs (PDFs where the text can be selected). Scanned PDFs that contain only images require OCR (Optical Character Recognition) which is not supported by this client-side tool. For scanned PDFs, you would need a server-side OCR solution."
      }
    },
    {
      "@type": "Question",
      "name": "What is the maximum file size for PDF to Word conversion?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Since the conversion runs entirely in your browser, there is no strict file size limit imposed by a server. However, very large PDFs (over 50MB) may be slow to process depending on your device's memory and processing power. For best results, use PDFs under 20MB."
      }
    }
  ]
}
</script>
</body>
</html>

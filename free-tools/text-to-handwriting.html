<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Text to Handwriting Converter — Generate Realistic Notes | NexTool</title>
<meta name="description" content="Convert typed text to realistic handwriting-style images. Choose styles, pen colors, paper types. Download as PNG or PDF. 100% free, no signup, runs in your browser.">
<meta name="keywords" content="text to handwriting, handwriting generator, handwriting converter, fake handwriting, handwriting image, handwritten notes, free online tool, NexTool">
<meta name="robots" content="index, follow">
<meta property="og:title" content="Free Text to Handwriting Converter | NexTool">
<meta property="og:description" content="Turn typed text into realistic handwriting images. Multiple styles, colors, and paper types. Download as PNG or PDF. 100% free.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/text-to-handwriting.html">
<meta property="og:image" content="https://nextool.app/assets/og-default.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<link rel="canonical" href="https://nextool.app/free-tools/text-to-handwriting.html">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free Text to Handwriting Converter | NexTool">
<meta name="twitter:description" content="Convert text to handwriting-style images. Free online tool by NexTool.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"NexTool Text to Handwriting Converter","applicationCategory":"DesignApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"description":"Free online tool to convert typed text into realistic handwriting-style images with multiple styles, pen colors, and paper backgrounds."}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--border:#2a2a3a;--text:#e4e4eb;--text2:#9494a8;--primary:#6366f1;--accent:#a855f7;--pink:#ec4899;--green:#22c55e;--red:#ef4444;--cyan:#22d3ee;--yellow:#eab308;--radius:12px;--glass:rgba(17,17,24,0.7)}
html{scroll-behavior:smooth}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
/* NAV */
.nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{font-size:1.4rem;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-decoration:none}
.nav-links{display:flex;align-items:center;gap:1.5rem}
.nav-links a{color:var(--text2);text-decoration:none;font-size:.875rem;font-weight:500;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-cta{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff!important;padding:.5rem 1.2rem;border-radius:8px;font-weight:600;-webkit-text-fill-color:#fff!important}
.nav-cta:hover{opacity:.9}
.nav-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}
/* HERO */
.hero{text-align:center;padding:3rem 1.5rem 2rem;max-width:700px;margin:0 auto}
.hero h1{font-size:2.2rem;font-weight:800;line-height:1.2;margin-bottom:.75rem}
.hero h1 span{background:linear-gradient(135deg,var(--primary),var(--accent),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--text2);font-size:1rem}
/* TOOL */
.tool-container{max-width:1200px;margin:0 auto;padding:0 1.5rem 3rem}
.tool-grid{display:grid;grid-template-columns:320px 1fr;gap:1.5rem;align-items:start}
.panel{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;display:flex;flex-direction:column}
.panel-header{padding:.6rem 1rem;border-bottom:1px solid var(--border);font-size:.8rem;font-weight:600;color:var(--text2);display:flex;justify-content:space-between;align-items:center;background:rgba(26,26,36,0.5)}
.panel-body{padding:1rem;display:flex;flex-direction:column;gap:.85rem}
/* Controls */
.ctrl-group{display:flex;flex-direction:column;gap:.35rem}
.ctrl-group label{font-size:.75rem;font-weight:600;color:var(--text2);text-transform:uppercase;letter-spacing:.5px}
.ctrl-group textarea{width:100%;min-height:140px;background:var(--surface2);border:1px solid var(--border);color:var(--text);font-family:'Inter',sans-serif;font-size:.85rem;padding:.6rem;border-radius:8px;resize:vertical;outline:none;line-height:1.6;transition:border-color .2s}
.ctrl-group textarea:focus{border-color:var(--primary)}
.ctrl-group textarea::placeholder{color:var(--text2);opacity:.5}
.ctrl-group select,.ctrl-group input[type="range"]{width:100%;background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.45rem .6rem;border-radius:8px;font-size:.8rem;font-family:inherit;outline:none;transition:border-color .2s}
.ctrl-group select:focus,.ctrl-group input[type="color"]:focus{border-color:var(--primary)}
.ctrl-group select{appearance:none;padding-right:1.8rem;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%239494a8' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .6rem center}
.ctrl-row{display:flex;gap:.75rem;align-items:end}
.ctrl-row .ctrl-group{flex:1}
.color-input-wrap{display:flex;gap:.5rem;align-items:center}
.color-input-wrap input[type="color"]{width:36px;height:36px;border:1px solid var(--border);border-radius:8px;cursor:pointer;background:none;padding:2px}
.color-input-wrap input[type="color"]::-webkit-color-swatch-wrapper{padding:0}
.color-input-wrap input[type="color"]::-webkit-color-swatch{border-radius:6px;border:none}
.color-hex{font-size:.75rem;color:var(--text2);font-family:'Courier New',monospace}
.range-wrap{display:flex;align-items:center;gap:.5rem}
.range-wrap input[type="range"]{flex:1;-webkit-appearance:none;background:var(--surface2);border:1px solid var(--border);height:6px;border-radius:3px;outline:none}
.range-wrap input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:var(--primary);cursor:pointer}
.range-val{font-size:.75rem;color:var(--text2);min-width:28px;text-align:right}
.style-grid{display:grid;grid-template-columns:1fr 1fr;gap:.4rem}
.style-btn{padding:.5rem;background:var(--surface2);border:1px solid var(--border);color:var(--text);border-radius:8px;font-size:.75rem;font-weight:500;cursor:pointer;transition:all .2s;text-align:center;font-family:inherit}
.style-btn:hover{border-color:var(--primary);background:rgba(99,102,241,.08)}
.style-btn.active{background:linear-gradient(135deg,var(--primary),var(--accent));border-color:transparent;color:#fff}
/* Actions */
.action-bar{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:.5rem}
.action-bar button{background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.5rem .9rem;border-radius:8px;font-size:.78rem;font-weight:500;cursor:pointer;transition:all .2s;font-family:inherit;display:flex;align-items:center;gap:.35rem}
.action-bar button:hover{border-color:var(--primary);background:rgba(99,102,241,.12)}
.action-bar button.primary-btn{background:linear-gradient(135deg,var(--primary),var(--accent));border-color:transparent;color:#fff}
.action-bar button.primary-btn:hover{opacity:.9}
/* Canvas */
.canvas-wrap{position:relative;overflow:auto;max-height:700px;background:var(--surface);border-radius:8px;display:flex;align-items:start;justify-content:center;padding:1rem}
.canvas-wrap canvas{border-radius:4px;box-shadow:0 4px 24px rgba(0,0,0,.4);max-width:100%;height:auto}
/* CTA */
.cta-section{text-align:center;padding:4rem 1.5rem;max-width:700px;margin:0 auto}
.cta-section h2{font-size:1.8rem;font-weight:800;margin-bottom:.75rem}
.cta-section h2 span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.cta-section p{color:var(--text2);margin-bottom:1.5rem}
.cta-btn{display:inline-block;background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;padding:.75rem 2rem;border-radius:10px;font-weight:700;text-decoration:none;font-size:1rem;transition:transform .2s,box-shadow .2s}
.cta-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(99,102,241,.3)}
/* FOOTER */
.footer{border-top:1px solid var(--border);padding:3rem 2rem 2rem;max-width:1200px;margin:0 auto}
.footer-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:2rem;margin-bottom:2rem}
.footer-col h4{font-size:.85rem;font-weight:700;margin-bottom:.75rem;color:var(--text)}
.footer-col a{display:block;color:var(--text2);text-decoration:none;font-size:.8rem;margin-bottom:.4rem;transition:color .2s}
.footer-col a:hover{color:var(--primary)}
.footer-bottom{text-align:center;color:var(--text2);font-size:.75rem;padding-top:1.5rem;border-top:1px solid var(--border)}
/* FADE IN */
.fade-in{opacity:0;transform:translateY(20px);transition:opacity .6s,transform .6s}
.fade-in.visible{opacity:1;transform:translateY(0)}
/* TOAST */
.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.6rem 1.2rem;border-radius:10px;font-size:.85rem;font-weight:500;z-index:200;transition:transform .3s;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0)}
/* RESPONSIVE */
@media(max-width:768px){
  .tool-grid{grid-template-columns:1fr}
  .nav-links{display:none;position:absolute;top:64px;left:0;right:0;background:var(--bg);border-bottom:1px solid var(--border);flex-direction:column;padding:1rem 2rem;gap:1rem}
  .nav-links.open{display:flex}
  .nav-toggle{display:block}
  .hero h1{font-size:1.6rem}
  .footer-grid{grid-template-columns:1fr}
  .canvas-wrap{max-height:400px}
}
</style>
</head>
<body>

<nav class="nav">
  <a href="/" class="nav-logo">NexTool</a>
  <button class="nav-toggle" onclick="document.querySelector('.nav-links').classList.toggle('open')" aria-label="Menu">&#9776;</button>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Tools</a>
    <a href="/free-tools/">Free Tools</a>
    <a href="/blog/">Blog</a>
    <a href="/pro.html" class="nav-cta">Get Pro &mdash; $29</a>
  </div>
</nav>

<section class="hero fade-in">
  <h1>Free <span>Text to Handwriting</span> Converter</h1>
  <p class="tool-summary" style="color:#94a3b8;font-size:15px;line-height:1.6;margin-bottom:24px;max-width:700px;margin-left:auto;margin-right:auto;">Turn any typed text into realistic handwriting-style images. Choose from multiple handwriting styles, pen colors, paper backgrounds, and more. Download as PNG or PDF. 100% browser-based, no signup required.</p>
</section>

<div class="tool-container fade-in">
  <div class="tool-grid">
    <!-- Left: Controls -->
    <div class="panel">
      <div class="panel-header"><span>Settings</span></div>
      <div class="panel-body">
        <div class="ctrl-group">
          <label>Your Text</label>
          <textarea id="textInput" placeholder="Type or paste your text here...&#10;&#10;The handwriting preview updates live as you type." spellcheck="false"></textarea>
        </div>

        <div class="ctrl-group">
          <label>Handwriting Style</label>
          <div class="style-grid">
            <button class="style-btn active" data-style="casual" onclick="setStyle('casual',this)">Casual</button>
            <button class="style-btn" data-style="neat" onclick="setStyle('neat',this)">Neat</button>
            <button class="style-btn" data-style="messy" onclick="setStyle('messy',this)">Messy</button>
            <button class="style-btn" data-style="cursive" onclick="setStyle('cursive',this)">Cursive</button>
          </div>
        </div>

        <div class="ctrl-row">
          <div class="ctrl-group">
            <label>Pen Color</label>
            <div class="color-input-wrap">
              <input type="color" id="penColor" value="#1a237e">
              <span class="color-hex" id="penHex">#1a237e</span>
            </div>
          </div>
          <div class="ctrl-group">
            <label>Pen Thickness</label>
            <div class="range-wrap">
              <input type="range" id="penThickness" min="1" max="5" value="2" step="0.5">
              <span class="range-val" id="penThickVal">2</span>
            </div>
          </div>
        </div>

        <div class="ctrl-group">
          <label>Paper Background</label>
          <select id="paperBg">
            <option value="white">White</option>
            <option value="lined" selected>Lined</option>
            <option value="grid">Grid</option>
            <option value="aged">Aged / Vintage</option>
          </select>
        </div>

        <div class="ctrl-row">
          <div class="ctrl-group">
            <label>Font Size</label>
            <select id="fontSize">
              <option value="small">Small</option>
              <option value="medium" selected>Medium</option>
              <option value="large">Large</option>
            </select>
          </div>
          <div class="ctrl-group">
            <label>Line Spacing</label>
            <div class="range-wrap">
              <input type="range" id="lineSpacing" min="1" max="3" value="1.8" step="0.1">
              <span class="range-val" id="lineSpaceVal">1.8</span>
            </div>
          </div>
        </div>

        <div class="ctrl-group">
          <label>Paper Size</label>
          <select id="paperSize">
            <option value="a4">A4 (210 x 297 mm)</option>
            <option value="letter">Letter (8.5 x 11 in)</option>
            <option value="custom">Custom (800 x 600)</option>
          </select>
        </div>

        <div class="action-bar">
          <button class="primary-btn" onclick="downloadPNG()" title="Download as PNG image">PNG</button>
          <button class="primary-btn" onclick="downloadPDF()" title="Download as multi-page PDF">PDF</button>
          <button onclick="copyImage()" title="Copy image to clipboard">Copy</button>
          <button onclick="clearAll()" title="Clear text and reset">Clear</button>
        </div>
      </div>
    </div>

    <!-- Right: Canvas Preview -->
    <div class="panel">
      <div class="panel-header"><span>Preview</span><span id="previewInfo"></span></div>
      <div class="canvas-wrap">
        <canvas id="hwCanvas" width="794" height="1123"></canvas>
      </div>
    </div>
  </div>
</div>

<section class="cta-section fade-in">
  <h2>Need something <span>more powerful</span>?</h2>
  <p>Let us build it for you. Custom APIs, dashboards, automations &mdash; whatever you need.</p>
  <a href="/#contact" class="cta-btn">Start a Project &rarr;</a>
</section>

<!-- Cross Promo -->
<section style="max-width:900px;margin:40px auto;padding:0 24px;">
<div style="background:linear-gradient(135deg,rgba(99,102,241,0.1),rgba(168,85,247,0.08));border:1px solid rgba(99,102,241,0.15);border-radius:20px;padding:32px 28px;text-align:center;">
<div style="font-size:13px;color:#818cf8;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Founding Member</div>
<h3 style="font-size:22px;font-weight:800;color:#fff;margin:0 0 8px;">Get NexTool Pro</h3>
<p style="color:#94a3b8;font-size:14px;margin:0 auto 20px;max-width:500px;">No banners, clean output, enhanced features on all 228+ tools. One-time payment.</p>
<div style="display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;">
<a href="/pro.html" style="display:inline-block;padding:12px 28px;background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);color:#fff;border-radius:10px;font-weight:700;font-size:15px;text-decoration:none;">$29 &mdash; Get Pro</a>
<a href="/free-tools/" style="color:#94a3b8;font-size:14px;text-decoration:none;">Browse 228+ Free Tools &rarr;</a>
</div>
</div>
</section>

<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/box-shadow-generator.html" style="color:var(--primary);text-decoration:none">CSS Box Shadow Generator</a> · <a href="/free-tools/css-animation-generator.html" style="color:var(--primary);text-decoration:none">CSS Animation Generator - Free Tool</a> · <a href="/free-tools/emoji-picker.html" style="color:var(--primary);text-decoration:none">Emoji Picker & Search</a></p>
</div>

<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/json-to-yaml-converter.html" style="color:var(--primary);text-decoration:none">Free JSON to YAML Converter</a> · <a href="/free-tools/accessibility-checker.html" style="color:var(--primary);text-decoration:none">Free Accessibility Checker</a> · <a href="/free-tools/api-request-builder.html" style="color:var(--primary);text-decoration:none">Free API Request Builder</a></p>
</div>
<footer class="footer fade-in">
  <div class="footer-grid">
    <div class="footer-col">
      <h4>Products</h4>
      <a href="/free-tools/">228+ Free Tools</a>
<a href="/pro.html">NexTool Pro</a>
<a href="/workspace.html">Workspace</a>
    </div>
    <div class="footer-col">
      <h4>Explore</h4>
      <a href="/free-tools/">Free Tools</a><a href="/blog/">Blog</a><a href="/pro.html">FAQ</a><a href="/pro.html">Pro &mdash; $29</a>
    </div>
    <div class="footer-col">
      <h4>Ecosystem</h4>
      <a href="/">NexTool Home</a><a href="/#contact">Contact</a><a href="https://github.com/christian140903-sudo/nextool" target="_blank">GitHub</a>
    </div>
  </div>
  <div class="footer-bottom">&copy; 2026 NexTool. AI-powered tools for everyone.</div>
</footer>

<div class="toast" id="toast"></div>

<script>
/* ---- State ---- */
var canvas = document.getElementById('hwCanvas');
var ctx = canvas.getContext('2d');
var textInput = document.getElementById('textInput');
var penColorEl = document.getElementById('penColor');
var penHexEl = document.getElementById('penHex');
var penThicknessEl = document.getElementById('penThickness');
var penThickValEl = document.getElementById('penThickVal');
var paperBgEl = document.getElementById('paperBg');
var fontSizeEl = document.getElementById('fontSize');
var lineSpacingEl = document.getElementById('lineSpacing');
var lineSpaceValEl = document.getElementById('lineSpaceVal');
var paperSizeEl = document.getElementById('paperSize');
var previewInfo = document.getElementById('previewInfo');

var currentStyle = 'casual';

/* ---- Style Definitions ---- */
var STYLES = {
  casual: {
    name: 'Casual',
    jitterX: 1.5,
    jitterY: 1.8,
    rotationMax: 0.04,
    sizeVar: 0.08,
    slant: 0,
    letterSpaceBase: 0.6,
    letterSpaceVar: 0.15,
    baselineWave: 1.2,
    font: 'serif'
  },
  neat: {
    name: 'Neat',
    jitterX: 0.4,
    jitterY: 0.5,
    rotationMax: 0.015,
    sizeVar: 0.03,
    slant: 0,
    letterSpaceBase: 0.55,
    letterSpaceVar: 0.05,
    baselineWave: 0.3,
    font: 'serif'
  },
  messy: {
    name: 'Messy',
    jitterX: 3.0,
    jitterY: 3.5,
    rotationMax: 0.1,
    sizeVar: 0.15,
    slant: -0.05,
    letterSpaceBase: 0.55,
    letterSpaceVar: 0.3,
    baselineWave: 2.5,
    font: 'serif'
  },
  cursive: {
    name: 'Cursive',
    jitterX: 0.8,
    jitterY: 1.0,
    rotationMax: 0.03,
    sizeVar: 0.06,
    slant: -0.18,
    letterSpaceBase: 0.48,
    letterSpaceVar: 0.1,
    baselineWave: 0.8,
    font: 'cursive'
  }
};

var FONT_SIZES = { small: 16, medium: 22, large: 30 };
var PAPER_DIMS = {
  a4: { w: 794, h: 1123 },
  letter: { w: 816, h: 1056 },
  custom: { w: 800, h: 600 }
};

/* ---- Seeded Random for Consistent Look ---- */
function mulberry32(a) {
  return function() {
    a |= 0; a = a + 0x6D2B79F5 | 0;
    var t = Math.imul(a ^ a >>> 15, 1 | a);
    t = t + Math.imul(t ^ t >>> 7, 61 | t) ^ t;
    return ((t ^ t >>> 14) >>> 0) / 4294967296;
  };
}

function hashStr(s) {
  var h = 0;
  for (var i = 0; i < s.length; i++) {
    h = ((h << 5) - h + s.charCodeAt(i)) | 0;
  }
  return h;
}

/* ---- Paper Drawing ---- */
function drawPaper(w, h, type) {
  if (type === 'aged') {
    ctx.fillStyle = '#f5e6c8';
    ctx.fillRect(0, 0, w, h);
    var rng = mulberry32(42);
    for (var i = 0; i < 600; i++) {
      var sx = rng() * w, sy = rng() * h;
      var sr = rng() * 3 + 0.5;
      var alpha = rng() * 0.08;
      ctx.fillStyle = 'rgba(139,90,43,' + alpha + ')';
      ctx.beginPath();
      ctx.arc(sx, sy, sr, 0, Math.PI * 2);
      ctx.fill();
    }
    for (var j = 0; j < 8; j++) {
      ctx.strokeStyle = 'rgba(139,90,43,' + (rng() * 0.04 + 0.01) + ')';
      ctx.lineWidth = rng() * 0.8 + 0.2;
      ctx.beginPath();
      ctx.moveTo(rng() * w, rng() * h);
      ctx.bezierCurveTo(rng() * w, rng() * h, rng() * w, rng() * h, rng() * w, rng() * h);
      ctx.stroke();
    }
  } else if (type === 'lined') {
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0, 0, w, h);
    var ls = getLineHeight();
    var startY = getMarginTop();
    ctx.strokeStyle = '#d0d8e8';
    ctx.lineWidth = 0.6;
    for (var y = startY; y < h - 30; y += ls) {
      ctx.beginPath();
      ctx.moveTo(60, y);
      ctx.lineTo(w - 40, y);
      ctx.stroke();
    }
    ctx.strokeStyle = '#e8a0a0';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(72, 30);
    ctx.lineTo(72, h - 30);
    ctx.stroke();
  } else if (type === 'grid') {
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0, 0, w, h);
    ctx.strokeStyle = '#dde4ee';
    ctx.lineWidth = 0.4;
    var gs = 24;
    for (var gx = gs; gx < w; gx += gs) {
      ctx.beginPath();
      ctx.moveTo(gx, 0);
      ctx.lineTo(gx, h);
      ctx.stroke();
    }
    for (var gy = gs; gy < h; gy += gs) {
      ctx.beginPath();
      ctx.moveTo(0, gy);
      ctx.lineTo(w, gy);
      ctx.stroke();
    }
  } else {
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0, 0, w, h);
  }
}

function getMarginTop() {
  return 60;
}

function getMarginLeft() {
  var paper = paperBgEl.value;
  return paper === 'lined' ? 82 : 50;
}

function getMarginRight() {
  return 50;
}

function getLineHeight() {
  var fs = FONT_SIZES[fontSizeEl.value] || 22;
  var ls = parseFloat(lineSpacingEl.value) || 1.8;
  return Math.round(fs * ls);
}

/* ---- Handwriting Renderer ---- */
function render() {
  var text = textInput.value;
  var style = STYLES[currentStyle];
  var fs = FONT_SIZES[fontSizeEl.value] || 22;
  var penColor = penColorEl.value;
  var thickness = parseFloat(penThicknessEl.value) || 2;
  var paperType = paperBgEl.value;
  var dims = PAPER_DIMS[paperSizeEl.value] || PAPER_DIMS.a4;
  var lineH = getLineHeight();
  var marginLeft = getMarginLeft();
  var marginRight = getMarginRight();
  var marginTop = getMarginTop();
  var maxWidth = dims.w - marginLeft - marginRight;

  canvas.width = dims.w;
  canvas.height = dims.h;

  drawPaper(dims.w, dims.h, paperType);

  if (!text) {
    previewInfo.textContent = dims.w + ' x ' + dims.h;
    return;
  }

  var seed = hashStr(text + currentStyle);
  var rng = mulberry32(seed);

  function rnd(min, max) {
    return min + rng() * (max - min);
  }

  var fontFamily = style.font === 'cursive'
    ? '"Segoe Script","Bradley Hand","Comic Sans MS",cursive'
    : '"Georgia","Palatino Linotype","Times New Roman",serif';

  var curX = marginLeft;
  var curY = marginTop + fs;
  var charIndex = 0;

  /* Word wrap: split into lines based on canvas width */
  var paragraphs = text.split('\n');
  var lines = [];

  ctx.font = fs + 'px ' + fontFamily;

  for (var pi = 0; pi < paragraphs.length; pi++) {
    var words = paragraphs[pi].split(/( +)/);
    var currentLine = '';
    for (var wi = 0; wi < words.length; wi++) {
      var testLine = currentLine + words[wi];
      var m = ctx.measureText(testLine);
      if (m.width > maxWidth && currentLine.length > 0) {
        lines.push(currentLine);
        currentLine = words[wi].replace(/^ +/, '');
      } else {
        currentLine = testLine;
      }
    }
    lines.push(currentLine);
  }

  for (var li = 0; li < lines.length; li++) {
    curX = marginLeft + rnd(-1, 2);
    var line = lines[li];
    var yBase = marginTop + fs + li * lineH;

    if (yBase > dims.h - 40) break;

    for (var ci = 0; ci < line.length; ci++) {
      var ch = line[ci];
      charIndex++;

      var charSeed = charIndex * 7 + seed;
      var localRng = mulberry32(charSeed);
      function lr(min, max) { return min + localRng() * (max - min); }

      var charFs = fs * (1 + lr(-style.sizeVar, style.sizeVar));
      var jx = lr(-style.jitterX, style.jitterX);
      var jy = lr(-style.jitterY, style.jitterY);
      var rot = lr(-style.rotationMax, style.rotationMax);
      var waveOffset = Math.sin(ci * 0.3 + li * 0.7) * style.baselineWave;

      var drawX = curX + jx;
      var drawY = yBase + jy + waveOffset;

      ctx.save();
      ctx.translate(drawX, drawY);
      ctx.rotate(rot);
      if (style.slant !== 0) {
        ctx.transform(1, 0, style.slant, 1, 0, 0);
      }

      ctx.font = (style.font === 'cursive' ? 'italic ' : '') + charFs + 'px ' + fontFamily;
      ctx.fillStyle = penColor;
      ctx.globalAlpha = 0.85 + lr(0, 0.15);

      /* Simulate pen pressure variation via shadow */
      var sw = thickness * (0.5 + lr(0, 0.6));
      if (sw > 0.8) {
        ctx.shadowColor = penColor;
        ctx.shadowBlur = sw * 0.3;
      }

      ctx.fillText(ch, 0, 0);

      /* Double-draw for thicker effect */
      if (thickness > 2) {
        ctx.globalAlpha = 0.15;
        ctx.fillText(ch, lr(-0.3, 0.3) * thickness, lr(-0.2, 0.2) * thickness);
      }

      ctx.restore();

      var charWidth = ctx.measureText(ch).width;
      var spacing = charWidth * (style.letterSpaceBase + lr(-style.letterSpaceVar, style.letterSpaceVar));
      curX += charWidth + spacing * 0.4;

      if (curX > dims.w - marginRight) break;
    }
  }

  ctx.globalAlpha = 1;
  ctx.shadowBlur = 0;
  previewInfo.textContent = lines.length + ' line' + (lines.length !== 1 ? 's' : '') + ' | ' + dims.w + ' x ' + dims.h;
}

/* ---- UI Handlers ---- */
function setStyle(s, btn) {
  currentStyle = s;
  document.querySelectorAll('.style-btn').forEach(function(b) { b.classList.remove('active'); });
  btn.classList.add('active');
  render();
}

function debounce(fn, ms) {
  var t;
  return function() {
    clearTimeout(t);
    t = setTimeout(fn, ms);
  };
}

var debouncedRender = debounce(render, 150);

textInput.addEventListener('input', debouncedRender);
penColorEl.addEventListener('input', function() {
  penHexEl.textContent = penColorEl.value;
  debouncedRender();
});
penThicknessEl.addEventListener('input', function() {
  penThickValEl.textContent = penThicknessEl.value;
  debouncedRender();
});
paperBgEl.addEventListener('change', render);
fontSizeEl.addEventListener('change', render);
lineSpacingEl.addEventListener('input', function() {
  lineSpaceValEl.textContent = parseFloat(lineSpacingEl.value).toFixed(1);
  debouncedRender();
});
paperSizeEl.addEventListener('change', render);

/* ---- Download PNG ---- */
function downloadPNG() {
  if (!textInput.value.trim()) { showToast('Enter some text first'); return; }
  var link = document.createElement('a');
  link.download = 'handwriting.png';
  link.href = canvas.toDataURL('image/png');
  link.click();
  showToast('Downloaded handwriting.png');
}

/* ---- Download PDF (multi-page) ---- */
function downloadPDF() {
  if (!textInput.value.trim()) { showToast('Enter some text first'); return; }

  var text = textInput.value;
  var style = STYLES[currentStyle];
  var fs = FONT_SIZES[fontSizeEl.value] || 22;
  var penColor = penColorEl.value;
  var thickness = parseFloat(penThicknessEl.value) || 2;
  var paperType = paperBgEl.value;
  var dims = PAPER_DIMS[paperSizeEl.value] || PAPER_DIMS.a4;
  var lineH = getLineHeight();
  var marginLeft = getMarginLeft();
  var marginRight = getMarginRight();
  var marginTop = getMarginTop();
  var maxWidth = dims.w - marginLeft - marginRight;

  var fontFamily = style.font === 'cursive'
    ? '"Segoe Script","Bradley Hand","Comic Sans MS",cursive'
    : '"Georgia","Palatino Linotype","Times New Roman",serif';

  /* Word wrap to get all lines */
  var tmpCanvas = document.createElement('canvas');
  tmpCanvas.width = dims.w;
  tmpCanvas.height = dims.h;
  var tmpCtx = tmpCanvas.getContext('2d');
  tmpCtx.font = fs + 'px ' + fontFamily;

  var paragraphs = text.split('\n');
  var allLines = [];
  for (var pi = 0; pi < paragraphs.length; pi++) {
    var words = paragraphs[pi].split(/( +)/);
    var currentLine = '';
    for (var wi = 0; wi < words.length; wi++) {
      var testLine = currentLine + words[wi];
      if (tmpCtx.measureText(testLine).width > maxWidth && currentLine.length > 0) {
        allLines.push(currentLine);
        currentLine = words[wi].replace(/^ +/, '');
      } else {
        currentLine = testLine;
      }
    }
    allLines.push(currentLine);
  }

  var linesPerPage = Math.floor((dims.h - marginTop - 40 - fs) / lineH) + 1;
  var totalPages = Math.ceil(allLines.length / linesPerPage) || 1;

  var pageImages = [];
  var seed = hashStr(text + currentStyle);

  for (var page = 0; page < totalPages; page++) {
    var pgCanvas = document.createElement('canvas');
    pgCanvas.width = dims.w;
    pgCanvas.height = dims.h;
    var pgCtx = pgCanvas.getContext('2d');

    /* Draw paper background */
    var origCtx = ctx;
    ctx = pgCtx;
    drawPaper(dims.w, dims.h, paperType);
    ctx = origCtx;

    var startLine = page * linesPerPage;
    var endLine = Math.min(startLine + linesPerPage, allLines.length);
    var rng = mulberry32(seed + page * 1000);
    function rnd(min, max) { return min + rng() * (max - min); }
    var charIndex = page * linesPerPage * 80;

    for (var li = startLine; li < endLine; li++) {
      var localLi = li - startLine;
      var curX = marginLeft + rnd(-1, 2);
      var line = allLines[li];
      var yBase = marginTop + fs + localLi * lineH;

      for (var ci = 0; ci < line.length; ci++) {
        var ch = line[ci];
        charIndex++;
        var charSeed = charIndex * 7 + seed;
        var localRng = mulberry32(charSeed);
        function lr(min, max) { return min + localRng() * (max - min); }

        var charFs = fs * (1 + lr(-style.sizeVar, style.sizeVar));
        var jx = lr(-style.jitterX, style.jitterX);
        var jy = lr(-style.jitterY, style.jitterY);
        var rot = lr(-style.rotationMax, style.rotationMax);
        var waveOffset = Math.sin(ci * 0.3 + localLi * 0.7) * style.baselineWave;

        var drawX = curX + jx;
        var drawY = yBase + jy + waveOffset;

        pgCtx.save();
        pgCtx.translate(drawX, drawY);
        pgCtx.rotate(rot);
        if (style.slant !== 0) pgCtx.transform(1, 0, style.slant, 1, 0, 0);
        pgCtx.font = (style.font === 'cursive' ? 'italic ' : '') + charFs + 'px ' + fontFamily;
        pgCtx.fillStyle = penColor;
        pgCtx.globalAlpha = 0.85 + lr(0, 0.15);
        var sw = thickness * (0.5 + lr(0, 0.6));
        if (sw > 0.8) { pgCtx.shadowColor = penColor; pgCtx.shadowBlur = sw * 0.3; }
        pgCtx.fillText(ch, 0, 0);
        if (thickness > 2) {
          pgCtx.globalAlpha = 0.15;
          pgCtx.fillText(ch, lr(-0.3, 0.3) * thickness, lr(-0.2, 0.2) * thickness);
        }
        pgCtx.restore();

        var charWidth = pgCtx.measureText(ch).width;
        var spacing = charWidth * (style.letterSpaceBase + lr(-style.letterSpaceVar, style.letterSpaceVar));
        curX += charWidth + spacing * 0.4;
        if (curX > dims.w - marginRight) break;
      }
    }

    pgCtx.globalAlpha = 1;
    pgCtx.shadowBlur = 0;
    pageImages.push(pgCanvas.toDataURL('image/jpeg', 0.92));
  }

  /* Build minimal PDF */
  var pdf = buildPDF(pageImages, dims.w, dims.h);
  var blob = new Blob([pdf], { type: 'application/pdf' });
  var link = document.createElement('a');
  link.download = 'handwriting.pdf';
  link.href = URL.createObjectURL(blob);
  link.click();
  URL.revokeObjectURL(link.href);
  showToast('Downloaded handwriting.pdf (' + totalPages + ' page' + (totalPages > 1 ? 's' : '') + ')');
}

/* ---- Minimal PDF Builder ---- */
function buildPDF(images, w, h) {
  var ptW = w * 0.75;
  var ptH = h * 0.75;
  var offsets = [];
  var body = '';
  var pos = 0;

  function addObj(s) {
    offsets.push(pos);
    body += s;
    pos += s.length;
  }

  var header = '%PDF-1.4\n';
  pos = header.length;

  var numPages = images.length;
  var pageObjStart = 3;
  var imgObjStart = pageObjStart + numPages;

  /* Obj 1: Catalog */
  addObj('1 0 obj\n<< /Type /Catalog /Pages 2 0 R >>\nendobj\n');

  /* Obj 2: Pages */
  var kids = '';
  for (var i = 0; i < numPages; i++) kids += (pageObjStart + i) + ' 0 R ';
  addObj('2 0 obj\n<< /Type /Pages /Kids [' + kids.trim() + '] /Count ' + numPages + ' >>\nendobj\n');

  /* Page + Image objects */
  for (var p = 0; p < numPages; p++) {
    var pageObj = pageObjStart + p;
    var imgObj = imgObjStart + p * 2;
    var streamObj = imgObjStart + p * 2 + 1;

    /* Page content stream */
    var stream = 'q ' + ptW + ' 0 0 ' + ptH + ' 0 0 cm /Img' + p + ' Do Q\n';

    /* Page object */
    addObj(pageObj + ' 0 obj\n<< /Type /Page /Parent 2 0 R /MediaBox [0 0 ' + ptW + ' ' + ptH + '] /Contents ' + streamObj + ' 0 R /Resources << /XObject << /Img' + p + ' ' + imgObj + ' 0 R >> >> >>\nendobj\n');

    /* Image object */
    var raw = images[p];
    var b64 = raw.split(',')[1];
    var binary = atob(b64);
    var imgStream = '';
    for (var bi = 0; bi < binary.length; bi++) imgStream += binary[bi];

    addObj(imgObj + ' 0 obj\n<< /Type /XObject /Subtype /Image /Width ' + w + ' /Height ' + h + ' /ColorSpace /DeviceRGB /BitsPerComponent 8 /Filter /DCTDecode /Length ' + binary.length + ' >>\nstream\n');
    /* binary data handled separately */

    addObj(streamObj + ' 0 obj\n<< /Length ' + stream.length + ' >>\nstream\n' + stream + 'endstream\nendobj\n');
  }

  /* Rebuild with binary data properly */
  var parts = [];
  parts.push(header);
  var bPos = header.length;
  var objOffsets = [];

  /* Obj 1 */
  var o1 = '1 0 obj\n<< /Type /Catalog /Pages 2 0 R >>\nendobj\n';
  objOffsets.push(bPos);
  parts.push(o1);
  bPos += o1.length;

  /* Obj 2 */
  var o2 = '2 0 obj\n<< /Type /Pages /Kids [' + (function() { var k = []; for (var i = 0; i < numPages; i++) k.push((pageObjStart + i) + ' 0 R'); return k.join(' '); })() + '] /Count ' + numPages + ' >>\nendobj\n';
  objOffsets.push(bPos);
  parts.push(o2);
  bPos += o2.length;

  var nextObj = 3;
  for (var p2 = 0; p2 < numPages; p2++) {
    var imgObjNum = nextObj;
    var contentObjNum = nextObj + 1;
    var pageObjNum = nextObj + 2;
    nextObj += 3;

    /* Decode image */
    var b64Data = images[p2].split(',')[1];
    var binStr = atob(b64Data);
    var binArr = new Uint8Array(binStr.length);
    for (var bb = 0; bb < binStr.length; bb++) binArr[bb] = binStr.charCodeAt(bb);

    /* Image XObject */
    var imgHead = imgObjNum + ' 0 obj\n<< /Type /XObject /Subtype /Image /Width ' + w + ' /Height ' + h + ' /ColorSpace /DeviceRGB /BitsPerComponent 8 /Filter /DCTDecode /Length ' + binArr.length + ' >>\nstream\n';
    var imgTail = '\nendstream\nendobj\n';
    objOffsets.push(bPos);
    parts.push(imgHead);
    bPos += imgHead.length;
    parts.push(binArr);
    bPos += binArr.length;
    parts.push(imgTail);
    bPos += imgTail.length;

    /* Content stream */
    var contentStream = 'q ' + ptW + ' 0 0 ' + ptH + ' 0 0 cm /Img' + p2 + ' Do Q\n';
    var contentHead = contentObjNum + ' 0 obj\n<< /Length ' + contentStream.length + ' >>\nstream\n' + contentStream + 'endstream\nendobj\n';
    objOffsets.push(bPos);
    parts.push(contentHead);
    bPos += contentHead.length;

    /* Page object */
    var pageStr = pageObjNum + ' 0 obj\n<< /Type /Page /Parent 2 0 R /MediaBox [0 0 ' + ptW + ' ' + ptH + '] /Contents ' + contentObjNum + ' 0 R /Resources << /XObject << /Img' + p2 + ' ' + imgObjNum + ' 0 R >> >> >>\nendobj\n';
    objOffsets.push(bPos);
    parts.push(pageStr);
    bPos += pageStr.length;
  }

  /* Fix Pages kids */
  var kidsArr = [];
  for (var pk = 0; pk < numPages; pk++) kidsArr.push((5 + pk * 3) + ' 0 R');
  parts[2] = '2 0 obj\n<< /Type /Pages /Kids [' + kidsArr.join(' ') + '] /Count ' + numPages + ' >>\nendobj\n';

  /* Recalculate offsets */
  bPos = header.length;
  objOffsets = [];
  for (var rp = 1; rp < parts.length; rp++) {
    if (typeof parts[rp] === 'string') {
      if (parts[rp].match(/^\d+ 0 obj/)) objOffsets.push(bPos);
      bPos += parts[rp].length;
    } else {
      bPos += parts[rp].length;
    }
  }

  /* XRef + Trailer */
  var xrefPos = bPos;
  var numObj = objOffsets.length + 1;
  var xref = 'xref\n0 ' + numObj + '\n0000000000 65535 f \n';
  for (var xi = 0; xi < objOffsets.length; xi++) {
    xref += String(objOffsets[xi]).padStart(10, '0') + ' 00000 n \n';
  }
  xref += 'trailer\n<< /Size ' + numObj + ' /Root 1 0 R >>\nstartxref\n' + xrefPos + '\n%%EOF';
  parts.push(xref);

  /* Combine into Blob-able array */
  var totalSize = 0;
  for (var ts = 0; ts < parts.length; ts++) {
    totalSize += typeof parts[ts] === 'string' ? parts[ts].length : parts[ts].length;
  }
  var result = new Uint8Array(totalSize);
  var offset = 0;
  for (var cp = 0; cp < parts.length; cp++) {
    if (typeof parts[cp] === 'string') {
      for (var sc = 0; sc < parts[cp].length; sc++) {
        result[offset++] = parts[cp].charCodeAt(sc);
      }
    } else {
      result.set(parts[cp], offset);
      offset += parts[cp].length;
    }
  }
  return result;
}

/* ---- Copy to Clipboard ---- */
function copyImage() {
  if (!textInput.value.trim()) { showToast('Enter some text first'); return; }
  canvas.toBlob(function(blob) {
    if (!blob) { showToast('Failed to create image'); return; }
    if (navigator.clipboard && navigator.clipboard.write) {
      navigator.clipboard.write([
        new ClipboardItem({ 'image/png': blob })
      ]).then(function() {
        showToast('Image copied to clipboard');
      }).catch(function() {
        showToast('Clipboard access denied');
      });
    } else {
      showToast('Clipboard API not supported in this browser');
    }
  }, 'image/png');
}

/* ---- Clear ---- */
function clearAll() {
  textInput.value = '';
  render();
  showToast('Cleared');
}

/* ---- Toast ---- */
function showToast(msg) {
  var t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(function() { t.classList.remove('show'); }, 2000);
}

/* ---- Fade In ---- */
var observer = new IntersectionObserver(function(entries) {
  entries.forEach(function(entry) { if (entry.isIntersecting) { entry.target.classList.add('visible'); observer.unobserve(entry.target); }});
}, { threshold: 0.1 });
document.querySelectorAll('.fade-in').forEach(function(el) { observer.observe(el); });

/* ---- Initial Render ---- */
render();
</script>
<script src="/js/analytics-lite.js" defer></script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "How does the text to handwriting converter work?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "NexTool's Text to Handwriting tool uses the HTML5 Canvas API to render each character with randomized variations in position, rotation, size, and spacing. This creates a natural, hand-drawn appearance. Everything runs in your browser — no data is sent to any server."
      }
    },
    {
      "@type": "Question",
      "name": "Can I download my handwriting as a PDF?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, you can download your handwritten text as both PNG images and multi-page PDF documents. The PDF is generated entirely in your browser with no external libraries, preserving the handwriting quality at full resolution."
      }
    },
    {
      "@type": "Question",
      "name": "What handwriting styles are available?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The tool offers four distinct handwriting styles: Casual (relaxed everyday writing), Neat (clean and orderly), Messy (hurried and imperfect), and Cursive (connected italic script). Each style adjusts letter spacing, baseline variation, character rotation, and slant to create a unique look."
      }
    },
    {
      "@type": "Question",
      "name": "Is this tool really free?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, NexTool's Text to Handwriting converter is completely free with no signup, no watermarks, and no usage limits. It runs 100% in your browser for maximum privacy and speed."
      }
    }
  ]
}
</script>
</body>
</html>

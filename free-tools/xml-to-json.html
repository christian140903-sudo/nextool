<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>XML to JSON Converter - Free Online Tool | NexTool</title>
<meta name="description" content="Convert XML to JSON instantly. Paste or upload XML, get clean JSON output with options for attributes, compact mode, and array wrapping. Free, no signup.">
<meta property="og:title" content="XML to JSON Converter - NexTool Free Tools">
<meta property="og:description" content="Convert XML to JSON instantly with advanced options. Free online tool, no signup required.">
<meta property="og:url" content="https://nextool.app/free-tools/xml-to-json.html">
<meta property="og:image" content="https://nextool.app/assets/og-default.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="XML to JSON Converter - NexTool Free Tools">
<meta name="twitter:description" content="Convert XML to JSON instantly with advanced options. Free online tool, no signup required.">
<link rel="canonical" href="https://nextool.app/free-tools/xml-to-json.html">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"XML to JSON Converter","applicationCategory":"DeveloperApplication","operatingSystem":"Any","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"description":"Convert XML to JSON instantly with advanced options for attributes, compact mode, and array wrapping.","url":"https://nextool.app/free-tools/xml-to-json.html"}
</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
*, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

:root {
    --bg: #050508;
    --surface: #111118;
    --surface2: #1a1a24;
    --primary: #6366f1;
    --accent: #a855f7;
    --pink: #ec4899;
    --text: #e2e8f0;
    --text-dim: #94a3b8;
    --gradient: linear-gradient(135deg, #6366f1, #a855f7, #ec4899);
    --radius: 12px;
    --radius-lg: 20px;
    --font: 'Inter', sans-serif;
    --mono: 'JetBrains Mono', monospace;
    --error: #ef4444;
    --success: #22c55e;
}

body {
    font-family: var(--font);
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    line-height: 1.6;
}

/* Navigation */
nav {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    background: rgba(5, 5, 8, 0.85);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border-bottom: 1px solid rgba(99, 102, 241, 0.15);
    padding: 0 24px;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.nav-logo {
    width: 36px;
    height: 36px;
    background: var(--gradient);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 14px;
    color: #fff;
    text-decoration: none;
    transition: transform 0.2s;
}

.nav-logo:hover {
    transform: scale(1.05);
}

.nav-links {
    display: flex;
    gap: 24px;
}

.nav-links a {
    color: var(--text-dim);
    text-decoration: none;
    font-size: 14px;
    font-weight: 500;
    transition: color 0.2s;
}

.nav-links a:hover {
    color: var(--text);
}

/* Main Content */
main {
    max-width: 1200px;
    margin: 0 auto;
    padding: 80px 24px 40px;
}

h1 {
    font-size: 2.2rem;
    font-weight: 700;
    background: var(--gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 8px;
}

.subtitle {
    color: var(--text-dim);
    font-size: 1.05rem;
    margin-bottom: 32px;
    max-width: 640px;
}

/* Options Bar */
.options-bar {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
    margin-bottom: 20px;
    padding: 16px 20px;
    background: var(--surface);
    border-radius: var(--radius);
    align-items: center;
    border: 1px solid rgba(99, 102, 241, 0.08);
}

.option {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    color: var(--text-dim);
    cursor: pointer;
    transition: color 0.2s;
}

.option:hover {
    color: var(--text);
}

.option input[type="checkbox"] {
    accent-color: var(--primary);
    width: 16px;
    height: 16px;
    cursor: pointer;
}

/* Buttons */
.btn {
    padding: 10px 22px;
    border: none;
    border-radius: var(--radius);
    font-family: var(--font);
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s;
    display: inline-flex;
    align-items: center;
    gap: 6px;
}

.btn-primary {
    background: var(--gradient);
    color: #fff;
    box-shadow: 0 4px 16px rgba(99, 102, 241, 0.25);
}

.btn-primary:hover {
    opacity: 0.92;
    transform: translateY(-1px);
    box-shadow: 0 6px 24px rgba(99, 102, 241, 0.35);
}

.btn-secondary {
    background: var(--surface2);
    color: var(--text);
    border: 1px solid rgba(99, 102, 241, 0.2);
}

.btn-secondary:hover {
    border-color: var(--primary);
    background: rgba(99, 102, 241, 0.08);
}

.btn-icon {
    padding: 8px 14px;
    font-size: 12px;
}

/* Editor */
.editor-wrap {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-bottom: 20px;
}

@media (max-width: 768px) {
    .editor-wrap {
        grid-template-columns: 1fr;
    }
}

.pane {
    display: flex;
    flex-direction: column;
}

.pane-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background: var(--surface);
    border-radius: var(--radius) var(--radius) 0 0;
    border: 1px solid rgba(99, 102, 241, 0.1);
    border-bottom: none;
}

.pane-header span {
    font-weight: 600;
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.pane-header .badge {
    font-size: 11px;
    padding: 2px 8px;
    border-radius: 6px;
    background: rgba(99, 102, 241, 0.15);
    color: var(--primary);
    font-weight: 500;
}

.pane-actions {
    display: flex;
    gap: 6px;
}

textarea {
    width: 100%;
    height: 420px;
    padding: 16px;
    background: var(--surface2);
    color: var(--text);
    border: 1px solid rgba(99, 102, 241, 0.1);
    border-radius: 0 0 var(--radius) var(--radius);
    font-family: var(--mono);
    font-size: 13px;
    line-height: 1.7;
    resize: vertical;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
    tab-size: 2;
}

textarea:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

textarea.error {
    border-color: var(--error);
    box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
}

textarea.success {
    border-color: var(--success);
    box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
}

/* Error Message */
.error-msg {
    color: var(--error);
    font-size: 13px;
    margin-top: 8px;
    min-height: 20px;
    font-family: var(--mono);
    padding: 0 4px;
}

/* Action Row */
.action-row {
    display: flex;
    gap: 12px;
    align-items: center;
    flex-wrap: wrap;
}

.stats {
    margin-left: auto;
    font-size: 13px;
    color: var(--text-dim);
    font-family: var(--mono);
    display: flex;
    align-items: center;
    gap: 16px;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 4px;
}

.stat-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    display: inline-block;
}

.stat-dot.xml { background: var(--primary); }
.stat-dot.json { background: var(--success); }

/* Features Grid */
.features {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 16px;
    margin-top: 40px;
    margin-bottom: 40px;
}

.feature-card {
    padding: 20px;
    background: var(--surface);
    border-radius: var(--radius);
    border: 1px solid rgba(99, 102, 241, 0.08);
    transition: border-color 0.2s, transform 0.2s;
}

.feature-card:hover {
    border-color: rgba(99, 102, 241, 0.2);
    transform: translateY(-2px);
}

.feature-card .icon {
    font-size: 1.5rem;
    margin-bottom: 10px;
}

.feature-card h3 {
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 6px;
}

.feature-card p {
    font-size: 13px;
    color: var(--text-dim);
    line-height: 1.5;
}

/* History Panel */
.history-section {
    margin-top: 32px;
}

.history-section h2 {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 12px;
    color: var(--text-dim);
}

.history-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.history-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background: var(--surface);
    border-radius: var(--radius);
    border: 1px solid rgba(99, 102, 241, 0.06);
    cursor: pointer;
    transition: border-color 0.2s;
}

.history-item:hover {
    border-color: rgba(99, 102, 241, 0.2);
}

.history-item .label {
    font-size: 13px;
    font-weight: 500;
}

.history-item .meta {
    font-size: 12px;
    color: var(--text-dim);
    font-family: var(--mono);
}

.history-empty {
    padding: 20px;
    text-align: center;
    color: var(--text-dim);
    font-size: 14px;
}

/* Toast */
.toast {
    position: fixed;
    bottom: 24px;
    right: 24px;
    padding: 14px 28px;
    background: var(--primary);
    color: #fff;
    border-radius: var(--radius);
    font-weight: 500;
    font-size: 14px;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.3s;
    pointer-events: none;
    z-index: 200;
    box-shadow: 0 8px 24px rgba(99, 102, 241, 0.3);
}

.toast.show {
    opacity: 1;
    transform: translateY(0);
}

/* Footer */
footer {
    margin-top: 60px;
    padding: 32px 0;
    border-top: 1px solid rgba(99, 102, 241, 0.1);
    text-align: center;
}

footer a {
    color: var(--text-dim);
    text-decoration: none;
    font-size: 14px;
    margin: 0 16px;
    transition: color 0.2s;
}

footer a:hover {
    color: var(--text);
}

/* Responsive */
@media (max-width: 600px) {
    h1 { font-size: 1.6rem; }
    .options-bar { padding: 12px; gap: 10px; }
    .features { grid-template-columns: 1fr; }
    .stats { margin-left: 0; margin-top: 8px; }
}
</style>
</head>
<body>

<nav>
    <a href="/" class="nav-logo">NT</a>
    <div class="nav-links">
        <a href="/">Home</a>
        <a href="/free-tools/">Free Tools</a>
    </div>
</nav>

<main>
    <h1>XML to JSON Converter</h1>
    <p class="subtitle">Paste or upload XML and convert to clean JSON instantly. Free, private, everything runs locally in your browser.</p>

    <div class="options-bar">
        <label class="option">
            <input type="checkbox" id="optAttrs" checked>
            Preserve Attributes
        </label>
        <label class="option">
            <input type="checkbox" id="optCompact">
            Compact Output
        </label>
        <label class="option">
            <input type="checkbox" id="optArrayWrap">
            Array Wrapping
        </label>
        <label class="option">
            <input type="checkbox" id="optTrimText" checked>
            Trim Whitespace
        </label>
        <div style="margin-left:auto;display:flex;gap:8px">
            <button class="btn btn-secondary btn-icon" onclick="loadSample()">Sample XML</button>
            <label class="btn btn-secondary btn-icon" style="cursor:pointer">
                <input type="file" accept=".xml,.xsl,.xslt,.svg,.xhtml,.rss,.atom" hidden onchange="handleFile(event)">
                Upload File
            </label>
        </div>
    </div>

    <div class="editor-wrap">
        <div class="pane">
            <div class="pane-header">
                <span>XML Input <span class="badge" id="xmlBadge">0 chars</span></span>
                <div class="pane-actions">
                    <button class="btn btn-secondary btn-icon" onclick="formatXML()">Format</button>
                    <button class="btn btn-secondary btn-icon" onclick="clearInput()">Clear</button>
                </div>
            </div>
            <textarea id="xmlInput" placeholder="Paste your XML here or upload a file..." spellcheck="false"></textarea>
            <div class="error-msg" id="errorMsg"></div>
        </div>
        <div class="pane">
            <div class="pane-header">
                <span>JSON Output <span class="badge" id="jsonBadge">0 chars</span></span>
                <div class="pane-actions">
                    <button class="btn btn-secondary btn-icon" onclick="copyOutput()">Copy</button>
                    <button class="btn btn-secondary btn-icon" onclick="downloadJSON()">Download</button>
                </div>
            </div>
            <textarea id="jsonOutput" readonly placeholder="JSON output will appear here after conversion..." spellcheck="false"></textarea>
        </div>
    </div>

    <div class="action-row">
        <button class="btn btn-primary" onclick="convert()" style="padding:13px 36px;font-size:15px">
            Convert XML &#8594; JSON
        </button>
        <button class="btn btn-secondary" onclick="swapPanes()">
            &#8644; Swap
        </button>
        <div class="stats" id="stats">
            <div class="stat-item"><span class="stat-dot xml"></span> XML: 0</div>
            <div class="stat-item"><span class="stat-dot json"></span> JSON: 0</div>
        </div>
    </div>

    <!-- Features Grid -->
    <div class="features">
        <div class="feature-card">
            <div class="icon">&#9881;</div>
            <h3>Attribute Handling</h3>
            <p>Preserve XML attributes as @-prefixed keys or strip them entirely from the output.</p>
        </div>
        <div class="feature-card">
            <div class="icon">&#128230;</div>
            <h3>Compact Mode</h3>
            <p>Generate minified JSON without whitespace for production use and smaller file sizes.</p>
        </div>
        <div class="feature-card">
            <div class="icon">&#128203;</div>
            <h3>Array Wrapping</h3>
            <p>Force all child elements into arrays for consistent, predictable data structures.</p>
        </div>
        <div class="feature-card">
            <div class="icon">&#128190;</div>
            <h3>File Upload</h3>
            <p>Upload XML, XSL, SVG, RSS, or Atom files directly for instant conversion.</p>
        </div>
        <div class="feature-card">
            <div class="icon">&#9888;</div>
            <h3>Error Detection</h3>
            <p>Real-time XML validation with clear error messages for malformed documents.</p>
        </div>
        <div class="feature-card">
            <div class="icon">&#128274;</div>
            <h3>100% Private</h3>
            <p>Everything runs locally in your browser. No data is ever sent to any server.</p>
        </div>
    </div>

    <!-- Conversion History -->
    <div class="history-section">
        <h2>Recent Conversions</h2>
        <div class="history-list" id="historyList">
            <div class="history-empty">No conversions yet. Paste some XML and hit Convert!</div>
        </div>
    </div>

    <!-- Cross-promo -->
    <div style="margin-top:48px;padding:32px;background:var(--surface);border-radius:var(--radius-lg);text-align:center;">
        <p style="font-size:1.1rem;margin-bottom:12px;">&#x1F680; Explore <strong>150+ Free Developer Tools</strong></p>
        <p style="color:var(--text-dim);margin-bottom:20px;">From CSS generators to JSON formatters — all free, no signup required.</p>
        <a href="/free-tools/" style="display:inline-block;padding:12px 28px;background:var(--gradient);color:#fff;border-radius:20px;font-weight:600;text-decoration:none;">Browse All Tools &#8594;</a>
    </div>
</main>


<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/box-shadow-generator.html" style="color:var(--primary);text-decoration:none">CSS Box Shadow Generator</a> · <a href="/free-tools/emoji-picker.html" style="color:var(--primary);text-decoration:none">Emoji Picker & Search</a> · <a href="/free-tools/json-formatter.html" style="color:var(--primary);text-decoration:none">Free JSON Formatter & Validator</a> · <a href="/free-tools/meta-tag-generator.html" style="color:var(--primary);text-decoration:none">Meta Tag Generator</a> · <a href="/free-tools/favicon-generator.html" style="color:var(--primary);text-decoration:none">Favicon Generator</a></p>
</div>

<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/icon-generator.html" style="color:var(--primary);text-decoration:none">Free Icon Generator</a> · <a href="/free-tools/accessibility-checker.html" style="color:var(--primary);text-decoration:none">Free Accessibility Checker</a> · <a href="/free-tools/api-mock-server.html" style="color:var(--primary);text-decoration:none">Free API Mock Server</a></p>
</div>
<footer>
    <a href="/">NexTool Home</a>
    <a href="/free-tools/">Free Tools Hub</a>
    <a href="/terms.html">Privacy Policy</a>
</footer>

<div class="toast" id="toast"></div>

<script>
const xmlInput = document.getElementById('xmlInput');
const jsonOutput = document.getElementById('jsonOutput');
const errorMsg = document.getElementById('errorMsg');
const statsEl = document.getElementById('stats');
const xmlBadge = document.getElementById('xmlBadge');
const jsonBadge = document.getElementById('jsonBadge');

let conversionHistory = [];

function showToast(msg) {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 2400);
}

function updateBadges() {
    const xLen = xmlInput.value.length;
    const jLen = jsonOutput.value.length;
    xmlBadge.textContent = xLen.toLocaleString() + ' chars';
    jsonBadge.textContent = jLen.toLocaleString() + ' chars';
    statsEl.innerHTML = `
        <div class="stat-item"><span class="stat-dot xml"></span> XML: ${xLen.toLocaleString()}</div>
        <div class="stat-item"><span class="stat-dot json"></span> JSON: ${jLen.toLocaleString()}</div>
    `;
}

function xmlNodeToObj(node, opts) {
    const { preserveAttrs, arrayWrap, trimText } = opts;

    if (node.nodeType === 3) {
        const t = trimText ? node.textContent.trim() : node.textContent;
        return t || null;
    }
    if (node.nodeType === 4) {
        return node.textContent;
    }
    if (node.nodeType !== 1) return null;

    let obj = {};
    let hasContent = false;

    // Handle attributes
    if (preserveAttrs && node.attributes && node.attributes.length) {
        for (let i = 0; i < node.attributes.length; i++) {
            const attr = node.attributes[i];
            obj['@' + attr.name] = attr.value;
            hasContent = true;
        }
    }

    // Handle child nodes
    const childMap = {};
    let textContent = '';

    for (let i = 0; i < node.childNodes.length; i++) {
        const child = node.childNodes[i];

        if (child.nodeType === 3 || child.nodeType === 4) {
            const t = trimText ? child.textContent.trim() : child.textContent;
            if (t) textContent += t;
        } else if (child.nodeType === 1) {
            hasContent = true;
            const name = child.nodeName;
            const val = xmlNodeToObj(child, opts);

            if (childMap[name]) {
                if (!Array.isArray(obj[name])) {
                    obj[name] = [obj[name]];
                }
                obj[name].push(val);
            } else {
                obj[name] = arrayWrap ? [val] : val;
                childMap[name] = true;
            }
        }
    }

    if (textContent) {
        if (!hasContent) return textContent;
        obj['#text'] = textContent;
    }

    if (!hasContent && !textContent) return '';

    // Simplify if only #text
    if (Object.keys(obj).length === 1 && obj['#text'] !== undefined) {
        return obj['#text'];
    }

    return obj;
}

function convert() {
    errorMsg.textContent = '';
    xmlInput.classList.remove('error');
    jsonOutput.classList.remove('success');

    const xml = xmlInput.value.trim();
    if (!xml) {
        errorMsg.textContent = 'Please enter XML content to convert.';
        xmlInput.classList.add('error');
        return;
    }

    try {
        const parser = new DOMParser();
        const doc = parser.parseFromString(xml, 'text/xml');
        const parseError = doc.querySelector('parsererror');

        if (parseError) {
            const errText = parseError.textContent.substring(0, 200);
            errorMsg.textContent = 'XML Parse Error: ' + errText;
            xmlInput.classList.add('error');
            return;
        }

        const opts = {
            preserveAttrs: document.getElementById('optAttrs').checked,
            compact: document.getElementById('optCompact').checked,
            arrayWrap: document.getElementById('optArrayWrap').checked,
            trimText: document.getElementById('optTrimText').checked
        };

        const root = doc.documentElement;
        const result = {};
        result[root.nodeName] = xmlNodeToObj(root, opts);

        const indent = opts.compact ? 0 : 2;
        const json = JSON.stringify(result, null, indent);

        jsonOutput.value = json;
        jsonOutput.classList.add('success');
        updateBadges();

        // Add to history
        addToHistory(xml, json);

        showToast('Conversion successful!');
    } catch (e) {
        errorMsg.textContent = 'Conversion Error: ' + e.message;
        xmlInput.classList.add('error');
    }
}

function addToHistory(xml, json) {
    const rootMatch = xml.match(/<(\w+)/);
    const rootName = rootMatch ? rootMatch[1] : 'unknown';
    const now = new Date();
    const timeStr = now.toLocaleTimeString();

    conversionHistory.unshift({
        rootName,
        xmlLen: xml.length,
        jsonLen: json.length,
        time: timeStr,
        xml,
        json
    });

    if (conversionHistory.length > 10) conversionHistory.pop();
    renderHistory();
}

function renderHistory() {
    const list = document.getElementById('historyList');
    if (conversionHistory.length === 0) {
        list.innerHTML = '<div class="history-empty">No conversions yet. Paste some XML and hit Convert!</div>';
        return;
    }
    list.innerHTML = conversionHistory.map((item, i) => `
        <div class="history-item" onclick="loadHistory(${i})">
            <div class="label">&lt;${item.rootName}&gt; &#8594; JSON</div>
            <div class="meta">${item.xmlLen} &#8594; ${item.jsonLen} chars &middot; ${item.time}</div>
        </div>
    `).join('');
}

function loadHistory(index) {
    const item = conversionHistory[index];
    if (!item) return;
    xmlInput.value = item.xml;
    jsonOutput.value = item.json;
    updateBadges();
    showToast('Loaded from history');
}

function copyOutput() {
    if (!jsonOutput.value) {
        showToast('Nothing to copy');
        return;
    }
    navigator.clipboard.writeText(jsonOutput.value).then(() => showToast('JSON copied to clipboard!'));
}

function downloadJSON() {
    if (!jsonOutput.value) {
        showToast('Nothing to download');
        return;
    }
    const blob = new Blob([jsonOutput.value], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'converted.json';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    showToast('JSON file downloaded!');
}

function clearInput() {
    xmlInput.value = '';
    jsonOutput.value = '';
    errorMsg.textContent = '';
    xmlInput.classList.remove('error');
    jsonOutput.classList.remove('success');
    updateBadges();
}

function handleFile(e) {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(ev) {
        xmlInput.value = ev.target.result;
        updateBadges();
        convert();
    };
    reader.readAsText(file);
    e.target.value = '';
}

function formatXML() {
    const xml = xmlInput.value.trim();
    if (!xml) return;
    try {
        const parser = new DOMParser();
        const doc = parser.parseFromString(xml, 'text/xml');
        if (doc.querySelector('parsererror')) {
            showToast('Cannot format invalid XML');
            return;
        }
        const serializer = new XMLSerializer();
        let formatted = serializer.serializeToString(doc);
        // Basic indentation
        let indent = 0;
        const lines = formatted.replace(/></g, '>\n<').split('\n');
        const result = lines.map(line => {
            line = line.trim();
            if (line.startsWith('</')) indent--;
            const padding = '  '.repeat(Math.max(0, indent));
            if (line.startsWith('<') && !line.startsWith('</') && !line.endsWith('/>') && !line.includes('</')) indent++;
            return padding + line;
        });
        xmlInput.value = result.join('\n');
        updateBadges();
        showToast('XML formatted');
    } catch (e) {
        showToast('Format error: ' + e.message);
    }
}

function swapPanes() {
    const jsonVal = jsonOutput.value;
    if (!jsonVal) {
        showToast('No JSON output to swap');
        return;
    }
    xmlInput.value = '';
    jsonOutput.value = '';
    xmlInput.value = jsonVal;
    updateBadges();
    showToast('Panes swapped');
}

function loadSample() {
    xmlInput.value = `<?xml version="1.0" encoding="UTF-8"?>
<bookstore xmlns:isbn="urn:isbn">
  <book category="fiction" bestseller="true">
    <title lang="en">The Great Gatsby</title>
    <author>F. Scott Fitzgerald</author>
    <year>1925</year>
    <price currency="USD">10.99</price>
    <isbn:number>978-0743273565</isbn:number>
  </book>
  <book category="science" bestseller="true">
    <title lang="en">A Brief History of Time</title>
    <author>Stephen Hawking</author>
    <year>1988</year>
    <price currency="USD">14.99</price>
    <isbn:number>978-0553380163</isbn:number>
  </book>
  <book category="fiction">
    <title lang="de">Der Prozess</title>
    <author>Franz Kafka</author>
    <year>1925</year>
    <price currency="EUR">9.99</price>
    <isbn:number>978-3596200375</isbn:number>
    <tags>
      <tag>classic</tag>
      <tag>german</tag>
      <tag>existentialism</tag>
    </tags>
  </book>
  <metadata>
    <total>3</total>
    <updated>2025-01-15T10:30:00Z</updated>
    <source url="https://example.com/books">BookDB API</source>
  </metadata>
</bookstore>`;
    updateBadges();
    convert();
}

// Live character count
xmlInput.addEventListener('input', () => {
    errorMsg.textContent = '';
    xmlInput.classList.remove('error');
    updateBadges();
});

// Keyboard shortcut
document.addEventListener('keydown', (e) => {
    if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
        e.preventDefault();
        convert();
    }
});

// Initialize
updateBadges();
</script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script src="/js/analytics-lite.js" defer></script>
</body>
</html>
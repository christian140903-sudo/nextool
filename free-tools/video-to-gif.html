<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Video to GIF Converter — Convert MP4 to GIF Online | NexTool</title>
<meta name="description" content="Convert video clips to animated GIFs instantly in your browser. Upload MP4, WebM, or MOV files, trim, adjust quality and frame rate. Free, no upload, 100% private.">
<meta name="keywords" content="video to gif converter, convert video to gif online, mp4 to gif free, webm to gif, video gif maker, animated gif creator, NexTool">
<meta name="robots" content="index, follow">
<meta property="og:title" content="Free Video to GIF Converter | NexTool">
<meta property="og:description" content="Convert MP4, WebM, and MOV video clips to animated GIFs. Trim, set quality, adjust frame rate. 100% client-side and free.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/video-to-gif.html">
<meta property="og:image" content="https://nextool.app/assets/og-default.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<link rel="canonical" href="https://nextool.app/free-tools/video-to-gif.html">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free Video to GIF Converter | NexTool">
<meta name="twitter:description" content="Convert video clips to animated GIFs instantly. Free online tool by NexTool.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"NexTool Video to GIF Converter","applicationCategory":"MultimediaApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"description":"Free online video to GIF converter. Convert MP4, WebM, MOV to animated GIFs with custom trim, quality, and frame rate settings. 100% client-side."}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--border:#2a2a3a;--text:#e4e4eb;--text2:#9494a8;--primary:#6366f1;--accent:#a855f7;--pink:#ec4899;--green:#22c55e;--red:#ef4444;--cyan:#22d3ee;--yellow:#eab308;--radius:12px;--glass:rgba(17,17,24,0.7)}
html{scroll-behavior:smooth}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
/* NAV */
.nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{font-size:1.4rem;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-decoration:none}
.nav-links{display:flex;align-items:center;gap:1.5rem}
.nav-links a{color:var(--text2);text-decoration:none;font-size:.875rem;font-weight:500;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-cta{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff!important;padding:.5rem 1.2rem;border-radius:8px;font-weight:600;-webkit-text-fill-color:#fff!important}
.nav-cta:hover{opacity:.9}
.nav-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}
/* HERO */
.hero{text-align:center;padding:3rem 1.5rem 2rem;max-width:700px;margin:0 auto}
.hero h1{font-size:2.2rem;font-weight:800;line-height:1.2;margin-bottom:.75rem}
.hero h1 span{background:linear-gradient(135deg,var(--primary),var(--accent),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--text2);font-size:1rem}
/* TOOL */
.tool-container{max-width:900px;margin:0 auto;padding:0 1.5rem 3rem}
/* DROP ZONE */
.drop-zone{border:2px dashed var(--border);border-radius:var(--radius);padding:3rem 2rem;text-align:center;cursor:pointer;transition:all .3s;background:var(--glass);backdrop-filter:blur(16px)}
.drop-zone:hover,.drop-zone.dragover{border-color:var(--primary);background:rgba(99,102,241,.06)}
.drop-zone-icon{font-size:3rem;margin-bottom:.75rem;opacity:.6}
.drop-zone h3{font-size:1.1rem;font-weight:600;margin-bottom:.4rem}
.drop-zone p{font-size:.85rem;color:var(--text2)}
.drop-zone input{display:none}
/* VIDEO PANEL */
.video-panel{display:none;background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;margin-bottom:1rem}
.video-panel.active{display:block}
.video-wrapper{position:relative;background:#000;display:flex;align-items:center;justify-content:center;max-height:500px;overflow:hidden}
.video-wrapper video{max-width:100%;max-height:500px;display:block}
/* TIMELINE */
.timeline-container{padding:1rem 1.5rem;border-top:1px solid var(--border)}
.timeline-label{display:flex;justify-content:space-between;font-size:.75rem;color:var(--text2);margin-bottom:.5rem}
.timeline-track{position:relative;height:40px;background:var(--surface2);border-radius:8px;overflow:hidden;cursor:pointer;user-select:none}
.timeline-filled{position:absolute;top:0;height:100%;background:linear-gradient(90deg,rgba(99,102,241,.3),rgba(168,85,247,.3));pointer-events:none}
.timeline-handle{position:absolute;top:0;width:4px;height:100%;background:var(--primary);cursor:ew-resize;z-index:2;transition:background .2s}
.timeline-handle:hover{background:var(--accent)}
.timeline-handle::after{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:14px;height:14px;border-radius:50%;background:var(--primary);border:2px solid #fff;box-shadow:0 0 8px rgba(99,102,241,.5)}
.timeline-playhead{position:absolute;top:0;width:2px;height:100%;background:var(--yellow);z-index:3;pointer-events:none;transition:left .05s linear}
.time-inputs{display:flex;gap:1rem;margin-top:.75rem;align-items:center;flex-wrap:wrap}
.time-input-group{display:flex;align-items:center;gap:.4rem;font-size:.8rem;color:var(--text2)}
.time-input-group input{width:70px;background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.3rem .5rem;border-radius:6px;font-size:.8rem;font-family:inherit;text-align:center}
.time-input-group input:focus{outline:none;border-color:var(--primary)}
.duration-badge{font-size:.75rem;padding:.25rem .6rem;border-radius:6px;font-weight:600}
.duration-ok{background:rgba(34,197,94,.12);color:var(--green)}
.duration-warn{background:rgba(234,179,8,.12);color:var(--yellow)}
.duration-over{background:rgba(239,68,68,.12);color:var(--red)}
/* SETTINGS */
.settings-panel{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem;margin-bottom:1rem;display:none}
.settings-panel.active{display:block}
.settings-grid{display:grid;grid-template-columns:1fr 1fr;gap:1.25rem}
.setting-group label{display:block;font-size:.8rem;font-weight:600;color:var(--text2);margin-bottom:.5rem}
.quality-presets{display:flex;gap:.4rem;flex-wrap:wrap}
.quality-btn{background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.4rem .8rem;border-radius:8px;font-size:.75rem;font-weight:500;cursor:pointer;transition:all .2s;font-family:inherit}
.quality-btn:hover{border-color:var(--primary);background:rgba(99,102,241,.1)}
.quality-btn.active{background:linear-gradient(135deg,var(--primary),var(--accent));border-color:transparent;color:#fff}
.slider-row{display:flex;align-items:center;gap:.75rem}
.slider-row input[type=range]{flex:1;-webkit-appearance:none;appearance:none;height:6px;border-radius:3px;background:var(--surface2);outline:none}
.slider-row input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:var(--primary);cursor:pointer;border:2px solid #fff;box-shadow:0 0 6px rgba(99,102,241,.4)}
.slider-row input[type=range]::-moz-range-thumb{width:18px;height:18px;border-radius:50%;background:var(--primary);cursor:pointer;border:2px solid #fff;box-shadow:0 0 6px rgba(99,102,241,.4)}
.slider-val{font-size:.85rem;font-weight:600;color:var(--text);min-width:55px;text-align:right}
/* PREVIEW */
.preview-frame{margin-top:1rem}
.preview-frame label{font-size:.8rem;font-weight:600;color:var(--text2);margin-bottom:.5rem;display:block}
.preview-canvas-wrap{background:#000;border-radius:8px;overflow:hidden;display:inline-block;max-width:100%}
.preview-canvas-wrap canvas{display:block;max-width:100%;height:auto}
/* ACTIONS */
.actions{display:flex;gap:.75rem;margin-bottom:1rem;flex-wrap:wrap;align-items:center}
.btn{background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.55rem 1.2rem;border-radius:8px;font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s;font-family:inherit;display:inline-flex;align-items:center;gap:.4rem}
.btn:hover{border-color:var(--primary);background:rgba(99,102,241,.12)}
.btn:disabled{opacity:.4;cursor:not-allowed}
.btn-primary{background:linear-gradient(135deg,var(--primary),var(--accent));border-color:transparent;color:#fff}
.btn-primary:hover{opacity:.9;border-color:transparent;background:linear-gradient(135deg,var(--primary),var(--accent))}
.btn-primary:disabled{opacity:.4}
.btn-danger{border-color:rgba(239,68,68,.3);color:var(--red)}
.btn-danger:hover{background:rgba(239,68,68,.1);border-color:var(--red)}
/* PROGRESS */
.progress-bar{display:none;margin-bottom:1rem}
.progress-bar.active{display:block}
.progress-outer{background:var(--surface2);border-radius:8px;height:28px;overflow:hidden;position:relative}
.progress-inner{height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:8px;transition:width .2s;width:0}
.progress-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:.75rem;font-weight:600;color:#fff;text-shadow:0 1px 3px rgba(0,0,0,.5);white-space:nowrap}
.progress-status{font-size:.8rem;color:var(--text2);margin-top:.4rem}
/* RESULT */
.result-panel{display:none;background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;margin-bottom:1rem}
.result-panel.active{display:block}
.result-preview{background:#000;display:flex;align-items:center;justify-content:center;padding:1rem;max-height:600px;overflow:auto}
.result-preview img{max-width:100%;height:auto;border-radius:4px}
.result-info{padding:1rem 1.5rem;border-top:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:.75rem}
.result-stats{display:flex;gap:1.5rem;flex-wrap:wrap}
.result-stat{font-size:.8rem;color:var(--text2)}
.result-stat strong{color:var(--text);font-weight:600}
/* CTA */
.cta-section{text-align:center;padding:4rem 1.5rem;max-width:700px;margin:0 auto}
.cta-section h2{font-size:1.8rem;font-weight:800;margin-bottom:.75rem}
.cta-section h2 span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.cta-section p{color:var(--text2);margin-bottom:1.5rem}
.cta-btn{display:inline-block;background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;padding:.75rem 2rem;border-radius:10px;font-weight:700;text-decoration:none;font-size:1rem;transition:transform .2s,box-shadow .2s}
.cta-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(99,102,241,.3)}
/* FOOTER */
.footer{border-top:1px solid var(--border);padding:3rem 2rem 2rem;max-width:1200px;margin:0 auto}
.footer-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:2rem;margin-bottom:2rem}
.footer-col h4{font-size:.85rem;font-weight:700;margin-bottom:.75rem;color:var(--text)}
.footer-col a{display:block;color:var(--text2);text-decoration:none;font-size:.8rem;margin-bottom:.4rem;transition:color .2s}
.footer-col a:hover{color:var(--primary)}
.footer-bottom{text-align:center;color:var(--text2);font-size:.75rem;padding-top:1.5rem;border-top:1px solid var(--border)}
/* FADE IN */
.fade-in{opacity:0;transform:translateY(20px);transition:opacity .6s,transform .6s}
.fade-in.visible{opacity:1;transform:translateY(0)}
/* TOAST */
.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.6rem 1.2rem;border-radius:10px;font-size:.85rem;font-weight:500;z-index:200;transition:transform .3s;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0)}
/* RESPONSIVE */
@media(max-width:768px){
  .nav-links{display:none;position:absolute;top:64px;left:0;right:0;background:var(--bg);border-bottom:1px solid var(--border);flex-direction:column;padding:1rem 2rem;gap:1rem}
  .nav-links.open{display:flex}
  .nav-toggle{display:block}
  .hero h1{font-size:1.6rem}
  .footer-grid{grid-template-columns:1fr}
  .settings-grid{grid-template-columns:1fr}
  .time-inputs{flex-direction:column;align-items:flex-start}
  .result-info{flex-direction:column;align-items:flex-start}
}
</style>
</head>
<body>

<nav class="nav">
  <a href="/" class="nav-logo">NexTool</a>
  <button class="nav-toggle" onclick="document.querySelector('.nav-links').classList.toggle('open')" aria-label="Menu">&#9776;</button>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Tools</a>
    <a href="/free-tools/">Free Tools</a>
    <a href="/blog/">Blog</a>
    <a href="/pro.html" class="nav-cta">Get Pro — $29</a>
  </div>
</nav>

<section class="hero fade-in">
  <h1>Free <span>Video to GIF</span> Converter</h1>
  <p class="tool-summary" style="color:#94a3b8;font-size:15px;line-height:1.6;margin-bottom:24px;max-width:700px;margin-left:auto;margin-right:auto;">Convert MP4, WebM, and MOV video clips to animated GIFs directly in your browser. Trim start and end points, adjust quality, frame rate, and resolution. No upload to any server &mdash; your files stay completely private.</p>
</section>

<div class="tool-container fade-in">

  <!-- DROP ZONE -->
  <div class="drop-zone" id="dropZone">
    <div class="drop-zone-icon">&#127916;</div>
    <h3>Drop your video here or click to browse</h3>
    <p>Supports MP4, WebM, MOV &mdash; max 500 MB</p>
    <input type="file" id="fileInput" accept="video/mp4,video/webm,video/quicktime,video/x-m4v,.mp4,.webm,.mov">
  </div>

  <!-- VIDEO PANEL -->
  <div class="video-panel" id="videoPanel">
    <div class="video-wrapper">
      <video id="videoPlayer" controls playsinline></video>
    </div>
    <div class="timeline-container">
      <div class="timeline-label">
        <span id="tlStart">0:00.0</span>
        <span id="tlDuration" class="duration-badge duration-ok">0.0s selected</span>
        <span id="tlEnd">0:00.0</span>
      </div>
      <div class="timeline-track" id="timelineTrack">
        <div class="timeline-filled" id="timelineFilled"></div>
        <div class="timeline-handle" id="handleStart" style="left:0"></div>
        <div class="timeline-handle" id="handleEnd" style="left:100%"></div>
        <div class="timeline-playhead" id="playhead" style="left:0"></div>
      </div>
      <div class="time-inputs">
        <div class="time-input-group">
          <span>Start:</span>
          <input type="number" id="startInput" min="0" step="0.1" value="0">
          <span>s</span>
        </div>
        <div class="time-input-group">
          <span>End:</span>
          <input type="number" id="endInput" min="0" step="0.1" value="0">
          <span>s</span>
        </div>
        <div class="time-input-group">
          <span>Duration:</span>
          <span id="durationDisplay" style="color:var(--text);font-weight:600">0.0s</span>
          <span style="color:var(--text2);font-size:.7rem">(max 30s)</span>
        </div>
      </div>
    </div>
  </div>

  <!-- SETTINGS -->
  <div class="settings-panel" id="settingsPanel">
    <div class="settings-grid">
      <div class="setting-group">
        <label>Quality Preset</label>
        <div class="quality-presets">
          <button class="quality-btn" data-preset="low" onclick="setPreset('low')">Low</button>
          <button class="quality-btn active" data-preset="medium" onclick="setPreset('medium')">Medium</button>
          <button class="quality-btn" data-preset="high" onclick="setPreset('high')">High</button>
          <button class="quality-btn" data-preset="ultra" onclick="setPreset('ultra')">Ultra</button>
        </div>
      </div>
      <div class="setting-group">
        <label>Frame Rate: <span id="fpsVal">15</span> fps</label>
        <div class="slider-row">
          <input type="range" id="fpsSlider" min="5" max="25" value="15" step="1">
          <span class="slider-val" id="fpsDisplay">15 fps</span>
        </div>
      </div>
      <div class="setting-group">
        <label>Width: <span id="widthVal">480</span>px</label>
        <div class="slider-row">
          <input type="range" id="widthSlider" min="160" max="1280" value="480" step="10">
          <span class="slider-val" id="widthDisplay">480px</span>
        </div>
      </div>
      <div class="setting-group preview-frame">
        <label>Preview at Start Frame</label>
        <div class="preview-canvas-wrap">
          <canvas id="previewCanvas" width="240" height="135"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- ACTIONS -->
  <div class="actions" id="actionsBar" style="display:none">
    <button class="btn btn-primary" id="convertBtn" onclick="startConversion()">Convert to GIF</button>
    <button class="btn btn-danger" onclick="resetTool()">Clear</button>
  </div>

  <!-- PROGRESS -->
  <div class="progress-bar" id="progressBar">
    <div class="progress-outer">
      <div class="progress-inner" id="progressInner"></div>
      <div class="progress-text" id="progressText">Preparing...</div>
    </div>
    <div class="progress-status" id="progressStatus">Extracting frames from video...</div>
  </div>

  <!-- RESULT -->
  <div class="result-panel" id="resultPanel">
    <div class="result-preview" id="resultPreview"></div>
    <div class="result-info">
      <div class="result-stats">
        <div class="result-stat">Size: <strong id="resultSize">-</strong></div>
        <div class="result-stat">Dimensions: <strong id="resultDims">-</strong></div>
        <div class="result-stat">Frames: <strong id="resultFrames">-</strong></div>
        <div class="result-stat">Duration: <strong id="resultDuration">-</strong></div>
      </div>
      <button class="btn btn-primary" id="downloadBtn" onclick="downloadGif()">Download GIF</button>
    </div>
  </div>

</div>

<section class="cta-section fade-in">
  <h2>Need something <span>more powerful</span>?</h2>
  <p>Let us build it for you. Custom APIs, dashboards, automations &mdash; whatever you need.</p>
  <a href="/#contact" class="cta-btn">Start a Project &rarr;</a>
</section>

<!-- Cross Promo -->
<section style="max-width:900px;margin:40px auto;padding:0 24px;">
<div style="background:linear-gradient(135deg,rgba(99,102,241,0.1),rgba(168,85,247,0.08));border:1px solid rgba(99,102,241,0.15);border-radius:20px;padding:32px 28px;text-align:center;">
<div style="font-size:13px;color:#818cf8;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Founding Member</div>
<h3 style="font-size:22px;font-weight:800;color:#fff;margin:0 0 8px;">Get NexTool Pro</h3>
<p style="color:#94a3b8;font-size:14px;margin:0 auto 20px;max-width:500px;">No banners, clean output, enhanced features on all 250+ tools. One-time payment.</p>
<div style="display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;">
<a href="/pro.html" style="display:inline-block;padding:12px 28px;background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);color:#fff;border-radius:10px;font-weight:700;font-size:15px;text-decoration:none;">$29 — Get Pro</a>
<a href="/free-tools/" style="color:#94a3b8;font-size:14px;text-decoration:none;">Browse 250+ Free Tools &rarr;</a>
</div>
</div>
</section>


<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/box-shadow-generator.html" style="color:var(--primary);text-decoration:none">CSS Box Shadow Generator</a> · <a href="/free-tools/emoji-picker.html" style="color:var(--primary);text-decoration:none">Emoji Picker & Search</a> · <a href="/free-tools/meta-tag-generator.html" style="color:var(--primary);text-decoration:none">Meta Tag Generator</a></p>
</div>

<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/json-to-yaml-converter.html" style="color:var(--primary);text-decoration:none">Free JSON to YAML Converter</a> · <a href="/free-tools/accessibility-checker.html" style="color:var(--primary);text-decoration:none">Free Accessibility Checker</a> · <a href="/free-tools/api-request-builder.html" style="color:var(--primary);text-decoration:none">Free API Request Builder</a></p>
</div>

<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/gif-maker.html" style="color:var(--primary);text-decoration:none">GIF Maker</a> · <a href="/free-tools/json-to-yaml.html" style="color:var(--primary);text-decoration:none">Free JSON to YAML Converter</a> · <a href="/free-tools/yaml-to-json.html" style="color:var(--primary);text-decoration:none">YAML to JSON Converter</a></p>
</div>
<footer class="footer fade-in">
  <div class="footer-grid">
    <div class="footer-col">
      <h4>Products</h4>
      <a href="/free-tools/">250+ Free Tools</a>
<a href="/pro.html">NexTool Pro</a>
<a href="/workspace.html">Workspace</a>
    </div>
    <div class="footer-col">
      <h4>Explore</h4>
      <a href="/free-tools/">Free Tools</a><a href="/blog/">Blog</a><a href="/pro.html">FAQ</a><a href="/pro.html">Pro — $29</a>
    </div>
    <div class="footer-col">
      <h4>Ecosystem</h4>
      <a href="/">NexTool Home</a><a href="/#contact">Contact</a><a href="https://github.com/christian140903-sudo/nextool" target="_blank">GitHub</a>
    </div>
  </div>
  <div class="footer-bottom">&copy; 2026 NexTool. AI-powered tools for everyone.</div>
</footer>

<div class="toast" id="toast"></div>

<script>
/* ============================================================
   Video to GIF Converter — Pure Client-Side
   Uses gif.js (CDN) for GIF encoding via Web Workers
   ============================================================ */

var video = document.getElementById('videoPlayer');
var dropZone = document.getElementById('dropZone');
var fileInput = document.getElementById('fileInput');
var videoPanel = document.getElementById('videoPanel');
var settingsPanel = document.getElementById('settingsPanel');
var actionsBar = document.getElementById('actionsBar');
var progressBar = document.getElementById('progressBar');
var resultPanel = document.getElementById('resultPanel');

var fpsSlider = document.getElementById('fpsSlider');
var widthSlider = document.getElementById('widthSlider');
var startInput = document.getElementById('startInput');
var endInput = document.getElementById('endInput');

var videoDuration = 0;
var trimStart = 0;
var trimEnd = 0;
var gifBlob = null;
var gifUrl = null;
var isConverting = false;

var presets = {
  low:    { fps: 10, width: 320 },
  medium: { fps: 15, width: 480 },
  high:   { fps: 20, width: 640 },
  ultra:  { fps: 25, width: 800 }
};

/* --- DROP ZONE --- */
dropZone.addEventListener('click', function() { fileInput.click(); });
fileInput.addEventListener('change', function(e) {
  if (e.target.files && e.target.files[0]) handleFile(e.target.files[0]);
});
dropZone.addEventListener('dragover', function(e) {
  e.preventDefault(); dropZone.classList.add('dragover');
});
dropZone.addEventListener('dragleave', function() {
  dropZone.classList.remove('dragover');
});
dropZone.addEventListener('drop', function(e) {
  e.preventDefault(); dropZone.classList.remove('dragover');
  if (e.dataTransfer.files && e.dataTransfer.files[0]) handleFile(e.dataTransfer.files[0]);
});

function handleFile(file) {
  var validTypes = ['video/mp4','video/webm','video/quicktime','video/x-m4v'];
  if (validTypes.indexOf(file.type) === -1 && !file.name.match(/\.(mp4|webm|mov|m4v)$/i)) {
    showToast('Please upload an MP4, WebM, or MOV video file.');
    return;
  }
  if (file.size > 500 * 1024 * 1024) {
    showToast('File too large. Maximum size is 500 MB.');
    return;
  }
  resetResult();
  var url = URL.createObjectURL(file);
  video.src = url;
  video.load();
  video.onloadedmetadata = function() {
    videoDuration = video.duration;
    trimStart = 0;
    trimEnd = Math.min(videoDuration, 30);
    startInput.value = trimStart.toFixed(1);
    startInput.max = videoDuration;
    endInput.value = trimEnd.toFixed(1);
    endInput.max = videoDuration;
    updateTimeline();
    updateDurationBadge();
    dropZone.style.display = 'none';
    videoPanel.classList.add('active');
    settingsPanel.classList.add('active');
    actionsBar.style.display = 'flex';
    updatePreview();
  };
  video.onerror = function() {
    showToast('Could not load video. Try a different file.');
  };
}

/* --- TIMELINE --- */
var timelineTrack = document.getElementById('timelineTrack');
var handleStartEl = document.getElementById('handleStart');
var handleEndEl = document.getElementById('handleEnd');
var timelineFilled = document.getElementById('timelineFilled');
var playhead = document.getElementById('playhead');
var dragging = null;

function updateTimeline() {
  if (!videoDuration) return;
  var sp = (trimStart / videoDuration) * 100;
  var ep = (trimEnd / videoDuration) * 100;
  handleStartEl.style.left = sp + '%';
  handleEndEl.style.left = ep + '%';
  timelineFilled.style.left = sp + '%';
  timelineFilled.style.width = (ep - sp) + '%';
  document.getElementById('tlStart').textContent = formatTime(trimStart);
  document.getElementById('tlEnd').textContent = formatTime(trimEnd);
}

function updateDurationBadge() {
  var dur = trimEnd - trimStart;
  var badge = document.getElementById('tlDuration');
  var display = document.getElementById('durationDisplay');
  badge.textContent = dur.toFixed(1) + 's selected';
  display.textContent = dur.toFixed(1) + 's';
  badge.className = 'duration-badge ' + (dur <= 0 ? 'duration-over' : dur <= 30 ? 'duration-ok' : 'duration-over');
}

handleStartEl.addEventListener('mousedown', function(e) { e.preventDefault(); dragging = 'start'; });
handleEndEl.addEventListener('mousedown', function(e) { e.preventDefault(); dragging = 'end'; });
handleStartEl.addEventListener('touchstart', function(e) { e.preventDefault(); dragging = 'start'; }, {passive:false});
handleEndEl.addEventListener('touchstart', function(e) { e.preventDefault(); dragging = 'end'; }, {passive:false});

document.addEventListener('mousemove', onDrag);
document.addEventListener('touchmove', onDrag, {passive:false});
document.addEventListener('mouseup', onDragEnd);
document.addEventListener('touchend', onDragEnd);

function onDrag(e) {
  if (!dragging) return;
  e.preventDefault();
  var rect = timelineTrack.getBoundingClientRect();
  var clientX = e.touches ? e.touches[0].clientX : e.clientX;
  var pct = Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
  var t = pct * videoDuration;
  if (dragging === 'start') {
    trimStart = Math.min(t, trimEnd - 0.1);
    trimStart = Math.max(0, trimStart);
    if (trimEnd - trimStart > 30) trimStart = trimEnd - 30;
    startInput.value = trimStart.toFixed(1);
  } else {
    trimEnd = Math.max(t, trimStart + 0.1);
    trimEnd = Math.min(videoDuration, trimEnd);
    if (trimEnd - trimStart > 30) trimEnd = trimStart + 30;
    endInput.value = trimEnd.toFixed(1);
  }
  updateTimeline();
  updateDurationBadge();
}

function onDragEnd() {
  if (dragging) {
    updatePreview();
    dragging = null;
  }
}

startInput.addEventListener('change', function() {
  trimStart = Math.max(0, Math.min(parseFloat(this.value) || 0, trimEnd - 0.1));
  if (trimEnd - trimStart > 30) trimStart = trimEnd - 30;
  this.value = trimStart.toFixed(1);
  updateTimeline(); updateDurationBadge(); updatePreview();
});
endInput.addEventListener('change', function() {
  trimEnd = Math.max(trimStart + 0.1, Math.min(parseFloat(this.value) || 0, videoDuration));
  if (trimEnd - trimStart > 30) trimEnd = trimStart + 30;
  this.value = trimEnd.toFixed(1);
  updateTimeline(); updateDurationBadge(); updatePreview();
});

/* Update playhead during video playback */
video.addEventListener('timeupdate', function() {
  if (!videoDuration) return;
  var pct = (video.currentTime / videoDuration) * 100;
  playhead.style.left = pct + '%';
});

/* --- QUALITY PRESETS --- */
function setPreset(name) {
  var p = presets[name];
  if (!p) return;
  fpsSlider.value = p.fps;
  widthSlider.value = p.width;
  updateSliderDisplays();
  document.querySelectorAll('.quality-btn').forEach(function(b) {
    b.classList.toggle('active', b.dataset.preset === name);
  });
  updatePreview();
}

fpsSlider.addEventListener('input', function() { updateSliderDisplays(); clearPresetHighlight(); });
widthSlider.addEventListener('input', function() { updateSliderDisplays(); clearPresetHighlight(); updatePreview(); });

function updateSliderDisplays() {
  var fps = parseInt(fpsSlider.value);
  var w = parseInt(widthSlider.value);
  document.getElementById('fpsVal').textContent = fps;
  document.getElementById('fpsDisplay').textContent = fps + ' fps';
  document.getElementById('widthVal').textContent = w;
  document.getElementById('widthDisplay').textContent = w + 'px';
}

function clearPresetHighlight() {
  var fps = parseInt(fpsSlider.value);
  var w = parseInt(widthSlider.value);
  var matched = null;
  for (var k in presets) {
    if (presets[k].fps === fps && presets[k].width === w) matched = k;
  }
  document.querySelectorAll('.quality-btn').forEach(function(b) {
    b.classList.toggle('active', b.dataset.preset === matched);
  });
}

/* --- PREVIEW FRAME --- */
var previewCanvas = document.getElementById('previewCanvas');
var previewCtx = previewCanvas.getContext('2d');

function updatePreview() {
  if (!video.src || !videoDuration) return;
  var targetW = parseInt(widthSlider.value);
  var scale = targetW / video.videoWidth;
  var targetH = Math.round(video.videoHeight * scale);
  /* Show a smaller preview */
  var previewW = Math.min(targetW, 320);
  var previewScale = previewW / targetW;
  var previewH = Math.round(targetH * previewScale);
  previewCanvas.width = previewW;
  previewCanvas.height = previewH;

  var wasPlaying = !video.paused;
  if (wasPlaying) video.pause();
  var prevTime = video.currentTime;

  video.currentTime = trimStart;
  video.onseeked = function() {
    previewCtx.drawImage(video, 0, 0, previewW, previewH);
    video.onseeked = null;
    if (wasPlaying) {
      video.currentTime = prevTime;
      video.play();
    }
  };
}

/* --- GIF CONVERSION --- */
function startConversion() {
  if (isConverting) return;
  var dur = trimEnd - trimStart;
  if (dur <= 0) { showToast('Select a valid time range.'); return; }
  if (dur > 30) { showToast('Duration exceeds 30 seconds. Trim your clip.'); return; }

  isConverting = true;
  document.getElementById('convertBtn').disabled = true;
  progressBar.classList.add('active');
  resultPanel.classList.remove('active');
  resetResult();

  var fps = parseInt(fpsSlider.value);
  var targetW = parseInt(widthSlider.value);
  var scale = targetW / video.videoWidth;
  var targetH = Math.round(video.videoHeight * scale);
  var interval = 1 / fps;
  var totalFrames = Math.ceil(dur * fps);
  var delay = Math.round(1000 / fps);

  updateProgress(0, 'Extracting frames... 0/' + totalFrames);
  setStatus('Seeking through video to capture frames...');

  var canvas = document.createElement('canvas');
  canvas.width = targetW;
  canvas.height = targetH;
  var ctx = canvas.getContext('2d');
  var frames = [];
  var frameIndex = 0;

  video.pause();
  video.muted = true;

  function captureFrame() {
    var seekTime = trimStart + (frameIndex * interval);
    if (seekTime > trimEnd || frameIndex >= totalFrames) {
      encodeGif(frames, targetW, targetH, delay, totalFrames);
      return;
    }
    video.currentTime = seekTime;
    video.onseeked = function() {
      ctx.drawImage(video, 0, 0, targetW, targetH);
      frames.push(ctx.getImageData(0, 0, targetW, targetH));
      frameIndex++;
      var pct = Math.round((frameIndex / totalFrames) * 50);
      updateProgress(pct, 'Extracting frames... ' + frameIndex + '/' + totalFrames);
      /* Use requestAnimationFrame to keep UI responsive */
      requestAnimationFrame(captureFrame);
    };
  }

  captureFrame();
}

function encodeGif(frames, w, h, delay, totalFrames) {
  setStatus('Encoding GIF with gif.js...');
  updateProgress(50, 'Loading GIF encoder...');

  /* Load gif.js from CDN */
  if (typeof GIF === 'undefined') {
    var s = document.createElement('script');
    s.src = 'https://cdn.jsdelivr.net/npm/gif.js@0.2.0/dist/gif.js';
    s.onload = function() { doEncode(frames, w, h, delay, totalFrames); };
    s.onerror = function() {
      showToast('Failed to load GIF encoder. Check your connection.');
      finishConversion();
    };
    document.head.appendChild(s);
  } else {
    doEncode(frames, w, h, delay, totalFrames);
  }
}

function doEncode(frames, w, h, delay, totalFrames) {
  var gif = new GIF({
    workers: navigator.hardwareConcurrency ? Math.min(navigator.hardwareConcurrency, 4) : 2,
    quality: 10,
    width: w,
    height: h,
    workerScript: 'https://cdn.jsdelivr.net/npm/gif.js@0.2.0/dist/gif.worker.js'
  });

  var encCanvas = document.createElement('canvas');
  encCanvas.width = w;
  encCanvas.height = h;
  var encCtx = encCanvas.getContext('2d');

  for (var i = 0; i < frames.length; i++) {
    encCtx.putImageData(frames[i], 0, 0);
    gif.addFrame(encCtx, { copy: true, delay: delay });
  }

  gif.on('progress', function(p) {
    var pct = 50 + Math.round(p * 50);
    updateProgress(pct, 'Encoding GIF... ' + Math.round(p * 100) + '%');
    setStatus('Encoding frame data into GIF format...');
  });

  gif.on('finished', function(blob) {
    gifBlob = blob;
    gifUrl = URL.createObjectURL(blob);
    showResult(w, h, frames.length, delay);
    finishConversion();
  });

  gif.render();
}

function showResult(w, h, frameCount, delay) {
  var img = document.createElement('img');
  img.src = gifUrl;
  img.alt = 'Converted GIF';
  var preview = document.getElementById('resultPreview');
  preview.innerHTML = '';
  preview.appendChild(img);

  document.getElementById('resultSize').textContent = formatBytes(gifBlob.size);
  document.getElementById('resultDims').textContent = w + ' x ' + h + ' px';
  document.getElementById('resultFrames').textContent = frameCount;
  document.getElementById('resultDuration').textContent = ((frameCount * delay) / 1000).toFixed(1) + 's';

  resultPanel.classList.add('active');
  resultPanel.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

function finishConversion() {
  isConverting = false;
  document.getElementById('convertBtn').disabled = false;
  progressBar.classList.remove('active');
}

function downloadGif() {
  if (!gifBlob) { showToast('No GIF to download. Convert first.'); return; }
  var a = document.createElement('a');
  a.href = gifUrl;
  a.download = 'nextool-converted.gif';
  a.click();
  showToast('GIF downloaded!');
}

/* --- RESET --- */
function resetTool() {
  video.pause();
  video.removeAttribute('src');
  video.load();
  videoDuration = 0;
  trimStart = 0;
  trimEnd = 0;
  resetResult();
  dropZone.style.display = '';
  videoPanel.classList.remove('active');
  settingsPanel.classList.remove('active');
  actionsBar.style.display = 'none';
  progressBar.classList.remove('active');
  resultPanel.classList.remove('active');
  fileInput.value = '';
  startInput.value = '0';
  endInput.value = '0';
  setPreset('medium');
}

function resetResult() {
  if (gifUrl) { URL.revokeObjectURL(gifUrl); gifUrl = null; }
  gifBlob = null;
  document.getElementById('resultPreview').innerHTML = '';
  resultPanel.classList.remove('active');
}

/* --- UTILITIES --- */
function updateProgress(pct, text) {
  document.getElementById('progressInner').style.width = pct + '%';
  document.getElementById('progressText').textContent = text;
}
function setStatus(s) {
  document.getElementById('progressStatus').textContent = s;
}

function formatTime(sec) {
  var m = Math.floor(sec / 60);
  var s = sec % 60;
  return m + ':' + (s < 10 ? '0' : '') + s.toFixed(1);
}

function formatBytes(bytes) {
  if (bytes === 0) return '0 B';
  var k = 1024, sizes = ['B','KB','MB','GB'];
  var i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
}

function showToast(msg) {
  var t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(function() { t.classList.remove('show'); }, 2500);
}

/* IntersectionObserver fade-in */
var observer = new IntersectionObserver(function(entries) {
  entries.forEach(function(entry) {
    if (entry.isIntersecting) { entry.target.classList.add('visible'); observer.unobserve(entry.target); }
  });
}, { threshold: 0.1 });
document.querySelectorAll('.fade-in').forEach(function(el) { observer.observe(el); });
</script>
<script src="/js/analytics-lite.js" defer></script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "How do I convert a video to GIF online?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Upload your MP4, WebM, or MOV file to NexTool's Video to GIF Converter, set your start and end time, choose quality settings, and click Convert. The GIF is created entirely in your browser with no server upload required."
      }
    },
    {
      "@type": "Question",
      "name": "What video formats are supported?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "NexTool's Video to GIF Converter supports MP4, WebM, and MOV video formats. These are the most common web and mobile video formats."
      }
    },
    {
      "@type": "Question",
      "name": "Is there a duration limit for GIF conversion?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, the maximum GIF duration is 30 seconds. This keeps file sizes manageable while still allowing you to capture meaningful clips. You can trim any portion of your video within that limit."
      }
    },
    {
      "@type": "Question",
      "name": "Is my video uploaded to a server?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "No. The entire conversion happens in your browser using JavaScript and the Canvas API. Your video file never leaves your device, ensuring complete privacy."
      }
    }
  ]
}
</script>
</body>
</html>

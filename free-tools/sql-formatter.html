<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free SQL Formatter & Beautifier — Format SQL Online | ANIMA</title>
<meta name="description" content="Free online SQL formatter and beautifier. Format SELECT, INSERT, UPDATE, JOIN queries with proper indentation, keyword uppercasing, and dialect support. No signup.">
<meta name="keywords" content="SQL formatter, SQL beautifier, format SQL online, SQL indent, SQL minifier, ANIMA">
<meta name="robots" content="index, follow">
<meta property="og:title" content="Free SQL Formatter & Beautifier | ANIMA">
<meta property="og:description" content="Format and beautify SQL queries instantly. Keyword uppercasing, multiple dialects, minify option. 100% free, no signup.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/sql-formatter.html">
<meta property="og:image" content="https://nextool.app/img/og-image.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<link rel="canonical" href="https://nextool.app/free-tools/sql-formatter.html">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free SQL Formatter & Beautifier | ANIMA">
<meta name="twitter:description" content="Format and beautify SQL queries instantly. Free online tool by ANIMA.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"SQL Formatter & Beautifier","applicationCategory":"DeveloperApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"description":"Free online SQL formatter and beautifier with keyword uppercasing, multiple dialect support, and minification."}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--border:#2a2a3a;--text:#e4e4eb;--text2:#9494a8;--primary:#00d4ff;--accent:#a855f7;--pink:#ec4899;--green:#22c55e;--red:#ef4444;--cyan:#22d3ee;--yellow:#eab308;--radius:12px;--glass:rgba(17,17,24,0.7)}
html{scroll-behavior:smooth}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
.nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{font-size:1.4rem;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-decoration:none}
.nav-links{display:flex;align-items:center;gap:1.5rem}
.nav-links a{color:var(--text2);text-decoration:none;font-size:.875rem;font-weight:500;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-cta{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff!important;padding:.5rem 1.2rem;border-radius:8px;font-weight:600;-webkit-text-fill-color:#fff!important}
.nav-cta:hover{opacity:.9}
.nav-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}
.hero{text-align:center;padding:3rem 1.5rem 2rem;max-width:700px;margin:0 auto}
.hero h1{font-size:2.2rem;font-weight:800;line-height:1.2;margin-bottom:.75rem}
.hero h1 span{background:linear-gradient(135deg,var(--primary),var(--accent),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--text2);font-size:1rem}
.tool-container{max-width:1200px;margin:0 auto;padding:0 1.5rem 3rem}
.toolbar{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem;align-items:center}
.toolbar button,.toolbar select,.toolbar label{background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.45rem .9rem;border-radius:8px;font-size:.8rem;font-weight:500;cursor:pointer;transition:all .2s;font-family:inherit}
.toolbar button:hover{border-color:var(--primary);background:rgba(0,212,255,.12)}
.toolbar button.active{background:linear-gradient(135deg,var(--primary),var(--accent));border-color:transparent;color:#fff}
.toolbar select{appearance:none;padding-right:1.8rem;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%239494a8' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .6rem center}
.toolbar label{display:flex;align-items:center;gap:.4rem;cursor:pointer;user-select:none}
.toolbar label input[type="checkbox"]{accent-color:var(--primary);width:14px;height:14px}
.status-bar{display:flex;align-items:center;gap:1rem;margin-bottom:1rem;font-size:.8rem;color:var(--text2)}
.panels{display:grid;grid-template-columns:1fr 1fr;gap:1rem;min-height:500px}
.panel{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;display:flex;flex-direction:column}
.panel-header{padding:.6rem 1rem;border-bottom:1px solid var(--border);font-size:.8rem;font-weight:600;color:var(--text2);display:flex;justify-content:space-between;align-items:center;background:rgba(26,26,36,0.5)}
.panel-body{flex:1;position:relative;overflow:auto}
#sqlInput{width:100%;height:100%;min-height:400px;background:transparent;border:none;color:var(--text);font-family:'Courier New',monospace;font-size:.85rem;padding:1rem;resize:none;outline:none;line-height:1.7;tab-size:2}
#sqlInput::placeholder{color:var(--text2);opacity:.5}
.output-area{padding:0;font-family:'Courier New',monospace;font-size:.85rem;line-height:1.7;min-height:400px;counter-reset:line}
.output-line{display:flex;border-bottom:1px solid rgba(42,42,58,0.3)}
.output-line:hover{background:rgba(0,212,255,0.05)}
.line-num{min-width:44px;padding:0 10px 0 8px;text-align:right;color:var(--text2);opacity:.5;user-select:none;border-right:1px solid var(--border);flex-shrink:0;font-size:.8rem}
.line-content{padding:0 12px;white-space:pre;flex:1;overflow-x:auto}
.hl-keyword{color:#c084fc;font-weight:600}
.hl-function{color:var(--cyan)}
.hl-string{color:#4ade80}
.hl-number{color:var(--cyan)}
.hl-comment{color:#6b7280;font-style:italic}
.hl-operator{color:var(--pink)}
.hl-paren{color:var(--text2)}
.hl-comma{color:var(--text2)}
.hl-type{color:var(--yellow)}
.cta-section{text-align:center;padding:4rem 1.5rem;max-width:700px;margin:0 auto}
.cta-section h2{font-size:1.8rem;font-weight:800;margin-bottom:.75rem}
.cta-section h2 span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.cta-section p{color:var(--text2);margin-bottom:1.5rem}
.cta-btn{display:inline-block;background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;padding:.75rem 2rem;border-radius:10px;font-weight:700;text-decoration:none;font-size:1rem;transition:transform .2s,box-shadow .2s}
.cta-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,212,255,.3)}
.footer{border-top:1px solid var(--border);padding:3rem 2rem 2rem;max-width:1200px;margin:0 auto}
.footer-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:2rem;margin-bottom:2rem}
.footer-col h4{font-size:.85rem;font-weight:700;margin-bottom:.75rem;color:var(--text)}
.footer-col a{display:block;color:var(--text2);text-decoration:none;font-size:.8rem;margin-bottom:.4rem;transition:color .2s}
.footer-col a:hover{color:var(--primary)}
.footer-bottom{text-align:center;color:var(--text2);font-size:.75rem;padding-top:1.5rem;border-top:1px solid var(--border)}
.fade-in{opacity:0;transform:translateY(20px);transition:opacity .6s,transform .6s}
.fade-in.visible{opacity:1;transform:translateY(0)}
.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.6rem 1.2rem;border-radius:10px;font-size:.85rem;font-weight:500;z-index:200;transition:transform .3s;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0)}
@media(max-width:768px){
  .panels{grid-template-columns:1fr}
  .nav-links{display:none;position:absolute;top:64px;left:0;right:0;background:var(--bg);border-bottom:1px solid var(--border);flex-direction:column;padding:1rem 2rem;gap:1rem}
  .nav-links.open{display:flex}
  .nav-toggle{display:block}
  .hero h1{font-size:1.6rem}
  .footer-grid{grid-template-columns:1fr}
  .toolbar{gap:.35rem}
}
</style>
</head>
<body>

<nav class="nav">
  <a href="/" class="nav-logo">ANIMA</a>
  <button class="nav-toggle" onclick="document.querySelector('.nav-links').classList.toggle('open')" aria-label="Menu">&#9776;</button>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Tools</a>
    <a href="/free-tools/">Free Tools</a>
    <a href="/blog/">Blog</a>
    <a href="https://github.com/christian140903-sudo/nextool" class="nav-cta" target="_blank" rel="noopener">GitHub</a>
  </div>
</nav>

<section class="hero fade-in">
  <h1>Free <span>SQL Formatter</span> & Beautifier</h1>
  <p>Format, beautify, and minify SQL queries instantly. Supports SELECT, INSERT, UPDATE, DELETE, CREATE TABLE, JOINs, subqueries, and multiple SQL dialects. Keyword uppercasing, adjustable indentation, line numbers, and syntax highlighting included.</p>
</section>

<div class="tool-container fade-in">
  <div class="toolbar">
    <button onclick="formatSQL()" title="Format SQL">Format</button>
    <button onclick="minifySQL()" title="Minify SQL">Minify</button>
    <button onclick="copyOutput()" title="Copy to clipboard">Copy</button>
    <button onclick="downloadSQL()" title="Download .sql file">Download</button>
    <select id="indentSize" title="Indentation size">
      <option value="2">2 spaces</option>
      <option value="4" selected>4 spaces</option>
      <option value="tab">Tab</option>
    </select>
    <select id="dialect" title="SQL dialect">
      <option value="standard">Standard SQL</option>
      <option value="mysql">MySQL</option>
      <option value="postgresql">PostgreSQL</option>
      <option value="sqlite">SQLite</option>
    </select>
    <label title="Uppercase keywords"><input type="checkbox" id="uppercase" checked> Uppercase</label>
    <button onclick="clearAll()" title="Clear all">Clear</button>
    <button onclick="loadSample()" title="Load sample SQL">Sample</button>
  </div>

  <div class="status-bar">
    <span id="statusText">Paste SQL to begin</span>
    <span id="sizeInfo" style="margin-left:auto"></span>
  </div>

  <div class="panels">
    <div class="panel">
      <div class="panel-header"><span>Input</span><span id="lineCount"></span></div>
      <div class="panel-body">
        <textarea id="sqlInput" placeholder="Paste your SQL query here...&#10;&#10;Example:&#10;SELECT u.name, o.total FROM users u INNER JOIN orders o ON u.id = o.user_id WHERE o.total > 100 ORDER BY o.total DESC LIMIT 10;" spellcheck="false"></textarea>
      </div>
    </div>
    <div class="panel">
      <div class="panel-header"><span>Formatted Output</span><span id="outputInfo"></span></div>
      <div class="panel-body" id="outputPanel">
        <div class="output-area" id="formattedOutput"></div>
      </div>
    </div>
  </div>
</div>

<section class="cta-section fade-in">
  <h2>Need something <span>more powerful</span>?</h2>
  <p>Let us build it for you. Custom APIs, dashboards, automations &mdash; whatever you need.</p>
  <a href="/#contact" class="cta-btn">Start a Project &rarr;</a>
</section>

<section style="max-width:900px;margin:40px auto;padding:0 24px;">
<div style="background:linear-gradient(135deg,rgba(0,212,255,0.1),rgba(168,85,247,0.08));border:1px solid rgba(0,212,255,0.15);border-radius:20px;padding:32px 28px;text-align:center;">
<div style="font-size:13px;color:#818cf8;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Founding Member</div>
<h3 style="font-size:22px;font-weight:800;color:#fff;margin:0 0 8px;">ANIMA on GitHub</h3>
<p style="color:#94a3b8;font-size:14px;margin:0 auto 20px;max-width:500px;">248+ free tools. No signup. Open source. Built by Christian Bucher.</p>
<div style="display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;">
<a href="/about/" style="display:inline-block;padding:12px 28px;background:linear-gradient(135deg,#00d4ff,#a855f7,#ec4899);color:#fff;border-radius:10px;font-weight:700;font-size:15px;text-decoration:none;">GitHub</a>
<a href="/free-tools/" style="color:#94a3b8;font-size:14px;text-decoration:none;">Browse 250+ Free Tools &rarr;</a>
</div>
</div>
</section>


<!-- AUTO-LINKED by ANIMA Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/box-shadow-generator.html" style="color:var(--primary);text-decoration:none">CSS Box Shadow Generator</a> · <a href="/free-tools/emoji-picker.html" style="color:var(--primary);text-decoration:none">Emoji Picker & Search</a> · <a href="/free-tools/git-diff-viewer.html" style="color:var(--primary);text-decoration:none">Free Git Diff Viewer</a></p>
</div>

<!-- AUTO-LINKED by ANIMA Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/json-to-yaml-converter.html" style="color:var(--primary);text-decoration:none">Free JSON to YAML Converter</a> · <a href="/free-tools/accessibility-checker.html" style="color:var(--primary);text-decoration:none">Free Accessibility Checker</a> · <a href="/free-tools/api-request-builder.html" style="color:var(--primary);text-decoration:none">Free API Request Builder</a></p>
</div>
<footer class="footer fade-in">
  <div class="footer-grid">
    <div class="footer-col">
      <h4>Products</h4>
      <a href="/free-tools/">250+ Free Tools</a>
      <a href="/about/">About</a>
      <a href="/docs/">Documentation</a>
    </div>
    <div class="footer-col">
      <h4>Explore</h4>
      <a href="/free-tools/">Free Tools</a><a href="/blog/">Blog</a><a href="/about/">FAQ</a><a href="/about/">About</a>
    </div>
    <div class="footer-col">
      <h4>Ecosystem</h4>
      <a href="/">ANIMA Home</a><a href="/#contact">Contact</a><a href="https://github.com/christian140903-sudo/nextool" target="_blank">GitHub</a>
    </div>
  </div>
  <div class="footer-bottom">&copy; 2026 ANIMA. AI-powered tools for everyone.</div>
</footer>

<div class="toast" id="toast"></div>

<script>
const input = document.getElementById('sqlInput');
const formattedOutput = document.getElementById('formattedOutput');
const statusText = document.getElementById('statusText');
const sizeInfo = document.getElementById('sizeInfo');
const lineCount = document.getElementById('lineCount');
const outputInfo = document.getElementById('outputInfo');
let lastFormatted = '';

input.addEventListener('input', debounce(autoProcess, 400));
input.addEventListener('input', updateLineCount);

function debounce(fn, ms) { let t; return (...a) => { clearTimeout(t); t = setTimeout(() => fn(...a), ms); }; }

function updateLineCount() {
  const lines = input.value.split('\n').length;
  lineCount.textContent = lines + ' line' + (lines !== 1 ? 's' : '');
}

function autoProcess() {
  const raw = input.value.trim();
  if (!raw) {
    formattedOutput.innerHTML = '';
    statusText.textContent = 'Paste SQL to begin';
    sizeInfo.textContent = '';
    outputInfo.textContent = '';
    return;
  }
  sizeInfo.textContent = formatBytes(new Blob([raw]).size);
  formatSQL();
}

/* =========== SQL FORMATTER ENGINE =========== */

const MAJOR_KEYWORDS = [
  'SELECT','FROM','WHERE','ORDER BY','GROUP BY','HAVING','LIMIT','OFFSET',
  'INSERT INTO','VALUES','UPDATE','SET','DELETE FROM','DELETE','CREATE TABLE',
  'ALTER TABLE','DROP TABLE','CREATE INDEX','DROP INDEX','CREATE VIEW',
  'UNION ALL','UNION','INTERSECT','EXCEPT','WITH','RETURNING',
  'INTO','TRUNCATE'
];

const JOIN_KEYWORDS = [
  'INNER JOIN','LEFT OUTER JOIN','RIGHT OUTER JOIN','FULL OUTER JOIN',
  'LEFT JOIN','RIGHT JOIN','FULL JOIN','CROSS JOIN','NATURAL JOIN','JOIN'
];

const SUB_KEYWORDS = ['ON','USING','AND','OR','WHEN','THEN','ELSE','END','CASE','IF','ELSEIF'];

const ALL_KEYWORDS = [
  ...MAJOR_KEYWORDS, ...JOIN_KEYWORDS, ...SUB_KEYWORDS,
  'AS','IN','NOT','NULL','IS','LIKE','ILIKE','BETWEEN','EXISTS',
  'ALL','ANY','SOME','DISTINCT','ASC','DESC','NULLS','FIRST','LAST',
  'TRUE','FALSE','DEFAULT','PRIMARY','KEY','FOREIGN','REFERENCES',
  'UNIQUE','CHECK','CONSTRAINT','INDEX','CASCADE','RESTRICT',
  'AUTO_INCREMENT','SERIAL','BIGSERIAL','IDENTITY','IF EXISTS','IF NOT EXISTS',
  'NOT NULL','INT','INTEGER','BIGINT','SMALLINT','TINYINT','VARCHAR','CHAR',
  'TEXT','BOOLEAN','BOOL','FLOAT','DOUBLE','DECIMAL','NUMERIC','DATE',
  'TIMESTAMP','DATETIME','TIME','BLOB','JSON','JSONB','UUID','ARRAY',
  'BEGIN','COMMIT','ROLLBACK','TRANSACTION','GRANT','REVOKE','EXPLAIN',
  'OVER','PARTITION BY','ROWS','RANGE','PRECEDING','FOLLOWING','UNBOUNDED','CURRENT ROW',
  'FETCH','NEXT','ONLY','FOR','DO','WHILE','LOOP','DECLARE','CURSOR','OPEN','CLOSE',
  'MERGE','MATCHED','TOP','PERCENT','PIVOT','UNPIVOT','LATERAL','RECURSIVE'
];

const FUNCTIONS = [
  'COUNT','SUM','AVG','MIN','MAX','COALESCE','NULLIF','CAST','CONVERT',
  'IFNULL','ISNULL','NVL','CONCAT','SUBSTRING','SUBSTR','LENGTH','LEN',
  'TRIM','LTRIM','RTRIM','UPPER','LOWER','REPLACE','REVERSE','LEFT','RIGHT',
  'NOW','CURRENT_TIMESTAMP','CURRENT_DATE','CURRENT_TIME','DATEADD','DATEDIFF',
  'EXTRACT','TO_CHAR','TO_DATE','TO_NUMBER','ROUND','FLOOR','CEIL','CEILING',
  'ABS','MOD','POWER','SQRT','LOG','EXP','SIGN','RANDOM','RAND',
  'ROW_NUMBER','RANK','DENSE_RANK','NTILE','LEAD','LAG','FIRST_VALUE','LAST_VALUE',
  'STRING_AGG','GROUP_CONCAT','LISTAGG','ARRAY_AGG','JSON_AGG','JSON_OBJECT',
  'GREATEST','LEAST','DECODE','IIF'
];

function tokenize(sql) {
  const tokens = [];
  let i = 0;
  const len = sql.length;

  while (i < len) {
    // Whitespace
    if (/\s/.test(sql[i])) {
      let ws = '';
      while (i < len && /\s/.test(sql[i])) ws += sql[i++];
      tokens.push({ type: 'whitespace', value: ws });
      continue;
    }
    // Single-line comment --
    if (sql[i] === '-' && sql[i + 1] === '-') {
      let c = '';
      while (i < len && sql[i] !== '\n') c += sql[i++];
      tokens.push({ type: 'comment', value: c });
      continue;
    }
    // Multi-line comment /* */
    if (sql[i] === '/' && sql[i + 1] === '*') {
      let c = '/*';
      i += 2;
      while (i < len && !(sql[i] === '*' && sql[i + 1] === '/')) c += sql[i++];
      if (i < len) { c += '*/'; i += 2; }
      tokens.push({ type: 'comment', value: c });
      continue;
    }
    // String literal (single quote)
    if (sql[i] === "'") {
      let s = "'";
      i++;
      while (i < len) {
        if (sql[i] === "'" && sql[i + 1] === "'") { s += "''"; i += 2; }
        else if (sql[i] === "'") { s += "'"; i++; break; }
        else { s += sql[i++]; }
      }
      tokens.push({ type: 'string', value: s });
      continue;
    }
    // Double-quoted identifier
    if (sql[i] === '"') {
      let s = '"';
      i++;
      while (i < len && sql[i] !== '"') s += sql[i++];
      if (i < len) { s += '"'; i++; }
      tokens.push({ type: 'identifier', value: s });
      continue;
    }
    // Backtick identifier (MySQL)
    if (sql[i] === '`') {
      let s = '`';
      i++;
      while (i < len && sql[i] !== '`') s += sql[i++];
      if (i < len) { s += '`'; i++; }
      tokens.push({ type: 'identifier', value: s });
      continue;
    }
    // Number
    if (/\d/.test(sql[i]) || (sql[i] === '.' && i + 1 < len && /\d/.test(sql[i + 1]))) {
      let n = '';
      while (i < len && /[\d.eE+\-]/.test(sql[i])) n += sql[i++];
      tokens.push({ type: 'number', value: n });
      continue;
    }
    // Parentheses
    if (sql[i] === '(') { tokens.push({ type: 'open_paren', value: '(' }); i++; continue; }
    if (sql[i] === ')') { tokens.push({ type: 'close_paren', value: ')' }); i++; continue; }
    // Comma
    if (sql[i] === ',') { tokens.push({ type: 'comma', value: ',' }); i++; continue; }
    // Semicolon
    if (sql[i] === ';') { tokens.push({ type: 'semicolon', value: ';' }); i++; continue; }
    // Operators
    if ('=<>!+*/%|&^~'.includes(sql[i])) {
      let op = sql[i++];
      if (i < len && '=<>'.includes(sql[i])) op += sql[i++];
      tokens.push({ type: 'operator', value: op });
      continue;
    }
    // Word (keyword or identifier)
    if (/[a-zA-Z_@#]/.test(sql[i])) {
      let w = '';
      while (i < len && /[a-zA-Z0-9_@#.$]/.test(sql[i])) w += sql[i++];
      tokens.push({ type: 'word', value: w });
      continue;
    }
    // Other character
    tokens.push({ type: 'other', value: sql[i++] });
  }
  return tokens.filter(t => t.type !== 'whitespace');
}

function formatSQL() {
  const raw = input.value.trim();
  if (!raw) return;

  const uc = document.getElementById('uppercase').checked;
  const indSel = document.getElementById('indentSize').value;
  const indUnit = indSel === 'tab' ? '\t' : ' '.repeat(parseInt(indSel));

  const tokens = tokenize(raw);
  const lines = [];
  let currentLine = '';
  let indentLevel = 0;
  let parenDepth = 0;
  const parenStack = [];

  function indent() { return indUnit.repeat(indentLevel); }
  function pushLine(extra) {
    if (currentLine.trim()) lines.push(currentLine);
    currentLine = (extra !== undefined ? extra : indent());
  }
  function kwUpper(w) { return uc ? w.toUpperCase() : w; }

  function isKeyword(w) { return ALL_KEYWORDS.includes(w.toUpperCase()); }
  function isMajor(idx) {
    const combined = [...MAJOR_KEYWORDS, ...JOIN_KEYWORDS];
    for (const kw of combined) {
      const parts = kw.split(' ');
      if (parts.length === 1 && tokens[idx].value.toUpperCase() === parts[0]) return kw;
      if (parts.length === 2 && tokens[idx].value.toUpperCase() === parts[0]) {
        let ni = idx + 1;
        while (ni < tokens.length && tokens[ni].type === 'whitespace') ni++;
        if (ni < tokens.length && tokens[ni].value.toUpperCase() === parts[1]) return kw;
      }
      if (parts.length === 3 && tokens[idx].value.toUpperCase() === parts[0]) {
        let ni = idx + 1;
        while (ni < tokens.length && tokens[ni].type === 'whitespace') ni++;
        if (ni < tokens.length && tokens[ni].value.toUpperCase() === parts[1]) {
          let ni2 = ni + 1;
          while (ni2 < tokens.length && tokens[ni2].type === 'whitespace') ni2++;
          if (ni2 < tokens.length && tokens[ni2].value.toUpperCase() === parts[2]) return kw;
        }
      }
    }
    return null;
  }

  function isFunction(w) { return FUNCTIONS.includes(w.toUpperCase()); }

  let i = 0;
  while (i < tokens.length) {
    const tok = tokens[i];
    const uVal = tok.type === 'word' ? tok.value.toUpperCase() : '';

    // Check for multi-word major keywords
    const majorKw = (tok.type === 'word') ? isMajor(i) : null;

    if (majorKw && parenDepth === 0) {
      const parts = majorKw.split(' ');
      const isJoin = JOIN_KEYWORDS.includes(majorKw);

      if (['SELECT','INSERT INTO','UPDATE','DELETE FROM','DELETE','CREATE TABLE','ALTER TABLE',
           'DROP TABLE','CREATE INDEX','DROP INDEX','CREATE VIEW','WITH','TRUNCATE',
           'MERGE','EXPLAIN','GRANT','REVOKE'].includes(majorKw)) {
        if (lines.length > 0 || currentLine.trim()) pushLine(indent());
        currentLine = indent() + kwUpper(majorKw);
      } else if (isJoin) {
        pushLine(indent());
        currentLine = indent() + kwUpper(majorKw);
      } else if (['UNION ALL','UNION','INTERSECT','EXCEPT'].includes(majorKw)) {
        pushLine('');
        currentLine = kwUpper(majorKw);
        pushLine(indent());
        currentLine = indent();
        i += parts.length;
        continue;
      } else {
        pushLine(indent());
        currentLine = indent() + kwUpper(majorKw);
      }
      i += parts.length;
      continue;
    }

    if (tok.type === 'word' && ['AND','OR'].includes(uVal) && parenDepth === 0) {
      pushLine(indent());
      currentLine = indent() + indUnit + kwUpper(uVal);
      i++;
      continue;
    }

    if (tok.type === 'word' && uVal === 'CASE') {
      currentLine += ' ' + kwUpper('CASE');
      indentLevel++;
      i++;
      continue;
    }

    if (tok.type === 'word' && ['WHEN','THEN','ELSE'].includes(uVal) && parenDepth === 0) {
      if (uVal === 'WHEN') {
        pushLine(indent());
        currentLine = indent() + kwUpper(uVal);
      } else {
        currentLine += ' ' + kwUpper(uVal);
      }
      i++;
      continue;
    }

    if (tok.type === 'word' && uVal === 'END') {
      indentLevel = Math.max(0, indentLevel - 1);
      pushLine(indent());
      currentLine = indent() + kwUpper('END');
      i++;
      continue;
    }

    if (tok.type === 'open_paren') {
      parenDepth++;
      parenStack.push(indentLevel);
      // Check if this starts a subquery
      let ni = i + 1;
      while (ni < tokens.length && tokens[ni].type === 'whitespace') ni++;
      const nextIsSelect = ni < tokens.length && tokens[ni].type === 'word' && tokens[ni].value.toUpperCase() === 'SELECT';
      if (nextIsSelect) {
        currentLine += ' (';
        pushLine('');
        indentLevel++;
        currentLine = indent();
      } else {
        currentLine += '(';
      }
      i++;
      continue;
    }

    if (tok.type === 'close_paren') {
      parenDepth = Math.max(0, parenDepth - 1);
      if (parenStack.length) {
        const prev = parenStack.pop();
        if (indentLevel > prev) {
          indentLevel = prev;
          pushLine(indent());
          currentLine = indent() + ')';
        } else {
          currentLine += ')';
        }
      } else {
        currentLine += ')';
      }
      i++;
      continue;
    }

    if (tok.type === 'comma') {
      currentLine += ',';
      if (parenDepth === 0) {
        pushLine(indent());
        currentLine = indent() + indUnit;
      }
      i++;
      continue;
    }

    if (tok.type === 'semicolon') {
      currentLine += ';';
      pushLine('');
      currentLine = '';
      i++;
      continue;
    }

    if (tok.type === 'comment') {
      if (currentLine.trim()) currentLine += ' ';
      currentLine += tok.value;
      i++;
      continue;
    }

    // Keywords and identifiers
    if (tok.type === 'word') {
      const word = isKeyword(uVal) ? kwUpper(tok.value) : tok.value;
      if (currentLine.trim() && !currentLine.endsWith('(') && !currentLine.endsWith('.')) {
        currentLine += ' ';
      }
      currentLine += word;
      i++;
      continue;
    }

    // Functions
    if (tok.type === 'word' && isFunction(uVal)) {
      if (currentLine.trim()) currentLine += ' ';
      currentLine += kwUpper(tok.value);
      i++;
      continue;
    }

    // Everything else
    if (tok.type === 'operator') {
      currentLine += ' ' + tok.value + ' ';
    } else if (tok.type === 'string' || tok.type === 'number' || tok.type === 'identifier') {
      if (currentLine.trim() && !currentLine.endsWith('(') && !currentLine.endsWith('.')) {
        currentLine += ' ';
      }
      currentLine += tok.value;
    } else {
      currentLine += tok.value;
    }
    i++;
  }
  if (currentLine.trim()) lines.push(currentLine);

  lastFormatted = lines.join('\n');
  renderOutput(lastFormatted);
  statusText.textContent = 'Formatted — ' + lines.length + ' lines';
  outputInfo.textContent = lines.length + ' lines';
}

function minifySQL() {
  const raw = input.value.trim();
  if (!raw) return;
  const uc = document.getElementById('uppercase').checked;
  const tokens = tokenize(raw);
  let result = '';
  for (let i = 0; i < tokens.length; i++) {
    const tok = tokens[i];
    if (tok.type === 'comment') continue;
    if (tok.type === 'word') {
      if (result && !/[(,.]$/.test(result.trim())) result += ' ';
      result += uc && ALL_KEYWORDS.includes(tok.value.toUpperCase()) ? tok.value.toUpperCase() : tok.value;
    } else if (tok.type === 'string' || tok.type === 'number' || tok.type === 'identifier') {
      if (result && !/[(,.]$/.test(result.trim())) result += ' ';
      result += tok.value;
    } else if (tok.type === 'operator') {
      result += ' ' + tok.value + ' ';
    } else {
      result += tok.value;
    }
  }
  lastFormatted = result.replace(/\s+/g, ' ').trim();
  renderOutput(lastFormatted);
  statusText.textContent = 'Minified — ' + formatBytes(new Blob([lastFormatted]).size);
  outputInfo.textContent = formatBytes(new Blob([lastFormatted]).size);
}

function renderOutput(sql) {
  const lines = sql.split('\n');
  let html = '';
  for (let i = 0; i < lines.length; i++) {
    html += '<div class="output-line"><span class="line-num">' + (i + 1) + '</span><span class="line-content">' + highlightSQL(escapeHtml(lines[i])) + '</span></div>';
  }
  formattedOutput.innerHTML = html;
}

function highlightSQL(line) {
  // Highlight comments
  line = line.replace(/(--[^\n]*)/g, '<span class="hl-comment">$1</span>');
  line = line.replace(/(\/\*[\s\S]*?\*\/)/g, '<span class="hl-comment">$1</span>');
  // Highlight strings
  line = line.replace(/(&apos;(?:[^&]|&(?!apos;))*&apos;|&#39;(?:[^&]|&(?!#39;))*&#39;|'[^']*')/g, '<span class="hl-string">$1</span>');
  // Highlight numbers (standalone)
  line = line.replace(/\b(\d+(?:\.\d+)?(?:[eE][+\-]?\d+)?)\b/g, '<span class="hl-number">$1</span>');
  // Highlight keywords (case-insensitive, word boundary)
  const kwPattern = ALL_KEYWORDS.map(k => k.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')).sort((a, b) => b.length - a.length).join('|');
  line = line.replace(new RegExp('\\b(' + kwPattern + ')\\b', 'gi'), function(m) {
    return '<span class="hl-keyword">' + m + '</span>';
  });
  // Highlight functions
  const fnPattern = FUNCTIONS.sort((a, b) => b.length - a.length).join('|');
  line = line.replace(new RegExp('\\b(' + fnPattern + ')\\s*(?=\\()', 'gi'), function(m) {
    return '<span class="hl-function">' + m + '</span>';
  });
  // Highlight operators
  line = line.replace(/([=&lt;&gt;!]+|[+\-*/%])/g, '<span class="hl-operator">$1</span>');
  return line;
}

function escapeHtml(s) { return s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;'); }

function copyOutput() {
  if (!lastFormatted) { showToast('Nothing to copy'); return; }
  navigator.clipboard.writeText(lastFormatted).then(() => showToast('Copied to clipboard'));
}

function downloadSQL() {
  if (!lastFormatted) { showToast('Nothing to download'); return; }
  const blob = new Blob([lastFormatted], { type: 'text/sql' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'formatted.sql';
  a.click();
  URL.revokeObjectURL(a.href);
  showToast('Downloaded formatted.sql');
}

function clearAll() {
  input.value = '';
  formattedOutput.innerHTML = '';
  lastFormatted = '';
  statusText.textContent = 'Paste SQL to begin';
  sizeInfo.textContent = '';
  lineCount.textContent = '';
  outputInfo.textContent = '';
}

function loadSample() {
  input.value = `SELECT
  u.id, u.name, u.email,
  COUNT(o.id) AS total_orders,
  SUM(o.amount) AS total_spent,
  MAX(o.created_at) AS last_order
FROM users u
INNER JOIN orders o ON u.id = o.user_id
LEFT JOIN addresses a ON u.id = a.user_id AND a.is_primary = TRUE
WHERE u.status = 'active'
  AND o.created_at >= '2026-01-01'
  AND o.amount > 0
GROUP BY u.id, u.name, u.email
HAVING COUNT(o.id) > 5
ORDER BY total_spent DESC
LIMIT 100;

INSERT INTO audit_log (user_id, action, details, created_at)
VALUES (42, 'login', '{"ip": "192.168.1.1"}', NOW());

UPDATE products SET price = price * 1.10, updated_at = NOW() WHERE category_id IN (SELECT id FROM categories WHERE name = 'Electronics') AND active = TRUE;

CREATE TABLE IF NOT EXISTS invoices (
  id SERIAL PRIMARY KEY,
  user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  amount DECIMAL(10, 2) NOT NULL DEFAULT 0.00,
  status VARCHAR(20) DEFAULT 'pending',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT chk_amount CHECK (amount >= 0)
);`;
  updateLineCount();
  autoProcess();
}

function formatBytes(bytes) {
  if (bytes === 0) return '0 B';
  const k = 1024, sizes = ['B', 'KB', 'MB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2000);
}

input.addEventListener('keydown', e => {
  if (e.key === 'Tab') {
    e.preventDefault();
    const start = input.selectionStart, end = input.selectionEnd;
    input.value = input.value.substring(0, start) + '  ' + input.value.substring(end);
    input.selectionStart = input.selectionEnd = start + 2;
  }
});

const observer = new IntersectionObserver(entries => {
  entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('visible'); observer.unobserve(entry.target); }});
}, { threshold: 0.1 });
document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));
</script>
<script src="/js/analytics-lite.js" defer></script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What is a SQL formatter?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "A SQL formatter is a tool that takes raw SQL queries and reformats them with proper indentation, line breaks, and keyword casing to make them easier to read, debug, and maintain. ANIMA's SQL Formatter supports SELECT, INSERT, UPDATE, DELETE, CREATE TABLE, JOINs, and subqueries."
      }
    },
    {
      "@type": "Question",
      "name": "Does this SQL formatter support different dialects?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, ANIMA's SQL Formatter supports Standard SQL, MySQL, PostgreSQL, and SQLite dialects. Each dialect recognizes its specific keywords and syntax patterns for accurate formatting."
      }
    },
    {
      "@type": "Question",
      "name": "Can I minify SQL with this tool?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, the minify button compresses your SQL into a single line by removing all unnecessary whitespace and comments. This is useful for embedding SQL in code or reducing payload size."
      }
    },
    {
      "@type": "Question",
      "name": "Is this SQL formatter free to use?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, ANIMA's SQL Formatter is completely free. No signup, no download required. It runs entirely in your browser for privacy and speed."
      }
    }
  ]
}
</script>
</body>
</html>
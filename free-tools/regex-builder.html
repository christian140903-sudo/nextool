<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Regex Pattern Builder - Test & Build Regex Online | NexTool</title>
<meta name="description" content="Build and test regular expressions visually. Add pattern components, see real-time matches, get plain English explanations. Free regex builder tool.">
<meta property="og:title" content="Interactive Regex Pattern Builder - NexTool">
<meta property="og:description" content="Visual regex builder with live testing, pattern library, and plain English explanations.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/regex-builder.html">
<meta property="og:image" content="https://nextool.app/assets/og-default.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Interactive Regex Pattern Builder - NexTool">
<meta name="twitter:description" content="Visual regex builder with live testing, pattern library, and plain English explanations.">
<link rel="canonical" href="https://nextool.app/free-tools/regex-builder.html">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"Interactive Regex Pattern Builder","description":"Build, test, and understand regular expressions with a visual interface.","url":"https://nextool.app/free-tools/regex-builder.html","applicationCategory":"DeveloperApplication","operatingSystem":"Any","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"author":{"@type":"Organization","name":"NexTool"}}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--primary:#6366f1;--accent:#a855f7;--pink:#ec4899;--text:#e2e8f0;--text-dim:#94a3b8;--green:#22c55e;--red:#ef4444;--yellow:#eab308;--radius:12px;--radius-lg:20px}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;line-height:1.6}
nav{position:fixed;top:0;left:0;right:0;z-index:100;background:rgba(5,5,8,.85);backdrop-filter:blur(16px);border-bottom:1px solid rgba(99,102,241,.15);padding:0 24px;height:60px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{display:flex;align-items:center;gap:10px;font-weight:700;font-size:1.2rem;color:var(--text);text-decoration:none}
.nav-logo span{background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:1.4rem;font-weight:800}
.nav-links{display:flex;align-items:center;gap:20px}
.nav-links a{color:var(--text-dim);text-decoration:none;font-size:.9rem;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-badge{background:linear-gradient(135deg,#6366f1,#a855f7);color:#fff!important;padding:6px 14px;border-radius:20px;font-size:.8rem;font-weight:600}
main{max-width:1100px;margin:0 auto;padding:80px 20px 40px}
h1{font-size:2rem;font-weight:700;margin-bottom:8px}
.gradient-text{background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.subtitle{color:var(--text-dim);margin-bottom:24px;font-size:1.05rem}
.section-title{font-size:1.1rem;font-weight:600;margin:24px 0 12px;display:flex;align-items:center;gap:8px}
.card{background:var(--surface);border:1px solid rgba(99,102,241,.12);border-radius:var(--radius-lg);padding:20px;margin-bottom:16px}
.regex-display{font-family:'JetBrains Mono',monospace;font-size:1.1rem;padding:14px 18px;background:var(--surface2);border:2px solid var(--primary);border-radius:var(--radius);word-break:break-all;display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:16px}
.regex-display code{flex:1;color:var(--pink)}
.btn{background:var(--surface2);color:var(--text);border:1px solid rgba(99,102,241,.2);padding:8px 16px;border-radius:var(--radius);cursor:pointer;font-family:inherit;font-size:.85rem;transition:all .2s}
.btn:hover{border-color:var(--primary);background:rgba(99,102,241,.1)}
.btn-primary{background:var(--primary);border-color:var(--primary);color:#fff}
.btn-primary:hover{background:#5558e6}
.btn-sm{padding:5px 12px;font-size:.8rem;border-radius:8px}
.flags-row{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:16px}
.flag-btn{padding:6px 14px;border-radius:8px;border:1px solid rgba(99,102,241,.2);background:var(--surface2);color:var(--text-dim);cursor:pointer;font-family:'JetBrains Mono',monospace;font-size:.85rem;transition:all .2s}
.flag-btn.active{background:var(--primary);border-color:var(--primary);color:#fff}
.components-grid{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:16px}
.comp-btn{padding:7px 14px;border-radius:8px;border:1px solid rgba(99,102,241,.15);background:var(--surface2);color:var(--text);cursor:pointer;font-size:.83rem;transition:all .2s}
.comp-btn:hover{border-color:var(--accent);background:rgba(168,85,247,.1)}
.input-row{display:flex;gap:10px;margin-bottom:12px;align-items:center}
.input-row input,.input-row textarea{background:var(--surface2);border:1px solid rgba(99,102,241,.2);color:var(--text);padding:10px 14px;border-radius:var(--radius);font-family:'JetBrains Mono',monospace;font-size:.88rem;outline:none;flex:1}
.input-row input:focus,.input-row textarea:focus{border-color:var(--primary)}
textarea.test-input{width:100%;min-height:100px;background:var(--surface2);border:1px solid rgba(99,102,241,.2);color:var(--text);padding:14px;border-radius:var(--radius);font-family:'JetBrains Mono',monospace;font-size:.88rem;outline:none;resize:vertical}
textarea.test-input:focus{border-color:var(--primary)}
.match-output{background:var(--surface2);border-radius:var(--radius);padding:14px;font-family:'JetBrains Mono',monospace;font-size:.88rem;min-height:50px;white-space:pre-wrap;line-height:1.7}
.match-output mark{background:rgba(168,85,247,.3);color:#e9d5ff;border-radius:3px;padding:1px 2px}
.match-count{font-size:.85rem;color:var(--text-dim);margin-bottom:8px}
.groups-box{background:var(--surface2);border-radius:var(--radius);padding:14px;font-size:.85rem;line-height:1.6;margin-top:12px}
.groups-box .group-item{display:flex;gap:8px;padding:4px 0;border-bottom:1px solid rgba(99,102,241,.06)}
.groups-box .group-item:last-child{border-bottom:none}
.groups-box .group-label{color:var(--accent);font-weight:600;min-width:90px;font-family:'JetBrains Mono',monospace;font-size:.82rem}
.groups-box .group-value{color:var(--text);font-family:'JetBrains Mono',monospace;font-size:.82rem}
.explanation{background:var(--surface2);border-radius:var(--radius);padding:14px;font-size:.9rem;line-height:1.7;color:var(--text-dim)}
.explanation strong{color:var(--text)}
.library-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px}
.library-item{background:var(--surface2);border:1px solid rgba(99,102,241,.1);border-radius:var(--radius);padding:10px 14px;cursor:pointer;transition:all .2s}
.library-item:hover{border-color:var(--accent);background:rgba(168,85,247,.08)}
.library-item .lib-name{font-weight:600;font-size:.85rem;margin-bottom:2px}
.library-item .lib-pattern{font-family:'JetBrains Mono',monospace;font-size:.75rem;color:var(--pink);word-break:break-all}
.replace-output{background:var(--surface2);border-radius:var(--radius);padding:14px;font-family:'JetBrains Mono',monospace;font-size:.88rem;min-height:40px;white-space:pre-wrap;color:var(--green)}
.toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(80px);background:var(--green);color:#000;padding:10px 24px;border-radius:var(--radius);font-weight:600;font-size:.9rem;opacity:0;transition:all .3s ease;z-index:200;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0);opacity:1}
.cta-section{margin-top:60px;text-align:center;padding:48px 24px;background:var(--surface);border:1px solid rgba(99,102,241,.15);border-radius:var(--radius-lg)}
.cta-section h2{font-size:1.5rem;margin-bottom:12px}
.cta-section p{color:var(--text-dim);margin-bottom:24px;max-width:520px;margin-left:auto;margin-right:auto}
.cta-buttons{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
.cta-bundle{background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);color:#fff;padding:12px 28px;border-radius:var(--radius);text-decoration:none;font-weight:600;font-size:.95rem}
.cta-browse{background:var(--surface2);color:var(--text);padding:12px 28px;border-radius:var(--radius);text-decoration:none;font-weight:500;font-size:.95rem;border:1px solid rgba(99,102,241,.2)}
footer{margin-top:60px;padding:32px 24px;border-top:1px solid rgba(99,102,241,.1);text-align:center}
.footer-links{display:flex;justify-content:center;gap:24px;flex-wrap:wrap;margin-bottom:16px}
.footer-links a{color:var(--text-dim);text-decoration:none;font-size:.85rem}
.footer-links a:hover{color:var(--text)}
.footer-copy{color:var(--text-dim);font-size:.8rem}
@media(max-width:600px){
  h1{font-size:1.5rem}
  .nav-links a:not(.nav-badge){display:none}
  .library-grid{grid-template-columns:1fr}
  .groups-box .group-item{flex-direction:column;gap:2px}
}
</style>
</head>
<body>
<nav>
  <a href="/" class="nav-logo"><span>N</span> NexTool</a>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Tools</a>
    <a href="/pro.html" class="nav-badge">Get Pro</a>
  </div>
</nav>
<main>
  <h1><span class="gradient-text">Regex Pattern</span> Builder</h1>
  <p class="subtitle">Build, test, and understand regular expressions with an interactive visual interface.</p>

  <div class="regex-display">
    <code id="regexPreview">/your pattern here/g</code>
    <button class="btn btn-sm" onclick="copyRegex()">Copy</button>
  </div>

  <div class="card">
    <div class="section-title">Pattern Input</div>
    <div class="input-row">
      <input type="text" id="patternInput" placeholder="Type or build your regex..." oninput="update()">
      <button class="btn" onclick="clearPattern()">Clear</button>
    </div>
    <div class="section-title">Flags</div>
    <div class="flags-row">
      <button class="flag-btn active" data-flag="g" onclick="toggleFlag(this)">g <small>global</small></button>
      <button class="flag-btn" data-flag="i" onclick="toggleFlag(this)">i <small>insensitive</small></button>
      <button class="flag-btn" data-flag="m" onclick="toggleFlag(this)">m <small>multiline</small></button>
      <button class="flag-btn" data-flag="s" onclick="toggleFlag(this)">s <small>dotall</small></button>
      <button class="flag-btn" data-flag="u" onclick="toggleFlag(this)">u <small>unicode</small></button>
    </div>
    <div class="section-title">Quick Add Components</div>
    <div class="components-grid">
      <button class="comp-btn" onclick="addComp('.')">. any</button>
      <button class="comp-btn" onclick="addComp('\\d')">\\d digit</button>
      <button class="comp-btn" onclick="addComp('\\w')">\\w word</button>
      <button class="comp-btn" onclick="addComp('\\s')">\\s space</button>
      <button class="comp-btn" onclick="addComp('\\D')">\\D non-digit</button>
      <button class="comp-btn" onclick="addComp('\\W')">\\W non-word</button>
      <button class="comp-btn" onclick="addComp('\\S')">\\S non-space</button>
      <button class="comp-btn" onclick="addComp('[abc]')">[abc] set</button>
      <button class="comp-btn" onclick="addComp('[^abc]')">[^abc] negate</button>
      <button class="comp-btn" onclick="addComp('[a-z]')">[a-z] range</button>
      <button class="comp-btn" onclick="addComp('+')">+ one+</button>
      <button class="comp-btn" onclick="addComp('*')">* zero+</button>
      <button class="comp-btn" onclick="addComp('?')">? optional</button>
      <button class="comp-btn" onclick="addComp('{n,m}')">{n,m} range</button>
      <button class="comp-btn" onclick="addComp('()')">(group)</button>
      <button class="comp-btn" onclick="addComp('(?:)')">(?:) non-cap</button>
      <button class="comp-btn" onclick="addComp('^')">^ start</button>
      <button class="comp-btn" onclick="addComp('$')">$ end</button>
      <button class="comp-btn" onclick="addComp('\\b')">\\b boundary</button>
      <button class="comp-btn" onclick="addComp('|')">| or</button>
      <button class="comp-btn" onclick="addComp('(?=)')">(?=) lookahead</button>
      <button class="comp-btn" onclick="addComp('(?!)')">(?!) neg look</button>
      <button class="comp-btn" onclick="addComp('(?<=)')">(?<=) lookbehind</button>
      <button class="comp-btn" onclick="addComp('(?<!)')">(?<!) neg lb</button>
    </div>
  </div>

  <div class="card">
    <div class="section-title">Test String</div>
    <textarea class="test-input" id="testInput" placeholder="Type or paste text to test your regex against..." oninput="update()">The quick brown fox jumps over the lazy dog. Contact: user@email.com or call 555-123-4567. Visit https://nextool.app for more info.</textarea>
    <div class="match-count" id="matchCount"></div>
    <div class="match-output" id="matchOutput"></div>
    <div class="groups-box" id="groupsBox" style="display:none">
      <div style="font-weight:600;margin-bottom:6px;color:var(--accent)">Captured Groups</div>
      <div id="groupsList"></div>
    </div>
  </div>

  <div class="card">
    <div class="section-title">Replace</div>
    <div class="input-row">
      <input type="text" id="replaceInput" placeholder="Replacement string ($1 for groups)..." oninput="update()">
    </div>
    <div class="replace-output" id="replaceOutput"></div>
  </div>

  <div class="card">
    <div class="section-title">Pattern Explanation</div>
    <div class="explanation" id="explanation">Enter a pattern above to see an explanation.</div>
  </div>

  <div class="card">
    <div class="section-title">Common Pattern Library</div>
    <div class="library-grid" id="libraryGrid"></div>
  </div>

  <section class="cta-section">
    <h2>Love this tool? Get the <span class="gradient-text">Ultimate Bundle</span></h2>
    <p>Access 100+ premium developer tools, templates, and automations for a one-time payment of $39.</p>
    <div class="cta-buttons">
      <a href="/pro.html" class="cta-bundle">Get Pro &mdash; $29</a>
      <a href="/free-tools/" class="cta-browse">Browse 245+ Free Tools &rarr;</a>
    </div>
  </section>
</main>

<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/box-shadow-generator.html" style="color:var(--primary);text-decoration:none">CSS Box Shadow Generator</a> · <a href="/free-tools/emoji-picker.html" style="color:var(--primary);text-decoration:none">Emoji Picker & Search</a> · <a href="/free-tools/meta-tag-generator.html" style="color:var(--primary);text-decoration:none">Meta Tag Generator</a> · <a href="/free-tools/password-generator.html" style="color:var(--primary);text-decoration:none">Free Secure Password Generator</a> · <a href="/free-tools/color-palette.html" style="color:var(--primary);text-decoration:none">Free Color Palette Generator</a></p>
</div>

<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/favicon-generator.html" style="color:var(--primary);text-decoration:none">Favicon Generator</a> · <a href="/free-tools/git-diff-viewer.html" style="color:var(--primary);text-decoration:none">Free Git Diff Viewer</a> · <a href="/free-tools/http-status-codes.html" style="color:var(--primary);text-decoration:none">HTTP Status Code Reference</a></p>
</div>

<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/color-palette-generator.html" style="color:var(--primary);text-decoration:none">Free Color Palette Generator</a> · <a href="/free-tools/icon-generator.html" style="color:var(--primary);text-decoration:none">Free Icon Generator</a> · <a href="/free-tools/regex-generator.html" style="color:var(--primary);text-decoration:none">Free Regex Pattern Generator</a></p>
</div>
<footer>
  <div class="footer-links">
    <a href="/">Home</a><a href="/free-tools/">Tools</a><a href="/blog/">Blog</a><a href="/pro.html">Pro</a><a href="/#contact">Contact</a>
  </div>
  <div class="footer-copy">&copy; 2026 NexTool. All rights reserved.</div>
</footer>
<div class="toast" id="toast">Copied!</div>

<script>
/* ===== DOM HELPER ===== */
var $ = function(id) {
  return document.getElementById(id);
};

/* ===== STATE ===== */
var flags = new Set(['g']);

/* ===== TOAST NOTIFICATIONS ===== */
function showToast(message) {
  var toastEl = $('toast');
  toastEl.textContent = message;
  toastEl.classList.add('show');
  setTimeout(function() {
    toastEl.classList.remove('show');
  }, 1800);
}

/* ===== PATTERN LIBRARY: 16 common regex patterns ===== */
var patterns = [
  {
    name: 'Email Address',
    pattern: '[\\w.-]+@[\\w.-]+\\.[a-zA-Z]{2,}'
  },
  {
    name: 'URL (http/https)',
    pattern: 'https?://[\\w.-]+(?:\\.[a-zA-Z]{2,})(?:/[^\\s]*)?'
  },
  {
    name: 'Phone (US)',
    pattern: '\\(?\\d{3}\\)?[-.\\s]?\\d{3}[-.\\s]?\\d{4}'
  },
  {
    name: 'IPv4 Address',
    pattern: '\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b'
  },
  {
    name: 'Date (YYYY-MM-DD)',
    pattern: '\\d{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[12]\\d|3[01])'
  },
  {
    name: 'Time (HH:MM)',
    pattern: '(?:[01]\\d|2[0-3]):[0-5]\\d'
  },
  {
    name: 'Hex Color',
    pattern: '#(?:[0-9a-fA-F]{3}){1,2}\\b'
  },
  {
    name: 'HTML Tag',
    pattern: '<([a-zA-Z][a-zA-Z0-9]*)\\b[^>]*>'
  },
  {
    name: 'UUID',
    pattern: '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'
  },
  {
    name: 'Credit Card',
    pattern: '\\b(?:\\d[ -]*?){13,19}\\b'
  },
  {
    name: 'ZIP Code (US)',
    pattern: '\\b\\d{5}(?:-\\d{4})?\\b'
  },
  {
    name: 'Username',
    pattern: '[a-zA-Z][a-zA-Z0-9_]{2,15}'
  },
  {
    name: 'Strong Password',
    pattern: '(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}'
  },
  {
    name: 'Slug (URL path)',
    pattern: '[a-z0-9]+(?:-[a-z0-9]+)*'
  },
  {
    name: 'CSS Class Selector',
    pattern: '\\.[a-zA-Z_][\\w-]*'
  },
  {
    name: 'JSON Key',
    pattern: '"([^"]+)"\\s*:'
  }
];

/* ===== INITIALIZE PATTERN LIBRARY GRID ===== */
function initLibrary() {
  var grid = $('libraryGrid');
  patterns.forEach(function(p) {
    var div = document.createElement('div');
    div.className = 'library-item';
    div.innerHTML = '<div class="lib-name">' + p.name + '</div>'
      + '<div class="lib-pattern">' + escHtml(p.pattern) + '</div>';
    div.addEventListener('click', function() {
      $('patternInput').value = p.pattern;
      update();
      showToast('Loaded: ' + p.name);
    });
    grid.appendChild(div);
  });
}

/* ===== HTML ESCAPING ===== */
function escHtml(s) {
  return s
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;');
}

/* ===== FLAG TOGGLE ===== */
function toggleFlag(el) {
  var f = el.dataset.flag;
  if (flags.has(f)) {
    flags.delete(f);
    el.classList.remove('active');
  } else {
    flags.add(f);
    el.classList.add('active');
  }
  update();
}

/* ===== ADD PATTERN COMPONENT ===== */
function addComp(c) {
  var input = $('patternInput');
  var start = input.selectionStart;
  var end = input.selectionEnd;
  var val = input.value;
  input.value = val.slice(0, start) + c + val.slice(end);
  input.focus();
  input.selectionStart = start + c.length;
  input.selectionEnd = start + c.length;
  update();
}

/* ===== CLEAR PATTERN ===== */
function clearPattern() {
  $('patternInput').value = '';
  update();
}

/* ===== GET SORTED FLAGS STRING ===== */
function getFlags() {
  return Array.from(flags).sort().join('');
}

/* ===== MAIN UPDATE FUNCTION ===== */
function update() {
  var pattern = $('patternInput').value;
  var flagStr = getFlags();

  /* Update the regex preview display */
  $('regexPreview').textContent = '/' + pattern + '/' + flagStr;

  var test = $('testInput').value;
  var matchOut = $('matchOutput');
  var countEl = $('matchCount');
  var replaceOut = $('replaceOutput');
  var replaceStr = $('replaceInput').value;
  var groupsBox = $('groupsBox');

  /* Handle empty pattern state */
  if (!pattern) {
    matchOut.innerHTML = escHtml(test);
    countEl.textContent = '';
    replaceOut.textContent = '';
    groupsBox.style.display = 'none';
    $('explanation').innerHTML = 'Enter a pattern above to see an explanation.';
    return;
  }

  try {
    var regex = new RegExp(pattern, flagStr);
    var count = 0;

    /* Highlight all matches in the test string */
    if (flagStr.includes('g')) {
      var result;
      var ranges = [];
      regex.lastIndex = 0;

      while ((result = regex.exec(test)) !== null) {
        ranges.push({
          start: result.index,
          end: result.index + result[0].length,
          groups: result.slice(1)
        });
        count++;
        /* Prevent infinite loops on zero-length matches */
        if (result[0].length === 0) {
          regex.lastIndex++;
        }
        if (count > 1000) {
          break;
        }
      }

      /* Build highlighted HTML from match ranges */
      var html = '';
      var last = 0;
      ranges.forEach(function(r) {
        html += escHtml(test.slice(last, r.start));
        html += '<mark>' + escHtml(test.slice(r.start, r.end)) + '</mark>';
        last = r.end;
      });
      html += escHtml(test.slice(last));
      matchOut.innerHTML = html || escHtml(test);

      /* Display captured groups from the first match */
      if (ranges.length > 0 && ranges[0].groups.length > 0) {
        displayGroups(ranges[0].groups);
      } else {
        groupsBox.style.display = 'none';
      }

    } else {
      /* Non-global mode: highlight only the first match */
      var m = regex.exec(test);
      if (m) {
        count = 1;
        matchOut.innerHTML = escHtml(test.slice(0, m.index))
          + '<mark>' + escHtml(m[0]) + '</mark>'
          + escHtml(test.slice(m.index + m[0].length));

        /* Display groups if any */
        if (m.length > 1) {
          displayGroups(m.slice(1));
        } else {
          groupsBox.style.display = 'none';
        }
      } else {
        matchOut.innerHTML = escHtml(test);
        groupsBox.style.display = 'none';
      }
    }

    /* Update match count display */
    countEl.textContent = count + ' match' + (count !== 1 ? 'es' : '') + ' found';
    countEl.style.color = count > 0 ? '#22c55e' : '#ef4444';

    /* Perform replacement if replacement string is provided */
    if (replaceStr) {
      try {
        replaceOut.textContent = test.replace(regex, replaceStr);
      } catch (e) {
        replaceOut.textContent = 'Error: ' + e.message;
      }
    } else {
      replaceOut.textContent = '';
    }

    /* Generate and display regex explanation */
    $('explanation').innerHTML = explainRegex(pattern);

  } catch (e) {
    /* Handle invalid regex patterns gracefully */
    matchOut.innerHTML = '<span style="color:#ef4444">Invalid regex: '
      + escHtml(e.message) + '</span>';
    countEl.textContent = '';
    replaceOut.textContent = '';
    groupsBox.style.display = 'none';
    $('explanation').innerHTML = '<span style="color:#ef4444">Cannot parse pattern.</span>';
  }
}

/* ===== DISPLAY CAPTURED GROUPS ===== */
function displayGroups(groups) {
  var groupsBox = $('groupsBox');
  var groupsList = $('groupsList');

  /* Filter to only defined groups */
  var validGroups = groups.filter(function(g) {
    return g !== undefined;
  });

  if (validGroups.length === 0) {
    groupsBox.style.display = 'none';
    return;
  }

  groupsBox.style.display = 'block';
  var html = '';
  groups.forEach(function(g, i) {
    var value = g !== undefined ? escHtml(g) : '<em style="color:var(--text-dim)">undefined</em>';
    html += '<div class="group-item">'
      + '<span class="group-label">Group $' + (i + 1) + '</span>'
      + '<span class="group-value">' + value + '</span>'
      + '</div>';
  });
  groupsList.innerHTML = html;
}

/* ===== REGEX PATTERN EXPLAINER ===== */
function explainRegex(p) {
  var parts = [];
  var i = 0;

  while (i < p.length) {
    var c = p[i];

    /* Handle escape sequences like \d, \w, \s, etc. */
    if (c === '\\') {
      var next = p[i + 1] || '';
      var escapeMap = {
        'd': '<strong>\\d</strong> &mdash; any digit (0-9)',
        'D': '<strong>\\D</strong> &mdash; any non-digit',
        'w': '<strong>\\w</strong> &mdash; any word character (a-z, A-Z, 0-9, _)',
        'W': '<strong>\\W</strong> &mdash; any non-word character',
        's': '<strong>\\s</strong> &mdash; any whitespace',
        'S': '<strong>\\S</strong> &mdash; any non-whitespace',
        'b': '<strong>\\b</strong> &mdash; word boundary',
        'n': '<strong>\\n</strong> &mdash; newline',
        't': '<strong>\\t</strong> &mdash; tab'
      };
      if (escapeMap[next]) {
        parts.push(escapeMap[next]);
      } else {
        parts.push('<strong>\\' + escHtml(next) + '</strong> &mdash; literal "' + escHtml(next) + '"');
      }
      i += 2;

    /* Handle character sets like [abc], [a-z], [^abc] */
    } else if (c === '[') {
      var endBracket = p.indexOf(']', i);
      if (endBracket > i) {
        var set = p.slice(i, endBracket + 1);
        parts.push('<strong>' + escHtml(set) + '</strong> &mdash; character set');
        i = endBracket + 1;
      } else {
        parts.push('<strong>[</strong> &mdash; literal bracket');
        i++;
      }

    /* Handle groups: capturing, non-capturing, lookahead, lookbehind */
    } else if (c === '(') {
      if (p.slice(i, i + 3) === '(?:') {
        parts.push('<strong>(?:...)</strong> &mdash; non-capturing group');
        i += 3;
      } else if (p.slice(i, i + 3) === '(?=') {
        parts.push('<strong>(?=...)</strong> &mdash; positive lookahead');
        i += 3;
      } else if (p.slice(i, i + 3) === '(?!') {
        parts.push('<strong>(?!...)</strong> &mdash; negative lookahead');
        i += 3;
      } else if (p.slice(i, i + 4) === '(?<=') {
        parts.push('<strong>(?&lt;=...)</strong> &mdash; positive lookbehind');
        i += 4;
      } else if (p.slice(i, i + 4) === '(?<!') {
        parts.push('<strong>(?&lt;!...)</strong> &mdash; negative lookbehind');
        i += 4;
      } else {
        parts.push('<strong>(</strong> &mdash; start capturing group');
        i++;
      }

    /* Handle closing parenthesis */
    } else if (c === ')') {
      parts.push('<strong>)</strong> &mdash; end group');
      i++;

    /* Handle anchors and metacharacters */
    } else if (c === '^') {
      parts.push('<strong>^</strong> &mdash; start of string/line');
      i++;
    } else if (c === '$') {
      parts.push('<strong>$</strong> &mdash; end of string/line');
      i++;
    } else if (c === '.') {
      parts.push('<strong>.</strong> &mdash; any character (except newline)');
      i++;

    /* Handle quantifiers */
    } else if (c === '+') {
      parts.push('<strong>+</strong> &mdash; one or more of previous');
      i++;
    } else if (c === '*') {
      parts.push('<strong>*</strong> &mdash; zero or more of previous');
      i++;
    } else if (c === '?') {
      parts.push('<strong>?</strong> &mdash; optional (zero or one)');
      i++;

    /* Handle alternation */
    } else if (c === '|') {
      parts.push('<strong>|</strong> &mdash; OR / alternation');
      i++;

    /* Handle range quantifiers like {n,m} */
    } else if (c === '{') {
      var endBrace = p.indexOf('}', i);
      if (endBrace > i) {
        var quant = p.slice(i, endBrace + 1);
        parts.push('<strong>' + escHtml(quant) + '</strong> &mdash; quantifier');
        i = endBrace + 1;
      } else {
        parts.push('<strong>{</strong> &mdash; literal');
        i++;
      }

    /* Handle literal text sequences */
    } else {
      var lit = c;
      i++;
      while (i < p.length && !/[\\[()^$.*+?|{]/.test(p[i])) {
        lit += p[i];
        i++;
      }
      parts.push('<strong>"' + escHtml(lit) + '"</strong> &mdash; literal text');
    }
  }

  /* Format as a numbered list */
  if (parts.length > 0) {
    return parts.map(function(part, idx) {
      return '<div style="margin:3px 0">' + (idx + 1) + '. ' + part + '</div>';
    }).join('');
  }
  return 'Enter a pattern to see explanation.';
}

/* ===== COPY REGEX TO CLIPBOARD ===== */
function copyRegex() {
  var pattern = $('patternInput').value;
  var flagStr = getFlags();
  var fullRegex = '/' + pattern + '/' + flagStr;

  navigator.clipboard.writeText(fullRegex).then(function() {
    showToast('Regex copied: ' + fullRegex);
  });
}

/* ===== INITIALIZE AND RUN ===== */
initLibrary();
update();
</script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script src="/js/analytics-lite.js" defer></script>
</body>
</html>

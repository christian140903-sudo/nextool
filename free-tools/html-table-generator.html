<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>HTML Table Generator — Free Online Tool | NexTool</title>
<meta name="description" content="Visual HTML table generator with live preview. Add rows, columns, headers, styling options. Import CSV data. Export clean HTML and CSS code instantly.">
<meta name="keywords" content="html table generator, table builder, csv to html table, table code generator, html table maker, responsive table">
<meta name="author" content="NexTool">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://nextool.app/free-tools/html-table-generator.html">
<meta property="og:title" content="HTML Table Generator — Free Online Tool | NexTool">
<meta property="og:description" content="Visual HTML table generator with live preview. Import CSV, export clean HTML + CSS.">
<meta property="og:image" content="https://nextool.app/assets/img/tools/html-table-generator-og.png">
<meta property="og:url" content="https://nextool.app/free-tools/html-table-generator.html">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="HTML Table Generator — Free Online Tool | NexTool">
<meta name="twitter:description" content="Visual HTML table generator. Import CSV, export HTML + CSS.">
<meta name="twitter:image" content="https://nextool.app/assets/img/tools/html-table-generator-og.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"BreadcrumbList",
  "itemListElement":[
    {"@type":"ListItem","position":1,"name":"Home","item":"https://nextool.app/"},
    {"@type":"ListItem","position":2,"name":"Free Tools","item":"https://nextool.app/free-tools/"},
    {"@type":"ListItem","position":3,"name":"HTML Table Generator","item":"https://nextool.app/free-tools/html-table-generator.html"}
  ]
}
</script>
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"FAQPage",
  "mainEntity":[
    {"@type":"Question","name":"How do I create an HTML table with this tool?","acceptedAnswer":{"@type":"Answer","text":"Click on any cell in the visual editor to type content. Use the toolbar buttons to add or remove rows and columns. Toggle style options like borders, striped rows, and hover effects. The HTML and CSS code is generated automatically and can be copied or downloaded."}},
    {"@type":"Question","name":"Can I import data from a CSV file?","acceptedAnswer":{"@type":"Answer","text":"Yes. Click the 'Import CSV' button and paste your comma-separated data. The tool will automatically parse the CSV and populate the table editor with the data, creating the correct number of rows and columns."}},
    {"@type":"Question","name":"Does the generated table support responsive design?","acceptedAnswer":{"@type":"Answer","text":"Yes. Enable the 'Responsive wrapper' option to wrap the table in a horizontally scrollable container. This ensures the table looks good on mobile devices without breaking the layout."}},
    {"@type":"Question","name":"Can I set header rows and style the table?","acceptedAnswer":{"@type":"Answer","text":"Yes. Toggle 'Header row' to convert the first row to th elements. You can also customize border style, cell padding, enable striped rows for alternating colors, and add hover effects for better readability."}}
  ]
}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
:root{--bg:#050508;--surface:#111118;--primary:#6366f1;--accent:#a855f7;--text:#e2e8f0;--text2:#94a3b8;--border:rgba(255,255,255,0.06);--radius:16px;}
body{font-family:'Inter',system-ui,-apple-system,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;line-height:1.6;-webkit-font-smoothing:antialiased;}
a{color:var(--primary);text-decoration:none;}
a:hover{color:#818cf8;}

.nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 24px;}
.nav-inner{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;height:60px;}
.nav-logo{font-size:20px;font-weight:800;color:#fff;letter-spacing:-0.5px;}
.nav-logo span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.nav-links{display:flex;gap:24px;align-items:center;}
.nav-links a{color:var(--text2);font-size:14px;font-weight:500;transition:color .2s;}
.nav-links a:hover{color:#fff;}

.hero{text-align:center;padding:56px 24px 32px;max-width:700px;margin:0 auto;}
.hero-badge{display:inline-block;padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;color:var(--primary);background:rgba(99,102,241,0.1);border:1px solid rgba(99,102,241,0.2);margin-bottom:16px;letter-spacing:0.5px;text-transform:uppercase;}
.hero h1{font-size:clamp(28px,5vw,42px);font-weight:900;letter-spacing:-1px;line-height:1.15;margin-bottom:12px;}
.hero h1 span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.hero p{color:var(--text2);font-size:16px;max-width:540px;margin:0 auto;}

.tool{max-width:1200px;margin:0 auto;padding:0 24px 40px;}

/* Toolbar */
.toolbar{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:16px;padding:14px 18px;background:var(--surface);border:1px solid var(--border);border-radius:12px;align-items:center;}
.toolbar-group{display:flex;gap:6px;align-items:center;}
.toolbar-sep{width:1px;height:28px;background:var(--border);margin:0 4px;}
.btn{display:inline-flex;align-items:center;gap:6px;padding:10px 20px;border:none;border-radius:10px;font-family:inherit;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s;}
.btn-primary{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;}
.btn-primary:hover{opacity:0.9;transform:translateY(-1px);}
.btn-secondary{background:rgba(255,255,255,0.06);color:var(--text);border:1px solid var(--border);}
.btn-secondary:hover{background:rgba(255,255,255,0.1);}
.btn-sm{padding:7px 14px;font-size:13px;border-radius:8px;}
.btn-icon{padding:7px 10px;font-size:16px;min-width:34px;justify-content:center;}

/* Style Options */
.options-row{display:flex;flex-wrap:wrap;gap:14px;margin-bottom:16px;padding:14px 18px;background:var(--surface);border:1px solid var(--border);border-radius:12px;align-items:center;}
.toggle{display:flex;align-items:center;gap:8px;cursor:pointer;font-size:13px;color:var(--text2);user-select:none;}
.toggle input{display:none;}
.toggle-track{width:36px;height:20px;background:rgba(255,255,255,0.1);border-radius:10px;position:relative;transition:background .2s;}
.toggle input:checked+.toggle-track{background:var(--primary);}
.toggle-track::after{content:'';position:absolute;width:16px;height:16px;background:#fff;border-radius:50%;top:2px;left:2px;transition:transform .2s;}
.toggle input:checked+.toggle-track::after{transform:translateX(16px);}
.opt-group{display:flex;align-items:center;gap:8px;}
.opt-label{font-size:12px;font-weight:600;color:var(--text2);text-transform:uppercase;letter-spacing:0.5px;}
select,input[type="number"]{background:rgba(255,255,255,0.06);color:var(--text);border:1px solid var(--border);border-radius:8px;padding:6px 10px;font-family:inherit;font-size:13px;cursor:pointer;outline:none;}
select:focus,input[type="number"]:focus{border-color:var(--primary);}
input[type="number"]{width:60px;}

/* Table Editor */
.editor-section{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;margin-bottom:20px;}
.editor-header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--border);background:rgba(255,255,255,0.02);}
.editor-title{font-size:13px;font-weight:700;color:var(--text);text-transform:uppercase;letter-spacing:0.5px;}
.table-scroll{overflow-x:auto;padding:16px;}
.edit-table{border-collapse:collapse;width:100%;min-width:400px;}
.edit-table td,.edit-table th{border:1px solid rgba(255,255,255,0.1);padding:0;position:relative;min-width:80px;}
.edit-table td:focus-within,.edit-table th:focus-within{outline:2px solid var(--primary);outline-offset:-2px;z-index:2;}
.cell-input{width:100%;background:transparent;color:var(--text);border:none;padding:10px 12px;font-family:inherit;font-size:14px;outline:none;}
.edit-table th .cell-input{font-weight:700;color:#fff;}
.edit-table th{background:rgba(99,102,241,0.1);}

/* Output Tabs */
.output-section{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;margin-bottom:20px;}
.output-tabs{display:flex;border-bottom:1px solid var(--border);}
.output-tab{flex:1;padding:12px 16px;text-align:center;font-size:13px;font-weight:600;color:var(--text2);cursor:pointer;transition:all .2s;background:transparent;border:none;font-family:inherit;}
.output-tab:hover{color:var(--text);}
.output-tab.active{color:var(--primary);box-shadow:inset 0 -2px 0 var(--primary);}
.output-pane{display:none;padding:16px;}
.output-pane.active{display:block;}
.code-area{width:100%;min-height:200px;background:rgba(0,0,0,0.3);color:var(--text);border:1px solid var(--border);border-radius:12px;font-family:'SF Mono',Monaco,Consolas,'Courier New',monospace;font-size:13px;line-height:1.6;padding:14px;resize:vertical;outline:none;}
.code-area:focus{border-color:var(--primary);}
.output-actions{display:flex;gap:8px;padding:12px 16px;border-top:1px solid var(--border);}

/* Preview */
.preview-section{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;margin-bottom:20px;}
.preview-content{padding:20px;overflow-x:auto;}
.preview-content table{border-collapse:collapse;width:100%;}

/* CSV Modal */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.7);backdrop-filter:blur(8px);z-index:200;display:none;align-items:center;justify-content:center;}
.modal-overlay.show{display:flex;}
.modal{background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:28px;max-width:600px;width:90%;max-height:80vh;overflow:auto;}
.modal h3{font-size:20px;font-weight:800;margin-bottom:12px;}
.modal p{color:var(--text2);font-size:14px;margin-bottom:16px;}
.modal textarea{width:100%;min-height:160px;background:rgba(0,0,0,0.3);color:var(--text);border:1px solid var(--border);border-radius:12px;font-family:'SF Mono',Monaco,Consolas,'Courier New',monospace;font-size:13px;padding:14px;outline:none;resize:vertical;margin-bottom:16px;}
.modal-actions{display:flex;gap:8px;justify-content:flex-end;}

.toast{position:fixed;bottom:24px;right:24px;background:#22c55e;color:#fff;padding:12px 20px;border-radius:10px;font-size:14px;font-weight:600;opacity:0;transform:translateY(10px);transition:all .3s;z-index:999;pointer-events:none;}
.toast.show{opacity:1;transform:translateY(0);}

.faq{max-width:800px;margin:40px auto;padding:0 24px;}
.faq h2{font-size:24px;font-weight:800;margin-bottom:20px;text-align:center;}
.faq-item{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:12px;overflow:hidden;}
.faq-q{padding:16px 20px;font-weight:600;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:background .2s;}
.faq-q:hover{background:rgba(255,255,255,0.03);}
.faq-q::after{content:'+';font-size:20px;color:var(--text2);transition:transform .3s;}
.faq-q.open::after{transform:rotate(45deg);}
.faq-a{padding:0 20px;max-height:0;overflow:hidden;transition:all .3s;color:var(--text2);font-size:14px;line-height:1.7;}
.faq-a.open{padding:0 20px 16px;max-height:300px;}

.footer{border-top:1px solid var(--border);padding:32px 24px;text-align:center;color:var(--text2);font-size:13px;margin-top:40px;}
.footer-links{display:flex;justify-content:center;gap:24px;margin-bottom:12px;flex-wrap:wrap;}
.footer-links a{color:var(--text2);font-weight:500;transition:color .2s;}
.footer-links a:hover{color:#fff;}
</style>
</head>
<body>

<nav class="nav">
<div class="nav-inner">
<a href="/" class="nav-logo">Nex<span>Tool</span></a>
<div class="nav-links">
<a href="/free-tools/">Free Tools</a>
<a href="/products/">Products</a>
<a href="/blog/">Blog</a>
</div>
</div>
</nav>

<section class="hero">
<div class="hero-badge">Free Developer Tool</div>
<h1>HTML <span>Table</span> Generator</h1>
<p>Build HTML tables visually with a live editor. Add rows, columns, headers, and styling. Import CSV data and export clean, production-ready code.</p>
</section>

<section class="tool">
<!-- Toolbar -->
<div class="toolbar">
<div class="toolbar-group">
<button class="btn btn-secondary btn-sm" onclick="addRow()">+ Row</button>
<button class="btn btn-secondary btn-sm" onclick="removeRow()">- Row</button>
</div>
<div class="toolbar-sep"></div>
<div class="toolbar-group">
<button class="btn btn-secondary btn-sm" onclick="addCol()">+ Column</button>
<button class="btn btn-secondary btn-sm" onclick="removeCol()">- Column</button>
</div>
<div class="toolbar-sep"></div>
<div class="toolbar-group">
<button class="btn btn-secondary btn-sm" onclick="openCSVModal()">Import CSV</button>
<button class="btn btn-secondary btn-sm" onclick="resetTable()">Reset</button>
</div>
<div class="toolbar-sep"></div>
<button class="btn btn-primary btn-sm" onclick="generateCode()">Generate Code</button>
</div>

<!-- Style Options -->
<div class="options-row">
<label class="toggle">
<input type="checkbox" id="optHeader" checked onchange="generateCode()">
<div class="toggle-track"></div>
<span>Header row</span>
</label>
<label class="toggle">
<input type="checkbox" id="optBorder" checked onchange="generateCode()">
<div class="toggle-track"></div>
<span>Borders</span>
</label>
<label class="toggle">
<input type="checkbox" id="optStriped" checked onchange="generateCode()">
<div class="toggle-track"></div>
<span>Striped rows</span>
</label>
<label class="toggle">
<input type="checkbox" id="optHover" checked onchange="generateCode()">
<div class="toggle-track"></div>
<span>Hover effect</span>
</label>
<label class="toggle">
<input type="checkbox" id="optResponsive" checked onchange="generateCode()">
<div class="toggle-track"></div>
<span>Responsive wrapper</span>
</label>
<div class="opt-group">
<span class="opt-label">Padding</span>
<input type="number" id="optPadding" value="12" min="0" max="40" onchange="generateCode()">
</div>
</div>

<!-- Table Editor -->
<div class="editor-section">
<div class="editor-header">
<span class="editor-title">Table Editor</span>
<span style="font-size:12px;color:var(--text2);">Click cells to edit content</span>
</div>
<div class="table-scroll">
<table class="edit-table" id="editTable"></table>
</div>
</div>

<!-- Output -->
<div class="output-section">
<div class="output-tabs">
<button class="output-tab active" data-tab="html" onclick="switchOutputTab(this)">HTML</button>
<button class="output-tab" data-tab="css" onclick="switchOutputTab(this)">CSS</button>
<button class="output-tab" data-tab="preview" onclick="switchOutputTab(this)">Preview</button>
</div>
<div class="output-pane active" id="pane-html">
<textarea class="code-area" id="htmlOutput" readonly placeholder="Click 'Generate Code' to see the HTML output..."></textarea>
</div>
<div class="output-pane" id="pane-css">
<textarea class="code-area" id="cssOutput" readonly placeholder="Click 'Generate Code' to see the CSS output..."></textarea>
</div>
<div class="output-pane" id="pane-preview">
<div class="preview-content" id="previewContent">
<p style="color:var(--text2);text-align:center;">Click "Generate Code" to see a preview.</p>
</div>
</div>
<div class="output-actions">
<button class="btn btn-secondary btn-sm" onclick="copyHTML()">Copy HTML</button>
<button class="btn btn-secondary btn-sm" onclick="copyCSS()">Copy CSS</button>
<button class="btn btn-secondary btn-sm" onclick="downloadHTML()">Download HTML</button>
</div>
</div>
</section>

<!-- CSV Modal -->
<div class="modal-overlay" id="csvModal">
<div class="modal">
<h3>Import CSV Data</h3>
<p>Paste your comma-separated data below. The first row will become headers if the header option is enabled.</p>
<textarea id="csvInput" placeholder="Name, Email, Role&#10;John Doe, john@example.com, Developer&#10;Jane Smith, jane@example.com, Designer&#10;Bob Wilson, bob@example.com, Manager"></textarea>
<div class="modal-actions">
<button class="btn btn-secondary btn-sm" onclick="closeCSVModal()">Cancel</button>
<button class="btn btn-primary btn-sm" onclick="importCSV()">Import</button>
</div>
</div>
</div>

<!-- FAQ -->
<section class="faq">
<h2>Frequently Asked Questions</h2>
<div class="faq-item">
<div class="faq-q" onclick="toggleFaq(this)">How do I create an HTML table with this tool?</div>
<div class="faq-a">Click on any cell in the visual editor to type content. Use the toolbar buttons to add or remove rows and columns. Toggle style options like borders, striped rows, and hover effects. The HTML and CSS code is generated automatically and can be copied or downloaded.</div>
</div>
<div class="faq-item">
<div class="faq-q" onclick="toggleFaq(this)">Can I import data from a CSV file?</div>
<div class="faq-a">Yes. Click the "Import CSV" button and paste your comma-separated data. The tool will automatically parse the CSV and populate the table editor with the data, creating the correct number of rows and columns.</div>
</div>
<div class="faq-item">
<div class="faq-q" onclick="toggleFaq(this)">Does the generated table support responsive design?</div>
<div class="faq-a">Yes. Enable the "Responsive wrapper" option to wrap the table in a horizontally scrollable container. This ensures the table looks good on mobile devices without breaking the page layout.</div>
</div>
<div class="faq-item">
<div class="faq-q" onclick="toggleFaq(this)">Can I set header rows and style the table?</div>
<div class="faq-a">Yes. Toggle "Header row" to convert the first row to th elements. You can customize border style, cell padding, enable striped rows for alternating colors, and add hover effects for better readability.</div>
</div>
</section>

<!-- Bundle Cross-Promo -->
<section style="max-width:900px;margin:40px auto;padding:0 24px;">
<div style="background:linear-gradient(135deg,rgba(99,102,241,0.1),rgba(168,85,247,0.08));border:1px solid rgba(99,102,241,0.15);border-radius:20px;padding:32px 28px;text-align:center;">
<div style="font-size:13px;color:#818cf8;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Save 37%</div>
<h3 style="font-size:22px;font-weight:800;color:#fff;margin:0 0 8px;">Get the Ultimate Bundle</h3>
<p style="color:#94a3b8;font-size:14px;margin:0 auto 20px;max-width:500px;">Website Kit + Automation Bundle + Content Toolkit — everything you need to launch.</p>
<a href="/products/ultimate-bundle.html" style="display:inline-block;padding:12px 28px;background:linear-gradient(135deg,#6366f1,#a855f7);color:#fff;text-decoration:none;border-radius:12px;font-weight:700;font-size:15px;">$39 — Get Bundle</a>
<a href="/free-tools/" style="display:inline-block;margin-left:12px;color:#818cf8;text-decoration:none;font-size:14px;">Browse 75+ Free Tools &rarr;</a>
</div>
</section>

<footer class="footer">
<div class="footer-links">
<a href="/">Home</a>
<a href="/free-tools/">Free Tools</a>
<a href="/products/">Products</a>
<a href="/blog/">Blog</a>
</div>
<p>&copy; 2026 NexTool. All rights reserved.</p>
</footer>

<div class="toast" id="toast"></div>

<script>
/* ========== Table State ========== */
let tableData = [];
const DEFAULT_ROWS = 4;
const DEFAULT_COLS = 4;

function initTable(rows, cols, data) {
  tableData = [];
  for (let r = 0; r < rows; r++) {
    const row = [];
    for (let c = 0; c < cols; c++) {
      row.push(data && data[r] && data[r][c] !== undefined ? data[r][c] : '');
    }
    tableData.push(row);
  }
  renderEditor();
}

function renderEditor() {
  const table = document.getElementById('editTable');
  const hasHeader = document.getElementById('optHeader').checked;
  let html = '';

  for (let r = 0; r < tableData.length; r++) {
    html += '<tr>';
    for (let c = 0; c < tableData[r].length; c++) {
      const tag = (hasHeader && r === 0) ? 'th' : 'td';
      const val = escapeHTML(tableData[r][c]);
      html += '<' + tag + '>';
      html += '<input class="cell-input" type="text" value="' + val + '" data-r="' + r + '" data-c="' + c + '" oninput="cellChanged(this)" placeholder="' + (hasHeader && r === 0 ? 'Header ' + (c+1) : '') + '">';
      html += '</' + tag + '>';
    }
    html += '</tr>';
  }
  table.innerHTML = html;
}

function cellChanged(el) {
  const r = parseInt(el.getAttribute('data-r'));
  const c = parseInt(el.getAttribute('data-c'));
  tableData[r][c] = el.value;
}

function addRow() {
  const cols = tableData[0] ? tableData[0].length : DEFAULT_COLS;
  tableData.push(new Array(cols).fill(''));
  renderEditor();
  showToast('Row added.', '#22c55e');
}

function removeRow() {
  if (tableData.length <= 1) { showToast('Need at least one row.', '#ef4444'); return; }
  tableData.pop();
  renderEditor();
  showToast('Row removed.', '#22c55e');
}

function addCol() {
  tableData.forEach(function(row) { row.push(''); });
  renderEditor();
  showToast('Column added.', '#22c55e');
}

function removeCol() {
  if (tableData[0] && tableData[0].length <= 1) { showToast('Need at least one column.', '#ef4444'); return; }
  tableData.forEach(function(row) { row.pop(); });
  renderEditor();
  showToast('Column removed.', '#22c55e');
}

function resetTable() {
  const defaultData = [
    ['Name', 'Email', 'Role', 'Status'],
    ['John Doe', 'john@example.com', 'Developer', 'Active'],
    ['Jane Smith', 'jane@example.com', 'Designer', 'Active'],
    ['Bob Wilson', 'bob@example.com', 'Manager', 'Away']
  ];
  initTable(4, 4, defaultData);
  showToast('Table reset to defaults.', '#22c55e');
}

/* ========== CSV Import ========== */
function openCSVModal() {
  document.getElementById('csvModal').classList.add('show');
}

function closeCSVModal() {
  document.getElementById('csvModal').classList.remove('show');
}

function importCSV() {
  const raw = document.getElementById('csvInput').value.trim();
  if (!raw) { showToast('Please paste CSV data.', '#ef4444'); return; }

  const lines = raw.split('\n').filter(function(l) { return l.trim().length > 0; });
  const data = lines.map(function(line) {
    /* Simple CSV parse (handles quoted fields) */
    const cells = [];
    let current = '';
    let inQuotes = false;
    for (let i = 0; i < line.length; i++) {
      const ch = line[i];
      if (ch === '"') {
        inQuotes = !inQuotes;
      } else if (ch === ',' && !inQuotes) {
        cells.push(current.trim());
        current = '';
      } else {
        current += ch;
      }
    }
    cells.push(current.trim());
    return cells;
  });

  if (data.length > 0) {
    /* Normalize column count */
    const maxCols = Math.max.apply(null, data.map(function(r) { return r.length; }));
    data.forEach(function(row) {
      while (row.length < maxCols) row.push('');
    });
    initTable(data.length, maxCols, data);
    closeCSVModal();
    showToast('CSV imported! ' + data.length + ' rows, ' + maxCols + ' columns.', '#22c55e');
  }
}

/* ========== Code Generation ========== */
function generateCode() {
  const hasHeader = document.getElementById('optHeader').checked;
  const hasBorder = document.getElementById('optBorder').checked;
  const hasStriped = document.getElementById('optStriped').checked;
  const hasHover = document.getElementById('optHover').checked;
  const hasResponsive = document.getElementById('optResponsive').checked;
  const padding = document.getElementById('optPadding').value || 12;

  /* Sync data from inputs */
  document.querySelectorAll('.cell-input').forEach(function(inp) {
    const r = parseInt(inp.getAttribute('data-r'));
    const c = parseInt(inp.getAttribute('data-c'));
    tableData[r][c] = inp.value;
  });

  /* Generate HTML */
  let html = '';
  const indent = '  ';

  if (hasResponsive) {
    html += '<div class="table-responsive">\n';
  }

  html += (hasResponsive ? indent : '') + '<table class="styled-table">\n';

  for (let r = 0; r < tableData.length; r++) {
    const isHeader = hasHeader && r === 0;
    const prefix = hasResponsive ? indent + indent : indent;

    if (isHeader) html += prefix + '<thead>\n';
    if (isHeader) html += prefix + indent + '<tr>\n';
    else if (r === 1 && hasHeader) { html += prefix + '<tbody>\n'; html += prefix + indent + '<tr>\n'; }
    else html += prefix + (hasHeader ? indent : '') + '<tr>\n';

    for (let c = 0; c < tableData[r].length; c++) {
      const tag = isHeader ? 'th' : 'td';
      const cellPrefix = isHeader ? prefix + indent + indent : prefix + (hasHeader ? indent + indent : indent);
      const content = escapeHTML(tableData[r][c]) || '&nbsp;';
      html += cellPrefix + '<' + tag + '>' + content + '</' + tag + '>\n';
    }

    if (isHeader) {
      html += prefix + indent + '</tr>\n';
      html += prefix + '</thead>\n';
    } else {
      html += prefix + (hasHeader ? indent : '') + '</tr>\n';
    }
  }

  if (hasHeader && tableData.length > 1) html += (hasResponsive ? indent + indent : indent) + '</tbody>\n';
  html += (hasResponsive ? indent : '') + '</table>\n';
  if (hasResponsive) html += '</div>\n';

  /* Generate CSS */
  let css = '';
  if (hasResponsive) {
    css += '.table-responsive {\n  overflow-x: auto;\n  -webkit-overflow-scrolling: touch;\n}\n\n';
  }

  css += '.styled-table {\n';
  css += '  border-collapse: collapse;\n';
  css += '  width: 100%;\n';
  css += '  font-family: \'Inter\', -apple-system, sans-serif;\n';
  css += '  font-size: 14px;\n';
  css += '  color: #1e293b;\n';
  if (hasBorder) css += '  border: 1px solid #e2e8f0;\n';
  css += '}\n\n';

  css += '.styled-table th,\n.styled-table td {\n';
  css += '  padding: ' + padding + 'px;\n';
  css += '  text-align: left;\n';
  if (hasBorder) css += '  border: 1px solid #e2e8f0;\n';
  css += '}\n\n';

  if (hasHeader) {
    css += '.styled-table thead th {\n';
    css += '  background-color: #f1f5f9;\n';
    css += '  font-weight: 700;\n';
    css += '  color: #0f172a;\n';
    if (hasBorder) css += '  border-bottom: 2px solid #cbd5e1;\n';
    css += '}\n\n';
  }

  if (hasStriped) {
    css += '.styled-table tbody tr:nth-child(even) {\n';
    css += '  background-color: #f8fafc;\n';
    css += '}\n\n';
  }

  if (hasHover) {
    css += '.styled-table tbody tr:hover {\n';
    css += '  background-color: #e0e7ff;\n';
    css += '  transition: background-color 0.2s;\n';
    css += '}\n\n';
  }

  document.getElementById('htmlOutput').value = html;
  document.getElementById('cssOutput').value = css;

  /* Preview */
  const previewEl = document.getElementById('previewContent');
  previewEl.innerHTML = '<style>' + css + '</style>' + html;

  showToast('Code generated!', '#22c55e');
}

/* ========== Output Tabs ========== */
function switchOutputTab(el) {
  document.querySelectorAll('.output-tab').forEach(function(t) { t.classList.remove('active'); });
  document.querySelectorAll('.output-pane').forEach(function(p) { p.classList.remove('active'); });
  el.classList.add('active');
  document.getElementById('pane-' + el.getAttribute('data-tab')).classList.add('active');
}

/* ========== Copy/Download ========== */
function copyHTML() {
  const text = document.getElementById('htmlOutput').value;
  if (!text) { showToast('Generate code first.', '#ef4444'); return; }
  navigator.clipboard.writeText(text).then(function() { showToast('HTML copied!', '#22c55e'); });
}

function copyCSS() {
  const text = document.getElementById('cssOutput').value;
  if (!text) { showToast('Generate code first.', '#ef4444'); return; }
  navigator.clipboard.writeText(text).then(function() { showToast('CSS copied!', '#22c55e'); });
}

function downloadHTML() {
  const htmlCode = document.getElementById('htmlOutput').value;
  const cssCode = document.getElementById('cssOutput').value;
  if (!htmlCode) { showToast('Generate code first.', '#ef4444'); return; }

  const fullHTML = '<!DOCTYPE html>\n<html lang="en">\n<head>\n<meta charset="UTF-8">\n<meta name="viewport" content="width=device-width,initial-scale=1">\n<title>Generated Table</title>\n<style>\n' + cssCode + '</style>\n</head>\n<body>\n' + htmlCode + '</body>\n</html>';

  const blob = new Blob([fullHTML], { type: 'text/html' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'table.html';
  document.body.appendChild(a); a.click(); document.body.removeChild(a);
  URL.revokeObjectURL(url);
  showToast('HTML file downloaded!', '#22c55e');
}

/* ========== Helpers ========== */
function escapeHTML(s) {
  if (!s) return '';
  return s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
}

function showToast(msg, color) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.style.background = color || '#22c55e';
  t.classList.add('show');
  clearTimeout(t._timer);
  t._timer = setTimeout(function() { t.classList.remove('show'); }, 2500);
}

function toggleFaq(el) {
  const a = el.nextElementSibling;
  const isOpen = el.classList.contains('open');
  document.querySelectorAll('.faq-q').forEach(function(q) { q.classList.remove('open'); });
  document.querySelectorAll('.faq-a').forEach(function(ans) { ans.classList.remove('open'); });
  if (!isOpen) { el.classList.add('open'); a.classList.add('open'); }
}

/* ========== Initialize ========== */
resetTable();
</script>
<script defer src="/js/revenue.js"></script>
<script defer src="/js/lead-capture.js"></script>
<script defer src="/js/analytics-lite.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
    <link rel="icon" type="image/svg+xml" href="/img/favicon.svg">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Text to Speech Online — Convert Text to Audio | ANIMA</title>
<meta name="description" content="Free text to speech online tool. Convert any text to natural-sounding speech with 100+ voices, adjustable speed, pitch, and volume. Word highlighting. No signup.">
<meta name="keywords" content="text to speech online free, text to speech, TTS, read aloud, speech synthesis, convert text to audio, free online tool, ANIMA">
<meta name="robots" content="index, follow">
<meta property="og:title" content="Free Text to Speech Online — Convert Text to Audio | ANIMA">
<meta property="og:description" content="Convert text to natural speech with 100+ voices. Adjust speed, pitch, volume. Real-time word highlighting. 100% free.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/text-to-speech.html">
<meta property="og:image" content="https://nextool.app/img/og-image.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<link rel="canonical" href="https://nextool.app/free-tools/text-to-speech.html">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free Text to Speech Online — Convert Text to Audio | ANIMA">
<meta name="twitter:description" content="Convert text to speech instantly. 100+ voices, adjustable speed and pitch, word highlighting. Free online tool.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"Text to Speech","applicationCategory":"MultimediaApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"description":"Free online text to speech tool. Convert text to natural audio with 100+ browser voices, adjustable speed, pitch, volume, and real-time word highlighting."}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--border:#2a2a3a;--text:#e4e4eb;--text2:#9494a8;--primary:#00d4ff;--accent:#a855f7;--pink:#ec4899;--green:#22c55e;--red:#ef4444;--cyan:#22d3ee;--yellow:#eab308;--radius:12px;--glass:rgba(17,17,24,0.7)}
html{scroll-behavior:smooth}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
/* NAV */
.nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{font-size:1.4rem;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-decoration:none}
.nav-links{display:flex;align-items:center;gap:1.5rem}
.nav-links a{color:var(--text2);text-decoration:none;font-size:.875rem;font-weight:500;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-cta{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff!important;padding:.5rem 1.2rem;border-radius:8px;font-weight:600;-webkit-text-fill-color:#fff!important}
.nav-cta:hover{opacity:.9}
.nav-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}
/* HERO */
.hero{text-align:center;padding:3rem 1.5rem 2rem;max-width:700px;margin:0 auto}
.hero h1{font-size:2.2rem;font-weight:800;line-height:1.2;margin-bottom:.75rem}
.hero h1 span{background:linear-gradient(135deg,var(--primary),var(--accent),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--text2);font-size:1rem}
/* TOOL */
.tool-container{max-width:900px;margin:0 auto;padding:0 1.5rem 3rem}
/* CARDS */
.card{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);padding:1.25rem;margin-bottom:1rem}
.card-label{font-size:.8rem;font-weight:600;color:var(--text2);margin-bottom:.75rem;text-transform:uppercase;letter-spacing:.5px}
/* VOICE CONTROLS */
.controls-grid{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}
.ctrl{display:flex;flex-direction:column;gap:.35rem}
.ctrl label{font-size:.78rem;font-weight:600;color:var(--text2);display:flex;align-items:center;justify-content:space-between}
.ctrl label .val{color:var(--primary);font-weight:700}
.ctrl select{width:100%;background:var(--surface);border:1px solid var(--border);color:var(--text);padding:.45rem .7rem;border-radius:8px;font-family:inherit;font-size:.82rem;outline:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%239494a8' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .6rem center;cursor:pointer;transition:border-color .2s}
.ctrl select:focus{border-color:var(--primary)}
.ctrl input[type=range]{-webkit-appearance:none;appearance:none;width:100%;height:6px;background:var(--surface2);border-radius:3px;outline:none;cursor:pointer;border:1px solid var(--border)}
.ctrl input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--accent));cursor:pointer;border:2px solid var(--bg)}
.ctrl input[type=range]::-moz-range-thumb{width:14px;height:14px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--accent));cursor:pointer;border:2px solid var(--bg)}
.range-ticks{display:flex;justify-content:space-between;font-size:.65rem;color:var(--text2);margin-top:2px}
/* TEXTAREA */
#ttsInput{width:100%;min-height:200px;background:var(--surface);border:1px solid var(--border);color:var(--text);font-family:'Inter',sans-serif;font-size:.92rem;padding:1rem;border-radius:10px;resize:vertical;outline:none;line-height:1.75;transition:border-color .2s}
#ttsInput:focus{border-color:var(--primary)}
#ttsInput::placeholder{color:var(--text2);opacity:.5}
/* HIGHLIGHT OVERLAY */
.hl-area{width:100%;min-height:200px;background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:1rem;font-size:.92rem;line-height:1.75;white-space:pre-wrap;word-break:break-word;overflow-y:auto;max-height:400px;display:none}
.hl-area .w{transition:background .06s,color .06s;border-radius:3px;padding:0 1px}
.hl-area .w.active{background:rgba(0,212,255,.35);color:#fff}
/* STATS ROW */
.stats-row{display:flex;flex-wrap:wrap;gap:1.25rem;margin-top:.6rem;font-size:.78rem;color:var(--text2)}
.stats-row .si{display:flex;align-items:center;gap:.25rem}
.stats-row .sv{color:var(--text);font-weight:600}
/* BUTTONS */
.btn-row{display:flex;gap:.6rem;flex-wrap:wrap;margin-bottom:1rem}
.btn{padding:.6rem 1.3rem;border-radius:10px;font-size:.85rem;font-weight:600;cursor:pointer;border:1px solid var(--border);font-family:inherit;transition:all .2s;display:inline-flex;align-items:center;gap:.4rem;background:var(--surface2);color:var(--text)}
.btn:hover{border-color:var(--primary);background:rgba(0,212,255,.12)}
.btn:disabled{opacity:.35;cursor:not-allowed;border-color:var(--border)!important;background:var(--surface2)!important}
.btn-primary{background:linear-gradient(135deg,var(--primary),var(--accent));border-color:transparent;color:#fff}
.btn-primary:hover{opacity:.92;border-color:transparent;background:linear-gradient(135deg,var(--primary),var(--accent))}
.btn-primary:disabled{opacity:.35;background:linear-gradient(135deg,var(--primary),var(--accent))}
.btn-danger{border-color:rgba(239,68,68,.25)}
.btn-danger:hover{border-color:var(--red);background:rgba(239,68,68,.1)}
.btn-green{border-color:rgba(34,197,94,.25)}
.btn-green:hover{border-color:var(--green);background:rgba(34,197,94,.1)}
/* STATUS BAR */
.status-bar{display:flex;align-items:center;gap:.75rem;padding:.6rem 1rem;background:var(--surface);border:1px solid var(--border);border-radius:10px;margin-bottom:1rem;font-size:.82rem}
.status-dot{width:10px;height:10px;border-radius:50%;flex-shrink:0;transition:background .2s}
.status-dot.idle{background:var(--border)}
.status-dot.speaking{background:var(--green);animation:pulse 1s infinite}
.status-dot.paused{background:var(--yellow)}
.status-dot.recording{background:var(--red);animation:pulse .6s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.35}}
.status-text{flex:1;color:var(--text2)}
.status-text strong{color:var(--text)}
/* PROGRESS */
.progress-bar{width:100%;height:4px;background:var(--surface2);border-radius:2px;overflow:hidden;margin-bottom:1rem;opacity:0;transition:opacity .3s}
.progress-bar.active{opacity:1}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:2px;width:0%;transition:width .15s linear}
/* VOICE BADGES */
.voice-badges{display:flex;flex-wrap:wrap;gap:.4rem;margin-top:.4rem}
.vb{display:inline-block;padding:2px 8px;border-radius:4px;font-size:.68rem;font-weight:600;text-transform:uppercase;letter-spacing:.3px}
.vb-local{background:rgba(34,197,94,.12);color:var(--green)}
.vb-net{background:rgba(0,212,255,.12);color:var(--primary)}
.vb-def{background:rgba(168,85,247,.12);color:var(--accent)}
/* SHORTCUT HINT */
.shortcut-hint{font-size:.72rem;color:var(--text2);margin-top:.25rem}
.shortcut-hint kbd{background:var(--surface2);border:1px solid var(--border);border-radius:4px;padding:1px 5px;font-family:inherit;font-size:.68rem}
/* CTA */
.cta-section{text-align:center;padding:4rem 1.5rem;max-width:700px;margin:0 auto}
.cta-section h2{font-size:1.8rem;font-weight:800;margin-bottom:.75rem}
.cta-section h2 span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.cta-section p{color:var(--text2);margin-bottom:1.5rem}
.cta-btn{display:inline-block;background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;padding:.75rem 2rem;border-radius:10px;font-weight:700;text-decoration:none;font-size:1rem;transition:transform .2s,box-shadow .2s}
.cta-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,212,255,.3)}
/* FOOTER */
.footer{border-top:1px solid var(--border);padding:3rem 2rem 2rem;max-width:1200px;margin:0 auto}
.footer-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:2rem;margin-bottom:2rem}
.footer-col h4{font-size:.85rem;font-weight:700;margin-bottom:.75rem;color:var(--text)}
.footer-col a{display:block;color:var(--text2);text-decoration:none;font-size:.8rem;margin-bottom:.4rem;transition:color .2s}
.footer-col a:hover{color:var(--primary)}
.footer-bottom{text-align:center;color:var(--text2);font-size:.75rem;padding-top:1.5rem;border-top:1px solid var(--border)}
/* FADE */
.fade-in{opacity:0;transform:translateY(20px);transition:opacity .6s,transform .6s}
.fade-in.visible{opacity:1;transform:translateY(0)}
/* TOAST */
.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.6rem 1.2rem;border-radius:10px;font-size:.85rem;font-weight:500;z-index:200;transition:transform .3s;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0)}
.no-support{text-align:center;padding:3rem;color:var(--red);font-size:1rem}
/* RESPONSIVE */
@media(max-width:768px){
  .controls-grid{grid-template-columns:1fr}
  .nav-links{display:none;position:absolute;top:64px;left:0;right:0;background:var(--bg);border-bottom:1px solid var(--border);flex-direction:column;padding:1rem 2rem;gap:1rem}
  .nav-links.open{display:flex}
  .nav-toggle{display:block}
  .hero h1{font-size:1.6rem}
  .footer-grid{grid-template-columns:1fr}
  .btn-row{gap:.4rem}
  .btn{padding:.5rem 1rem;font-size:.78rem}
  .stats-row{gap:.75rem}
}
</style>
</head>
<body>

<nav class="nav">
  <a href="/" class="nav-logo">ANIMA</a>
  <button class="nav-toggle" onclick="document.querySelector('.nav-links').classList.toggle('open')" aria-label="Menu">&#9776;</button>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Tools</a>
    <a href="/free-tools/">Free Tools</a>
    <a href="/blog/">Blog</a>
    <a href="https://github.com/christian140903-sudo/nextool" class="nav-cta" target="_blank" rel="noopener">GitHub</a>
  </div>
</nav>

<section class="hero fade-in">
  <h1>Free <span>Text to Speech</span> Online</h1>
  <p class="tool-summary" style="color:#94a3b8;font-size:15px;line-height:1.6;margin-bottom:24px;max-width:700px;margin-left:auto;margin-right:auto;">Convert any text to natural-sounding speech directly in your browser. Choose from 100+ system voices across dozens of languages, adjust speed, pitch, and volume, and watch words highlight in real time as they are spoken. No signup, no server &mdash; everything runs locally on your device.</p>
</section>

<div class="tool-container fade-in" id="toolArea">

  <!-- Voice & Language Settings -->
  <div class="card">
    <div class="card-label">Voice Settings</div>
    <div class="controls-grid">
      <div class="ctrl">
        <label for="langFilter">Language</label>
        <select id="langFilter"><option value="all">All languages</option></select>
      </div>
      <div class="ctrl">
        <label for="voiceSelect">Voice</label>
        <select id="voiceSelect"></select>
      </div>
      <div class="ctrl">
        <label for="rateRange">Speed <span class="val" id="rateVal">1.0x</span></label>
        <input type="range" id="rateRange" min="0.25" max="3" step="0.05" value="1">
        <div class="range-ticks"><span>0.25x</span><span>1x</span><span>2x</span><span>3x</span></div>
      </div>
      <div class="ctrl">
        <label for="pitchRange">Pitch <span class="val" id="pitchVal">1.0</span></label>
        <input type="range" id="pitchRange" min="0" max="2" step="0.1" value="1">
        <div class="range-ticks"><span>Low</span><span>Normal</span><span>High</span></div>
      </div>
      <div class="ctrl" style="grid-column:1/-1">
        <label for="volumeRange">Volume <span class="val" id="volumeVal">100%</span></label>
        <input type="range" id="volumeRange" min="0" max="1" step="0.05" value="1">
      </div>
    </div>
    <div class="voice-badges" id="voiceBadges"></div>
  </div>

  <!-- Action Buttons -->
  <div class="btn-row">
    <button class="btn btn-primary" id="btnSpeak" onclick="doSpeak()">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg> Speak
    </button>
    <button class="btn" id="btnPause" onclick="doPause()" disabled>
      <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><rect x="5" y="3" width="4" height="18"/><rect x="15" y="3" width="4" height="18"/></svg> Pause
    </button>
    <button class="btn" id="btnResume" onclick="doResume()" disabled>
      <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21"/></svg> Resume
    </button>
    <button class="btn btn-danger" id="btnStop" onclick="doStop()" disabled>
      <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><rect x="4" y="4" width="16" height="16" rx="2"/></svg> Stop
    </button>
    <button class="btn btn-green" id="btnDownload" onclick="doDownload()" title="Record speech as downloadable audio file">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7,10 12,15 17,10"/><line x1="12" y1="15" x2="12" y2="3"/></svg> Download
    </button>
    <button class="btn" onclick="doClear()">Clear</button>
    <button class="btn" onclick="loadSample()">Sample</button>
  </div>

  <!-- Status & Progress -->
  <div class="status-bar">
    <span class="status-dot idle" id="statusDot"></span>
    <span class="status-text" id="statusText">Ready &mdash; type or paste text below</span>
  </div>
  <div class="progress-bar" id="progressBar"><div class="progress-fill" id="progressFill"></div></div>

  <!-- Text Input & Highlight Area -->
  <div class="card" style="padding:0;overflow:hidden">
    <div style="padding:.5rem 1rem;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;background:rgba(26,26,36,0.5)">
      <span style="font-size:.8rem;font-weight:600;color:var(--text2)">Text Input</span>
      <span style="font-size:.75rem;color:var(--text2)" id="charCounter">0 characters</span>
    </div>
    <textarea id="ttsInput" placeholder="Type or paste your text here to convert to speech...&#10;&#10;Try clicking Speak or pressing Ctrl+Enter to hear your text read aloud." spellcheck="true"></textarea>
    <div class="hl-area" id="hlArea"></div>
  </div>

  <!-- Stats -->
  <div class="stats-row">
    <div class="si">Characters: <span class="sv" id="sChars">0</span></div>
    <div class="si">Words: <span class="sv" id="sWords">0</span></div>
    <div class="si">Sentences: <span class="sv" id="sSentences">0</span></div>
    <div class="si">Est. duration: <span class="sv" id="sDuration">0s</span></div>
  </div>
  <div class="shortcut-hint"><kbd>Ctrl</kbd>+<kbd>Enter</kbd> to speak/pause &middot; <kbd>Esc</kbd> to stop</div>
</div>

<section class="cta-section fade-in">
  <h2>Need something <span>more powerful</span>?</h2>
  <p>Let us build it for you. Custom APIs, dashboards, automations &mdash; whatever you need.</p>
  <a href="/#contact" class="cta-btn">Start a Project &rarr;</a>
</section>

<!-- Cross Promo -->
<section style="max-width:900px;margin:40px auto;padding:0 24px;">
<div style="background:linear-gradient(135deg,rgba(0,212,255,0.1),rgba(168,85,247,0.08));border:1px solid rgba(0,212,255,0.15);border-radius:20px;padding:32px 28px;text-align:center;">
<div style="font-size:13px;color:#818cf8;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Founding Member</div>
<h3 style="font-size:22px;font-weight:800;color:#fff;margin:0 0 8px;">ANIMA on GitHub</h3>
<p style="color:#94a3b8;font-size:14px;margin:0 auto 20px;max-width:500px;">248+ free tools. No signup. Open source. Built by Christian Bucher.</p>
<div style="display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;">
<a href="/about/" style="display:inline-block;padding:12px 28px;background:linear-gradient(135deg,#00d4ff,#a855f7,#ec4899);color:#fff;border-radius:10px;font-weight:700;font-size:15px;text-decoration:none;">Open Source &mdash; Free Forever</a>
<a href="/free-tools/" style="color:#94a3b8;font-size:14px;text-decoration:none;">Browse 250+ Free Tools &rarr;</a>
</div>
</div>
</section>

<!-- AUTO-LINKED by ANIMA Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/speech-to-text.html" style="color:var(--primary);text-decoration:none">Speech to Text</a> &middot; <a href="/free-tools/text-analyzer.html" style="color:var(--primary);text-decoration:none">Text Analyzer</a> &middot; <a href="/free-tools/word-counter.html" style="color:var(--primary);text-decoration:none">Word Counter</a> &middot; <a href="/free-tools/character-counter.html" style="color:var(--primary);text-decoration:none">Character Counter</a> &middot; <a href="/free-tools/text-case-converter.html" style="color:var(--primary);text-decoration:none">Text Case Converter</a></p>
</div>


<!-- AUTO-LINKED by ANIMA Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/box-shadow-generator.html" style="color:var(--primary);text-decoration:none">CSS Box Shadow Generator</a> · <a href="/free-tools/emoji-picker.html" style="color:var(--primary);text-decoration:none">Emoji Picker & Search</a> · <a href="/free-tools/json-to-yaml-converter.html" style="color:var(--primary);text-decoration:none">Free JSON to YAML Converter</a></p>
</div>
<footer class="footer fade-in">
  <div class="footer-grid">
    <div class="footer-col">
      <h4>Products</h4>
      <a href="/free-tools/">250+ Free Tools</a>
<a href="/about/">About</a>
<a href="/docs/">Documentation</a>
    </div>
    <div class="footer-col">
      <h4>Explore</h4>
      <a href="/free-tools/">Free Tools</a><a href="/blog/">Blog</a><a href="/about/">FAQ</a><a href="/about/">About</a>
    </div>
    <div class="footer-col">
      <h4>Ecosystem</h4>
      <a href="/">ANIMA Home</a><a href="/#contact">Contact</a><a href="https://github.com/christian140903-sudo/nextool" target="_blank">GitHub</a>
    </div>
  </div>
  <div class="footer-bottom">&copy; 2026 ANIMA. AI-powered tools for everyone.</div>
</footer>

<div class="toast" id="toast"></div>

<script>
/* ===== CORE STATE ===== */
var synth = window.speechSynthesis;
var allVoices = [];
var filteredVoices = [];
var isSpeaking = false;
var isPaused = false;
var currentUtt = null;
var keepAlive = null;
var isDownloading = false;

/* ===== DOM REFS ===== */
var ttsInput = document.getElementById('ttsInput');
var hlArea = document.getElementById('hlArea');
var voiceSelect = document.getElementById('voiceSelect');
var langFilter = document.getElementById('langFilter');
var rateRange = document.getElementById('rateRange');
var pitchRange = document.getElementById('pitchRange');
var volumeRange = document.getElementById('volumeRange');
var rateVal = document.getElementById('rateVal');
var pitchVal = document.getElementById('pitchVal');
var volumeVal = document.getElementById('volumeVal');
var statusDot = document.getElementById('statusDot');
var statusText = document.getElementById('statusText');
var progressBar = document.getElementById('progressBar');
var progressFill = document.getElementById('progressFill');
var voiceBadges = document.getElementById('voiceBadges');
var btnSpeak = document.getElementById('btnSpeak');
var btnPause = document.getElementById('btnPause');
var btnResume = document.getElementById('btnResume');
var btnStop = document.getElementById('btnStop');
var btnDownload = document.getElementById('btnDownload');

/* ===== BROWSER CHECK ===== */
if (!synth) {
  document.getElementById('toolArea').innerHTML = '<div class="no-support">Your browser does not support the Web Speech API. Please try Chrome, Edge, or Safari.</div>';
}

/* ===== VOICE LOADING ===== */
function loadVoices() {
  allVoices = synth.getVoices();
  if (!allVoices.length) return;

  // Build language list
  var langMap = {};
  allVoices.forEach(function(v) {
    var code = v.lang.split('-')[0];
    langMap[code] = (langMap[code] || 0) + 1;
  });

  var prevLang = langFilter.value;
  langFilter.innerHTML = '<option value="all">All languages (' + allVoices.length + ')</option>';
  var langKeys = Object.keys(langMap).sort(function(a, b) {
    return langName(a).localeCompare(langName(b));
  });
  langKeys.forEach(function(code) {
    var opt = document.createElement('option');
    opt.value = code;
    opt.textContent = langName(code) + ' (' + langMap[code] + ')';
    if (code === prevLang || (prevLang === '' && code === 'en')) opt.selected = true;
    langFilter.appendChild(opt);
  });
  // Default to English if first load
  if (!prevLang || prevLang === 'all') {
    if (langMap['en']) langFilter.value = 'en';
  }
  applyVoiceFilter();
}

function langName(code) {
  try { return new Intl.DisplayNames(['en'], { type: 'language' }).of(code); }
  catch(e) { return code; }
}

function applyVoiceFilter() {
  var lang = langFilter.value;
  filteredVoices = lang === 'all'
    ? allVoices.slice()
    : allVoices.filter(function(v) { return v.lang.split('-')[0] === lang; });

  // Sort: default first, local before network, then alphabetical
  filteredVoices.sort(function(a, b) {
    if (a.default && !b.default) return -1;
    if (!a.default && b.default) return 1;
    if (a.localService && !b.localService) return -1;
    if (!a.localService && b.localService) return 1;
    return a.name.localeCompare(b.name);
  });

  voiceSelect.innerHTML = '';
  filteredVoices.forEach(function(v, i) {
    var opt = document.createElement('option');
    opt.value = i;
    var suffix = v.default ? ' [Default]' : '';
    var net = v.localService ? '' : ' (Network)';
    opt.textContent = v.name + ' (' + v.lang + ')' + suffix + net;
    voiceSelect.appendChild(opt);
  });
  updateBadges();
}

function getVoice() {
  var idx = parseInt(voiceSelect.value) || 0;
  return filteredVoices[idx] || null;
}

function updateBadges() {
  var v = getVoice();
  if (!v) { voiceBadges.innerHTML = ''; return; }
  var html = '';
  html += '<span class="vb ' + (v.localService ? 'vb-local' : 'vb-net') + '">' + (v.localService ? 'Local' : 'Network') + '</span>';
  if (v.default) html += '<span class="vb vb-def">Default</span>';
  try {
    var fullName = new Intl.DisplayNames(['en'], { type: 'language' }).of(v.lang);
    html += '<span style="font-size:.72rem;color:var(--text2)">' + fullName + '</span>';
  } catch(e) {}
  voiceBadges.innerHTML = html;
}

synth.addEventListener('voiceschanged', loadVoices);
loadVoices();

langFilter.addEventListener('change', applyVoiceFilter);
voiceSelect.addEventListener('change', updateBadges);

/* ===== RANGE CONTROLS ===== */
rateRange.addEventListener('input', function() {
  rateVal.textContent = parseFloat(rateRange.value).toFixed(rateRange.value % 1 === 0 ? 0 : 1) + 'x';
  computeStats();
});
pitchRange.addEventListener('input', function() {
  pitchVal.textContent = parseFloat(pitchRange.value).toFixed(1);
});
volumeRange.addEventListener('input', function() {
  volumeVal.textContent = Math.round(volumeRange.value * 100) + '%';
});

/* ===== TEXT STATS ===== */
ttsInput.addEventListener('input', computeStats);

function computeStats() {
  var text = ttsInput.value;
  var chars = text.length;
  var wordsArr = text.trim() ? text.trim().split(/\s+/) : [];
  var sentences = text.trim() ? text.split(/[.!?]+/).filter(function(s) { return s.trim().length > 0; }).length : 0;
  var rate = parseFloat(rateRange.value) || 1;
  var durSec = wordsArr.length > 0 ? Math.round((wordsArr.length / (150 * rate)) * 60) : 0;
  var durMin = Math.floor(durSec / 60);
  var durSecR = durSec % 60;
  var durStr = durMin > 0 ? durMin + 'm ' + durSecR + 's' : durSec + 's';

  document.getElementById('sChars').textContent = chars.toLocaleString();
  document.getElementById('sWords').textContent = wordsArr.length.toLocaleString();
  document.getElementById('sSentences').textContent = sentences.toLocaleString();
  document.getElementById('sDuration').textContent = durStr;
  document.getElementById('charCounter').textContent = chars.toLocaleString() + ' characters';
}
computeStats();

/* ===== SPEAK ===== */
function doSpeak() {
  var text = ttsInput.value.trim();
  if (!text) { showToast('Enter some text first'); return; }

  synth.cancel();
  clearKeepAlive();

  var voice = getVoice();
  if (!voice) { showToast('No voice available'); return; }

  currentUtt = new SpeechSynthesisUtterance(text);
  currentUtt.voice = voice;
  currentUtt.lang = voice.lang;
  currentUtt.rate = parseFloat(rateRange.value);
  currentUtt.pitch = parseFloat(pitchRange.value);
  currentUtt.volume = parseFloat(volumeRange.value);

  // Build highlight display
  buildHL(text);

  currentUtt.onstart = function() {
    isSpeaking = true;
    isPaused = false;
    setUI('speaking');
    progressBar.classList.add('active');
    progressFill.style.width = '0%';
    startKeepAlive();
  };

  currentUtt.onboundary = function(e) {
    if (e.name === 'word' && text.length > 0) {
      var pct = Math.min(100, Math.round((e.charIndex / text.length) * 100));
      progressFill.style.width = pct + '%';
      highlightAt(e.charIndex, e.charLength || 0);
    }
  };

  currentUtt.onend = function() {
    isSpeaking = false;
    isPaused = false;
    clearKeepAlive();
    progressFill.style.width = '100%';
    setTimeout(function() { progressBar.classList.remove('active'); progressFill.style.width = '0%'; }, 600);
    clearHL();
    showInput();
    setUI('idle');
  };

  currentUtt.onerror = function(e) {
    isSpeaking = false;
    isPaused = false;
    clearKeepAlive();
    progressBar.classList.remove('active');
    clearHL();
    showInput();
    setUI('idle');
    if (e.error !== 'canceled') showToast('Speech error: ' + e.error);
  };

  synth.speak(currentUtt);
}

function doPause() {
  if (isSpeaking && !isPaused) {
    synth.pause();
    isPaused = true;
    clearKeepAlive();
    setUI('paused');
  }
}

function doResume() {
  if (isPaused) {
    synth.resume();
    isPaused = false;
    startKeepAlive();
    setUI('speaking');
  }
}

function doStop() {
  synth.cancel();
  isSpeaking = false;
  isPaused = false;
  clearKeepAlive();
  progressBar.classList.remove('active');
  progressFill.style.width = '0%';
  clearHL();
  showInput();
  setUI('idle');
}

function setUI(state) {
  statusDot.className = 'status-dot ' + state;
  if (state === 'speaking') {
    statusText.innerHTML = '<strong>Speaking...</strong>';
    btnSpeak.disabled = true; btnPause.disabled = false; btnResume.disabled = true; btnStop.disabled = false;
  } else if (state === 'paused') {
    statusText.innerHTML = '<strong>Paused</strong> &mdash; click Resume to continue';
    btnSpeak.disabled = true; btnPause.disabled = true; btnResume.disabled = false; btnStop.disabled = false;
  } else if (state === 'recording') {
    statusText.innerHTML = '<strong>Recording...</strong> Speech is playing and being recorded';
    btnSpeak.disabled = true; btnPause.disabled = true; btnResume.disabled = true; btnStop.disabled = true;
  } else {
    statusText.innerHTML = 'Ready &mdash; type or paste text below';
    btnSpeak.disabled = false; btnPause.disabled = true; btnResume.disabled = true; btnStop.disabled = true;
  }
}

/* ===== CHROME KEEP-ALIVE (prevents pause on long texts) ===== */
function startKeepAlive() {
  clearKeepAlive();
  keepAlive = setInterval(function() {
    if (synth.speaking && !synth.paused) {
      synth.pause();
      synth.resume();
    }
  }, 14000);
}
function clearKeepAlive() {
  if (keepAlive) { clearInterval(keepAlive); keepAlive = null; }
}

/* ===== HIGHLIGHT SYSTEM ===== */
function buildHL(text) {
  hlArea.innerHTML = '';
  // Split text by whitespace, preserving it
  var parts = text.split(/(\s+)/);
  parts.forEach(function(part) {
    if (/^\s+$/.test(part)) {
      hlArea.appendChild(document.createTextNode(part));
    } else if (part.length > 0) {
      var span = document.createElement('span');
      span.className = 'w';
      span.textContent = part;
      hlArea.appendChild(span);
    }
  });
  ttsInput.style.display = 'none';
  hlArea.style.display = 'block';
}

function highlightAt(charIndex, charLen) {
  // Clear all highlights
  var spans = hlArea.querySelectorAll('.w');
  spans.forEach(function(s) { s.classList.remove('active'); });

  // Walk through child nodes to find the word at charIndex
  var offset = 0;
  var nodes = hlArea.childNodes;
  for (var i = 0; i < nodes.length; i++) {
    var node = nodes[i];
    var len = (node.textContent || '').length;
    if (offset + len > charIndex && node.classList && node.classList.contains('w')) {
      node.classList.add('active');
      // Auto-scroll the highlight area
      var rect = node.getBoundingClientRect();
      var areaRect = hlArea.getBoundingClientRect();
      if (rect.bottom > areaRect.bottom - 20 || rect.top < areaRect.top + 20) {
        node.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
      break;
    }
    offset += len;
  }
}

function clearHL() {
  var spans = hlArea.querySelectorAll('.w');
  spans.forEach(function(s) { s.classList.remove('active'); });
}

function showInput() {
  ttsInput.style.display = '';
  hlArea.style.display = 'none';
}

/* ===== DOWNLOAD AUDIO ===== */
function doDownload() {
  var text = ttsInput.value.trim();
  if (!text) { showToast('Enter some text first'); return; }
  if (isDownloading) { showToast('Already recording...'); return; }

  // Check for MediaRecorder support
  if (typeof MediaRecorder === 'undefined') {
    showToast('Audio recording not supported in this browser');
    return;
  }

  isDownloading = true;
  btnDownload.disabled = true;
  btnDownload.innerHTML = '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg> Recording...';
  statusDot.className = 'status-dot recording';
  setUI('recording');

  synth.cancel();
  clearKeepAlive();

  var voice = getVoice();
  var utt = new SpeechSynthesisUtterance(text);
  if (voice) { utt.voice = voice; utt.lang = voice.lang; }
  utt.rate = parseFloat(rateRange.value);
  utt.pitch = parseFloat(pitchRange.value);
  utt.volume = parseFloat(volumeRange.value);

  // Create AudioContext for recording
  var audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  var dest = audioCtx.createMediaStreamDestination();
  var osc = audioCtx.createOscillator();
  var gain = audioCtx.createGain();
  gain.gain.value = 0; // Silent carrier to keep recorder alive
  osc.connect(gain);
  gain.connect(dest);
  osc.start();

  var mimeType = getBestMime();
  var chunks = [];
  var recorder = new MediaRecorder(dest.stream, mimeType ? { mimeType: mimeType } : undefined);

  recorder.ondataavailable = function(e) { if (e.data.size > 0) chunks.push(e.data); };
  recorder.onstop = function() {
    var ext = (recorder.mimeType || '').indexOf('ogg') > -1 ? 'ogg' : 'webm';
    var blob = new Blob(chunks, { type: recorder.mimeType || 'audio/webm' });
    var url = URL.createObjectURL(blob);
    var a = document.createElement('a');
    a.href = url;
    a.download = 'text-to-speech.' + ext;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    try { audioCtx.close(); } catch(e) {}
    resetDownload();
    showToast('Note: The downloaded file contains a silent track. Browser TTS audio plays through system speakers and cannot be directly captured. Use a screen recorder for full audio.');
  };

  recorder.start();

  // Build highlight display
  buildHL(text);

  utt.onboundary = function(e) {
    if (e.name === 'word' && text.length > 0) {
      highlightAt(e.charIndex, e.charLength || 0);
      progressFill.style.width = Math.min(100, Math.round((e.charIndex / text.length) * 100)) + '%';
    }
  };

  utt.onend = function() {
    osc.stop();
    recorder.stop();
    clearHL();
    showInput();
    progressBar.classList.remove('active');
    progressFill.style.width = '0%';
  };

  utt.onerror = function(e) {
    try { osc.stop(); } catch(ex) {}
    try { recorder.stop(); } catch(ex) {}
    clearHL();
    showInput();
    resetDownload();
    if (e.error !== 'canceled') showToast('Recording failed: ' + e.error);
  };

  progressBar.classList.add('active');
  progressFill.style.width = '0%';
  synth.speak(utt);
  startKeepAlive();
}

function getBestMime() {
  var types = ['audio/webm;codecs=opus', 'audio/webm', 'audio/ogg;codecs=opus'];
  for (var i = 0; i < types.length; i++) {
    if (MediaRecorder.isTypeSupported(types[i])) return types[i];
  }
  return '';
}

function resetDownload() {
  isDownloading = false;
  isSpeaking = false;
  isPaused = false;
  clearKeepAlive();
  btnDownload.disabled = false;
  btnDownload.innerHTML = '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7,10 12,15 17,10"/><line x1="12" y1="15" x2="12" y2="3"/></svg> Download';
  setUI('idle');
}

/* ===== UTILITIES ===== */
function doClear() {
  doStop();
  ttsInput.value = '';
  computeStats();
  showToast('Cleared');
}

function loadSample() {
  ttsInput.value = 'Welcome to ANIMA, the best free online toolkit for developers, designers, and creators.\n\nThis text to speech tool converts your written words into natural-sounding audio using your browser\'s built-in speech synthesis engine. You can choose from dozens of voices across multiple languages, and adjust the speaking rate, pitch, and volume to your preference.\n\nThe tool highlights each word as it is spoken, making it easy to follow along. Whether you are proofreading an article, creating an accessibility preview, learning a new language, or just having fun with different voices, this tool has you covered.\n\nTry changing the voice, adjusting the speed, or switching to a different language. Everything runs locally in your browser with zero data sent to any server. Your privacy is fully protected.';
  computeStats();
  showToast('Sample text loaded');
}

function showToast(msg) {
  var t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(function() { t.classList.remove('show'); }, 3500);
}

/* ===== KEYBOARD SHORTCUTS ===== */
document.addEventListener('keydown', function(e) {
  if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
    e.preventDefault();
    if (isSpeaking && !isPaused) doPause();
    else if (isPaused) doResume();
    else doSpeak();
  }
  if (e.key === 'Escape' && (isSpeaking || isPaused)) {
    e.preventDefault();
    doStop();
  }
});

/* ===== FADE IN ===== */
var observer = new IntersectionObserver(function(entries) {
  entries.forEach(function(entry) {
    if (entry.isIntersecting) { entry.target.classList.add('visible'); observer.unobserve(entry.target); }
  });
}, { threshold: 0.1 });
document.querySelectorAll('.fade-in').forEach(function(el) { observer.observe(el); });
</script>
<script src="/js/analytics-lite.js" defer></script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What is text to speech?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Text to speech (TTS) is a technology that converts written text into spoken audio. ANIMA's free online text to speech tool uses the Web Speech API built into modern browsers to generate natural-sounding speech from any text you type or paste, with no signup or download required."
      }
    },
    {
      "@type": "Question",
      "name": "Is this text to speech tool free to use?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, ANIMA's text to speech converter is completely free. It runs entirely in your browser using the Web Speech API, so no data is sent to any server. There are no usage limits, no signup, and no watermarks."
      }
    },
    {
      "@type": "Question",
      "name": "What voices and languages are supported?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The available voices depend on your browser and operating system. Most modern browsers offer 50 to 200+ voices across dozens of languages including English, Spanish, French, German, Chinese, Japanese, Korean, Arabic, Hindi, and many more. You can filter by language and preview each voice."
      }
    },
    {
      "@type": "Question",
      "name": "Does the tool highlight words as they are spoken?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, ANIMA's text to speech tool highlights each word in real time as it is being spoken. This is especially useful for proofreading, language learning, accessibility testing, and following along with longer texts."
      }
    },
    {
      "@type": "Question",
      "name": "Which browsers support this text to speech tool?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The Web Speech API is supported in Chrome, Edge, Safari, and Firefox. Chrome and Edge typically offer the widest selection of voices. The tool works on both desktop and mobile browsers."
      }
    }
  ]
}
</script>
</body>
</html>

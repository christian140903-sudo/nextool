<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JSON to XML Converter - Bidirectional Conversion Online | NexTool</title>
<meta name="description" content="Convert JSON to XML and XML to JSON instantly. Configurable root element, pretty print, CDATA wrapping, and syntax highlighting. Free online tool.">
<meta property="og:title" content="JSON to XML Converter - NexTool">
<meta property="og:description" content="Bidirectional JSON/XML converter with syntax highlighting and configurable options.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/json-to-xml.html">
<meta property="og:image" content="https://nextool.app/assets/og-default.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="JSON to XML Converter - NexTool">
<meta name="twitter:description" content="Bidirectional JSON/XML converter with syntax highlighting and configurable options.">
<link rel="canonical" href="https://nextool.app/free-tools/json-to-xml.html">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"JSON to XML Converter","description":"Bidirectional JSON to XML and XML to JSON converter with formatting options.","url":"https://nextool.app/free-tools/json-to-xml.html","applicationCategory":"DeveloperApplication","operatingSystem":"Any","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"author":{"@type":"Organization","name":"NexTool"}}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--primary:#6366f1;--accent:#a855f7;--pink:#ec4899;--text:#e2e8f0;--text-dim:#94a3b8;--green:#22c55e;--red:#ef4444;--radius:12px;--radius-lg:20px}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;line-height:1.6}
nav{position:fixed;top:0;left:0;right:0;z-index:100;background:rgba(5,5,8,.85);backdrop-filter:blur(16px);border-bottom:1px solid rgba(99,102,241,.15);padding:0 24px;height:60px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{display:flex;align-items:center;gap:10px;font-weight:700;font-size:1.2rem;color:var(--text);text-decoration:none}
.nav-logo span{background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:1.4rem;font-weight:800}
.nav-links{display:flex;align-items:center;gap:20px}
.nav-links a{color:var(--text-dim);text-decoration:none;font-size:.9rem;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-badge{background:linear-gradient(135deg,#6366f1,#a855f7);color:#fff!important;padding:6px 14px;border-radius:20px;font-size:.8rem;font-weight:600}
main{max-width:1200px;margin:0 auto;padding:80px 20px 40px}
h1{font-size:2rem;font-weight:700;margin-bottom:8px}
.gradient-text{background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.subtitle{color:var(--text-dim);margin-bottom:24px;font-size:1.05rem}
.toolbar{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:16px;align-items:center}
.btn{background:var(--surface2);color:var(--text);border:1px solid rgba(99,102,241,.2);padding:8px 16px;border-radius:var(--radius);cursor:pointer;font-family:inherit;font-size:.85rem;transition:all .2s}
.btn:hover{border-color:var(--primary);background:rgba(99,102,241,.1)}
.btn-primary{background:var(--primary);border-color:var(--primary);color:#fff}
.btn-primary:hover{background:#5558e6}
.mode-toggle{display:flex;background:var(--surface);border-radius:var(--radius);overflow:hidden;border:1px solid rgba(99,102,241,.15)}
.mode-toggle button{background:transparent;color:var(--text-dim);border:none;padding:10px 20px;cursor:pointer;font-family:inherit;font-size:.9rem;font-weight:500;transition:all .2s}
.mode-toggle button.active{background:var(--primary);color:#fff}
.options-row{display:flex;flex-wrap:wrap;gap:16px;margin-bottom:16px;align-items:center}
.option-group{display:flex;align-items:center;gap:6px;font-size:.85rem;color:var(--text-dim)}
.option-group input[type="text"],.option-group select{background:var(--surface2);border:1px solid rgba(99,102,241,.2);color:var(--text);padding:6px 10px;border-radius:8px;font-family:inherit;font-size:.85rem;outline:none}
.option-group input[type="text"]:focus,.option-group select:focus{border-color:var(--primary)}
.option-group select{cursor:pointer}
label.option-check{display:flex;align-items:center;gap:6px;font-size:.85rem;color:var(--text-dim);cursor:pointer}
label.option-check input{accent-color:var(--primary)}
.panels{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:20px}
.panel{background:var(--surface);border:1px solid rgba(99,102,241,.12);border-radius:var(--radius-lg);overflow:hidden;display:flex;flex-direction:column}
.panel-header{padding:12px 16px;background:var(--surface2);font-weight:600;font-size:.9rem;display:flex;justify-content:space-between;align-items:center}
.panel textarea{width:100%;min-height:300px;background:transparent;border:none;color:var(--text);font-family:'JetBrains Mono',monospace;font-size:.84rem;padding:16px;resize:vertical;outline:none;flex:1}
.output-area{width:100%;min-height:300px;background:transparent;border:none;color:var(--text);font-family:'JetBrains Mono',monospace;font-size:.84rem;padding:16px;overflow:auto;flex:1;white-space:pre;line-height:1.5}
.output-area .xml-tag{color:#ec4899}.output-area .xml-attr{color:#a855f7}.output-area .xml-val{color:#22c55e}.output-area .xml-text{color:var(--text)}.output-area .xml-comment{color:var(--text-dim)}
.error-msg{color:var(--red);padding:16px;font-size:.9rem}
.status{font-weight:400;font-size:.8rem;color:var(--text-dim)}
.stats-row{display:flex;gap:16px;flex-wrap:wrap;margin-bottom:16px;font-size:.85rem;color:var(--text-dim)}
.stats-row span{background:var(--surface);padding:6px 14px;border-radius:8px;display:flex;align-items:center;gap:6px}
.stats-row strong{color:var(--text)}
.toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(80px);background:var(--green);color:#000;padding:10px 24px;border-radius:var(--radius);font-weight:600;font-size:.9rem;opacity:0;transition:all .3s ease;z-index:200;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0);opacity:1}
.cta-section{margin-top:60px;text-align:center;padding:48px 24px;background:var(--surface);border:1px solid rgba(99,102,241,.15);border-radius:var(--radius-lg)}
.cta-section h2{font-size:1.5rem;margin-bottom:12px}
.cta-section p{color:var(--text-dim);margin-bottom:24px;max-width:520px;margin-left:auto;margin-right:auto}
.cta-buttons{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
.cta-bundle{background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);color:#fff;padding:12px 28px;border-radius:var(--radius);text-decoration:none;font-weight:600;font-size:.95rem}
.cta-browse{background:var(--surface2);color:var(--text);padding:12px 28px;border-radius:var(--radius);text-decoration:none;font-weight:500;font-size:.95rem;border:1px solid rgba(99,102,241,.2)}
footer{margin-top:60px;padding:32px 24px;border-top:1px solid rgba(99,102,241,.1);text-align:center}
.footer-links{display:flex;justify-content:center;gap:24px;flex-wrap:wrap;margin-bottom:16px}
.footer-links a{color:var(--text-dim);text-decoration:none;font-size:.85rem}
.footer-links a:hover{color:var(--text)}
.footer-copy{color:var(--text-dim);font-size:.8rem}
@media(max-width:600px){
  .panels{grid-template-columns:1fr}
  h1{font-size:1.5rem}
  .nav-links a:not(.nav-badge){display:none}
  .stats-row{flex-direction:column;gap:6px}
}
</style>
</head>
<body>
<nav>
  <a href="/" class="nav-logo"><span>N</span> NexTool</a>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Tools</a>
    <a href="/pro.html" class="nav-badge">Get Pro</a>
  </div>
</nav>
<main>
  <h1><span class="gradient-text">JSON &harr; XML</span> Converter</h1>
  <p class="subtitle">Convert between JSON and XML instantly. Bidirectional, configurable, with syntax highlighting.</p>

  <div class="mode-toggle" style="margin-bottom:16px">
    <button id="modeJ2X" class="active" onclick="setMode('j2x')">JSON &rarr; XML</button>
    <button id="modeX2J" onclick="setMode('x2j')">XML &rarr; JSON</button>
  </div>

  <div class="options-row">
    <div class="option-group"><span>Root:</span><input type="text" id="rootName" value="root" style="width:100px"></div>
    <div class="option-group"><span>Indent:</span>
      <select id="indentSize"><option value="2">2 spaces</option><option value="4">4 spaces</option><option value="t">Tab</option></select>
    </div>
    <label class="option-check"><input type="checkbox" id="prettyPrint" checked> Pretty print</label>
    <label class="option-check"><input type="checkbox" id="cdataWrap"> CDATA for text</label>
    <label class="option-check"><input type="checkbox" id="xmlDecl" checked> XML declaration</label>
  </div>

  <div class="toolbar">
    <button class="btn btn-primary" onclick="convert()">Convert</button>
    <button class="btn" onclick="loadSample()">Load Sample</button>
    <button class="btn" onclick="swapInputOutput()">Use Output as Input</button>
    <button class="btn" onclick="copyOutput()">Copy Output</button>
    <button class="btn" onclick="downloadOutput()">Download</button>
    <button class="btn" onclick="clearAll()">Clear</button>
  </div>

  <div class="stats-row" id="statsRow" style="display:none">
    <span>Input: <strong id="inputChars">0</strong> chars</span>
    <span>Output: <strong id="outputChars">0</strong> chars</span>
    <span>Ratio: <strong id="sizeRatio">-</strong></span>
    <span>Elements: <strong id="elementCount">-</strong></span>
  </div>

  <div class="panels">
    <div class="panel">
      <div class="panel-header"><span id="inputLabel">Input JSON</span><span class="status" id="inputStatus"></span></div>
      <textarea id="inputArea" placeholder="Paste your JSON here..." spellcheck="false"></textarea>
    </div>
    <div class="panel">
      <div class="panel-header"><span id="outputLabel">Output XML</span><span class="status" id="outputStatus"></span></div>
      <div class="output-area" id="outputArea"></div>
    </div>
  </div>

  <section class="cta-section">
    <h2>Love this tool? Get the <span class="gradient-text">Ultimate Bundle</span></h2>
    <p>Access 100+ premium developer tools, templates, and automations for a one-time payment of $39.</p>
    <div class="cta-buttons">
      <a href="/pro.html" class="cta-bundle">Get Pro &mdash; $29</a>
      <a href="/free-tools/" class="cta-browse">Browse 150+ Free Tools &rarr;</a>
    </div>
  </section>
</main>
<footer>
  <div class="footer-links">
    <a href="/">Home</a><a href="/free-tools/">Tools</a><a href="/blog/">Blog</a><a href="/pro.html">Pro</a><a href="/#contact">Contact</a>
  </div>
  <div class="footer-copy">&copy; 2026 NexTool. All rights reserved.</div>
</footer>
<div class="toast" id="toast">Copied!</div>

<script>
/* ===== DOM HELPER ===== */
const $ = function(id) {
  return document.getElementById(id);
};

/* ===== STATE ===== */
let mode = 'j2x';
let rawOutput = '';
let conversionCount = 0;

/* ===== TOAST NOTIFICATIONS ===== */
function showToast(message) {
  const toastEl = $('toast');
  toastEl.textContent = message;
  toastEl.classList.add('show');
  setTimeout(function() {
    toastEl.classList.remove('show');
  }, 1800);
}

/* ===== MODE SWITCHING ===== */
function setMode(m) {
  mode = m;
  /* Update toggle button states */
  $('modeJ2X').classList.toggle('active', m === 'j2x');
  $('modeX2J').classList.toggle('active', m === 'x2j');

  /* Update panel labels based on conversion direction */
  $('inputLabel').textContent = m === 'j2x' ? 'Input JSON' : 'Input XML';
  $('outputLabel').textContent = m === 'j2x' ? 'Output XML' : 'Output JSON';

  /* Update placeholder text to guide the user */
  $('inputArea').placeholder = m === 'j2x'
    ? 'Paste your JSON here...'
    : 'Paste your XML here...';

  /* Clear output and status indicators */
  $('outputArea').innerHTML = '';
  $('inputStatus').textContent = '';
  $('outputStatus').textContent = '';
  $('statsRow').style.display = 'none';
  rawOutput = '';
}

/* ===== INDENTATION HELPER ===== */
function getIndent() {
  const value = $('indentSize').value;
  if (value === 't') {
    return '\t';
  }
  return ' '.repeat(parseInt(value));
}

/* ===== XML ESCAPING FUNCTIONS ===== */
function escapeXml(str) {
  return String(str)
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;');
}

function escapeHtml(str) {
  return String(str)
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;');
}

/* ===== JSON TO XML CONVERSION ENGINE ===== */
function jsonToXml(obj, rootName, indent, depth, useCdata) {
  var pad = indent.repeat(depth);
  var padInner = indent.repeat(depth + 1);
  var xml = '';

  /* Handle null and undefined values with xsi:nil attribute */
  if (obj === null || obj === undefined) {
    return pad + '<' + rootName + ' xsi:nil="true"/>' + '\n';
  }

  /* Handle arrays by iterating each element as an <item> */
  if (Array.isArray(obj)) {
    for (var i = 0; i < obj.length; i++) {
      xml += jsonToXml(obj[i], 'item', indent, depth, useCdata);
    }
    return xml;
  }

  /* Handle objects by recursing into each property */
  if (typeof obj === 'object') {
    xml += pad + '<' + rootName + '>\n';
    var entries = Object.entries(obj);
    for (var e = 0; e < entries.length; e++) {
      var key = entries[e][0];
      var val = entries[e][1];
      /* Sanitize tag names: replace invalid XML characters with underscore */
      var safeName = key.replace(/[^a-zA-Z0-9_-]/g, '_');

      if (Array.isArray(val)) {
        /* Wrap arrays in a parent element with the property name */
        xml += padInner + '<' + safeName + '>\n';
        for (var a = 0; a < val.length; a++) {
          xml += jsonToXml(val[a], 'item', indent, depth + 2, useCdata);
        }
        xml += padInner + '</' + safeName + '>\n';
      } else {
        xml += jsonToXml(val, safeName, indent, depth + 1, useCdata);
      }
    }
    xml += pad + '</' + rootName + '>\n';
    return xml;
  }

  /* Handle primitive values (string, number, boolean) */
  var text = String(obj);
  if (useCdata && typeof obj === 'string') {
    /* Wrap string values in CDATA sections to preserve special characters */
    xml += pad + '<' + rootName + '><![CDATA[' + text + ']]></' + rootName + '>\n';
  } else {
    xml += pad + '<' + rootName + '>' + escapeXml(text) + '</' + rootName + '>\n';
  }
  return xml;
}

/* ===== XML TO JSON CONVERSION ENGINE ===== */
function xmlToJson(xmlStr) {
  var parser = new DOMParser();
  var doc = parser.parseFromString(xmlStr, 'text/xml');

  /* Check for XML parsing errors */
  var errorNode = doc.querySelector('parsererror');
  if (errorNode) {
    throw new Error('Invalid XML: ' + errorNode.textContent.substring(0, 120));
  }

  return nodeToJson(doc.documentElement);
}

/* ===== RECURSIVE NODE TO JSON TRANSFORMER ===== */
function nodeToJson(node) {
  /* Text nodes return their trimmed content or null */
  if (node.nodeType === 3) {
    return node.textContent.trim() || null;
  }
  /* Skip non-element nodes (comments, processing instructions, etc.) */
  if (node.nodeType !== 1) {
    return null;
  }

  /* Filter to only meaningful children (elements and non-empty text nodes) */
  var children = Array.from(node.childNodes).filter(function(n) {
    if (n.nodeType === 3) {
      return n.textContent.trim().length > 0;
    }
    return n.nodeType === 1;
  });

  /* Empty element returns null or its text content */
  if (children.length === 0) {
    return node.textContent.trim() || null;
  }

  /* Single text child returns the text directly */
  if (children.length === 1 && children[0].nodeType === 3) {
    return children[0].textContent.trim();
  }

  /* Build an object from child elements */
  var obj = {};
  var elementChildren = children.filter(function(c) {
    return c.nodeType === 1;
  });

  /* Count tag occurrences to detect arrays */
  var tagCounts = {};
  elementChildren.forEach(function(c) {
    tagCounts[c.tagName] = (tagCounts[c.tagName] || 0) + 1;
  });

  /* Convert children to properties, using arrays for repeated tags */
  elementChildren.forEach(function(c) {
    var val = nodeToJson(c);
    if (tagCounts[c.tagName] > 1) {
      if (!obj[c.tagName]) {
        obj[c.tagName] = [];
      }
      obj[c.tagName].push(val);
    } else {
      obj[c.tagName] = val;
    }
  });

  /* Convert XML attributes to @ prefixed properties */
  if (node.attributes && node.attributes.length > 0) {
    for (var i = 0; i < node.attributes.length; i++) {
      var attr = node.attributes[i];
      obj['@' + attr.name] = attr.value;
    }
  }

  return obj;
}

/* ===== COUNT XML ELEMENTS FOR STATISTICS ===== */
function countElements(xmlStr) {
  var matches = xmlStr.match(/<[a-zA-Z][^/]*?>/g);
  return matches ? matches.length : 0;
}

/* ===== UPDATE CONVERSION STATISTICS ===== */
function updateStats(inputLen, outputLen) {
  $('statsRow').style.display = 'flex';
  $('inputChars').textContent = inputLen.toLocaleString();
  $('outputChars').textContent = outputLen.toLocaleString();

  /* Calculate size ratio between output and input */
  if (inputLen > 0) {
    var ratio = (outputLen / inputLen).toFixed(2);
    $('sizeRatio').textContent = ratio + 'x';
  } else {
    $('sizeRatio').textContent = '-';
  }

  /* Count XML elements in the output */
  if (mode === 'j2x' && rawOutput) {
    $('elementCount').textContent = countElements(rawOutput);
  } else {
    $('elementCount').textContent = '-';
  }
}

/* ===== XML SYNTAX HIGHLIGHTING ===== */
function highlightXml(xml) {
  return escapeHtml(xml)
    .replace(/(&lt;\/?)([\w:_-]+)/g, '$1<span class="xml-tag">$2</span>')
    .replace(/([\w:_-]+)(=)(&quot;[^&]*&quot;)/g,
      '<span class="xml-attr">$1</span>$2<span class="xml-val">$3</span>')
    .replace(/(&lt;!--.*?--&gt;)/g, '<span class="xml-comment">$1</span>');
}

/* ===== MAIN CONVERSION FUNCTION ===== */
function convert() {
  var input = $('inputArea').value.trim();

  /* Validate that input is not empty */
  if (!input) {
    $('inputStatus').textContent = 'Empty input';
    $('inputStatus').style.color = '#ef4444';
    return;
  }

  var indent = getIndent();
  var pretty = $('prettyPrint').checked;
  var cdata = $('cdataWrap').checked;
  var root = $('rootName').value.trim() || 'root';
  var includeDecl = $('xmlDecl').checked;

  try {
    if (mode === 'j2x') {
      /* Parse the JSON input */
      var obj = JSON.parse(input);
      $('inputStatus').textContent = 'Valid JSON';
      $('inputStatus').style.color = '#22c55e';

      /* Build the XML output with optional declaration header */
      var xml = '';
      if (includeDecl) {
        xml = '<?xml version="1.0" encoding="UTF-8"?>\n';
      }
      xml += jsonToXml(obj, root, indent, 0, cdata);

      /* Remove whitespace if pretty print is disabled */
      if (!pretty) {
        xml = xml.replace(/\n\s*/g, '');
      }

      rawOutput = xml;
      $('outputArea').innerHTML = highlightXml(xml);
      $('outputStatus').textContent = xml.length + ' chars';
      $('outputStatus').style.color = 'var(--text-dim)';

      /* Update the stats display */
      updateStats(input.length, xml.length);

    } else {
      /* XML to JSON conversion */
      var result = xmlToJson(input);
      $('inputStatus').textContent = 'Valid XML';
      $('inputStatus').style.color = '#22c55e';

      /* Format the JSON output with the selected indentation */
      var indentStr = indent === '\t' ? '\t' : parseInt($('indentSize').value);
      var json = pretty
        ? JSON.stringify(result, null, indentStr)
        : JSON.stringify(result);

      rawOutput = json;
      $('outputArea').textContent = json;
      $('outputStatus').textContent = json.length + ' chars';
      $('outputStatus').style.color = 'var(--text-dim)';

      /* Update the stats display */
      updateStats(input.length, json.length);
    }

    /* Track the number of conversions performed */
    conversionCount++;

  } catch (e) {
    $('inputStatus').textContent = 'Error';
    $('inputStatus').style.color = '#ef4444';
    $('outputArea').innerHTML = '<div class="error-msg">' + escapeHtml(e.message) + '</div>';
    $('statsRow').style.display = 'none';
    rawOutput = '';
  }
}

/* ===== SAMPLE DATA LOADER ===== */
function loadSample() {
  if (mode === 'j2x') {
    /* Load a representative JSON sample with various data types */
    var sampleObj = {
      company: "NexTool",
      year: 2026,
      tagline: "AI Automation Studio",
      services: [
        "websites",
        "chatbots",
        "automation",
        "content",
        "video",
        "data"
      ],
      pricing: {
        basic: 5,
        pro: 49,
        enterprise: 499
      },
      features: {
        openSource: true,
        apiAccess: false,
        customDomain: true
      },
      contact: "user@example.com",
      active: true
    };
    $('inputArea').value = JSON.stringify(sampleObj, null, 2);
  } else {
    /* Load a representative XML sample */
    var sampleXml = '<?xml version="1.0" encoding="UTF-8"?>\n';
    sampleXml += '<company>\n';
    sampleXml += '  <name>NexTool</name>\n';
    sampleXml += '  <year>2026</year>\n';
    sampleXml += '  <tagline>AI Automation Studio</tagline>\n';
    sampleXml += '  <services>\n';
    sampleXml += '    <item>websites</item>\n';
    sampleXml += '    <item>chatbots</item>\n';
    sampleXml += '    <item>automation</item>\n';
    sampleXml += '    <item>content</item>\n';
    sampleXml += '    <item>video</item>\n';
    sampleXml += '    <item>data</item>\n';
    sampleXml += '  </services>\n';
    sampleXml += '  <pricing>\n';
    sampleXml += '    <basic>5</basic>\n';
    sampleXml += '    <pro>49</pro>\n';
    sampleXml += '    <enterprise>499</enterprise>\n';
    sampleXml += '  </pricing>\n';
    sampleXml += '  <active>true</active>\n';
    sampleXml += '</company>';
    $('inputArea').value = sampleXml;
  }

  /* Auto-convert after loading sample data */
  convert();
  showToast('Sample loaded!');
}

/* ===== SWAP INPUT AND OUTPUT ===== */
function swapInputOutput() {
  if (!rawOutput) {
    showToast('Convert something first.');
    return;
  }

  /* Move the raw output text into the input area */
  $('inputArea').value = rawOutput;
  $('outputArea').innerHTML = '';
  $('outputStatus').textContent = '';
  rawOutput = '';

  /* Automatically switch the conversion mode */
  if (mode === 'j2x') {
    setMode('x2j');
  } else {
    setMode('j2x');
  }

  /* Re-paste the value since setMode clears things */
  showToast('Output moved to input!');
}

/* ===== COPY OUTPUT TO CLIPBOARD ===== */
function copyOutput() {
  if (!rawOutput) {
    showToast('Nothing to copy yet.');
    return;
  }
  navigator.clipboard.writeText(rawOutput).then(function() {
    showToast('Copied to clipboard!');
  });
}

/* ===== DOWNLOAD OUTPUT AS FILE ===== */
function downloadOutput() {
  if (!rawOutput) {
    showToast('Convert something first.');
    return;
  }

  /* Determine file extension based on current conversion direction */
  var ext = (mode === 'j2x') ? 'xml' : 'json';
  var mimeType = 'text/' + ext;

  var blob = new Blob([rawOutput], { type: mimeType });
  var link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = 'converted.' + ext;
  link.click();

  /* Clean up the object URL after download */
  URL.revokeObjectURL(link.href);
  showToast('Downloaded as converted.' + ext);
}

/* ===== CLEAR ALL ===== */
function clearAll() {
  $('inputArea').value = '';
  $('outputArea').innerHTML = '';
  $('inputStatus').textContent = '';
  $('outputStatus').textContent = '';
  $('statsRow').style.display = 'none';
  rawOutput = '';
  showToast('Cleared!');
}

/* ===== LIVE INPUT VALIDATION ===== */
$('inputArea').addEventListener('input', function() {
  var value = $('inputArea').value.trim();

  /* Skip validation if input is empty */
  if (!value) {
    $('inputStatus').textContent = '';
    return;
  }

  try {
    if (mode === 'j2x') {
      /* Validate JSON syntax */
      JSON.parse(value);
      $('inputStatus').textContent = 'Valid JSON';
      $('inputStatus').style.color = '#22c55e';
    } else {
      /* Validate XML syntax using DOMParser */
      var parser = new DOMParser();
      var doc = parser.parseFromString(value, 'text/xml');
      if (doc.querySelector('parsererror')) {
        throw new Error('parse error');
      }
      $('inputStatus').textContent = 'Valid XML';
      $('inputStatus').style.color = '#22c55e';
    }
  } catch (e) {
    $('inputStatus').textContent = 'Invalid';
    $('inputStatus').style.color = '#ef4444';
  }
});

/* ===== KEYBOARD SHORTCUT: Ctrl/Cmd+Enter to convert ===== */
document.addEventListener('keydown', function(e) {
  if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
    e.preventDefault();
    convert();
  }
});
</script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script src="/js/analytics-lite.js" defer></script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Color Blindness Simulator - Free Online Tool | NexTool</title>
<meta name="description" content="Simulate 8 types of color vision deficiency. Test your colors for accessibility with our free color blindness simulator. Protanopia, Deuteranopia, Tritanopia and more.">
<meta property="og:title" content="Color Blindness Simulator - Free Online Tool | NexTool">
<meta property="og:description" content="Simulate 8 types of color vision deficiency. Test your colors for accessibility instantly.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/color-blindness-simulator.html">
<meta property="og:image" content="https://nextool.app/og/color-blindness-simulator.png">
<link rel="canonical" href="https://nextool.app/free-tools/color-blindness-simulator.html">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Color Blindness Simulator | NexTool">
<meta name="twitter:description" content="Simulate 8 types of color vision deficiency. Test your colors for accessibility instantly.">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"Color Blindness Simulator","description":"Simulate 8 types of color vision deficiency and test color accessibility.","url":"https://nextool.app/free-tools/color-blindness-simulator.html","applicationCategory":"DesignApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"author":{"@type":"Organization","name":"NexTool","url":"https://nextool.app"}}
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
/* === Reset & Design Tokens === */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#050508;
  --surface:#111118;
  --surface2:#1a1a24;
  --primary:#6366f1;
  --accent:#a855f7;
  --pink:#ec4899;
  --text:#e2e8f0;
  --text-dim:#94a3b8;
  --radius:12px;
  --radius-lg:20px;
  --gradient:linear-gradient(135deg,#6366f1,#a855f7,#ec4899)
}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh}

/* === Navigation === */
nav{position:fixed;top:0;left:0;right:0;z-index:100;background:rgba(5,5,8,.85);backdrop-filter:blur(20px);border-bottom:1px solid rgba(99,102,241,.15);padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{display:flex;align-items:center;gap:.6rem;text-decoration:none;font-weight:800;font-size:1.25rem;color:var(--text)}
.nav-logo span{background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-size:1.5rem;font-weight:900}
.nav-links{display:flex;align-items:center;gap:1.5rem}
.nav-links a{color:var(--text-dim);text-decoration:none;font-size:.9rem;font-weight:500;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-badge{background:var(--gradient);color:#fff!important;padding:.4rem 1rem;border-radius:20px;font-size:.8rem;font-weight:700;text-decoration:none;transition:opacity .2s}
.nav-badge:hover{opacity:.85}

/* === Main Container === */
main{max-width:1100px;margin:0 auto;padding:84px 1.5rem 2rem}
h1{font-size:2.5rem;font-weight:800;margin-bottom:.5rem;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.subtitle{color:var(--text-dim);font-size:1.1rem;margin-bottom:2rem}

/* === Cards === */
.card{background:var(--surface);border:1px solid rgba(99,102,241,.1);border-radius:var(--radius);padding:1.5rem;margin-bottom:1.5rem}
.card h2{font-size:1.2rem;font-weight:700;margin-bottom:1rem}

/* === Form Controls === */
.input-row{display:flex;gap:1rem;flex-wrap:wrap;align-items:flex-end;margin-bottom:1rem}
.field{display:flex;flex-direction:column;gap:.4rem}
.field label{font-size:.8rem;font-weight:600;color:var(--text-dim);text-transform:uppercase;letter-spacing:.05em}
.field input[type="text"],.field input[type="number"]{background:var(--surface2);border:1px solid rgba(99,102,241,.2);border-radius:8px;padding:.6rem 1rem;color:var(--text);font-family:'Inter',sans-serif;font-size:.95rem;outline:none;transition:border-color .2s}
.field input:focus{border-color:var(--primary)}
.field input[type="color"]{width:50px;height:40px;border:none;background:none;cursor:pointer;border-radius:8px}

/* === Buttons === */
.btn{background:var(--gradient);color:#fff;border:none;padding:.7rem 1.5rem;border-radius:8px;font-family:'Inter',sans-serif;font-weight:600;font-size:.9rem;cursor:pointer;transition:opacity .2s}
.btn:hover{opacity:.85}
.btn-sm{padding:.5rem 1rem;font-size:.8rem}
.btn-outline{background:transparent;border:1px solid var(--primary);color:var(--primary)}
.btn-outline:hover{background:rgba(99,102,241,.1);opacity:1}

/* === Palette Swatches === */
.palette-input{display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:1rem}
.palette-input .swatch{width:48px;height:48px;border-radius:8px;cursor:pointer;border:2px solid transparent;transition:border-color .2s;position:relative}
.palette-input .swatch:hover{border-color:rgba(255,255,255,.4)}
.palette-input .swatch.active{border-color:var(--text)}
.palette-input .add-swatch{width:48px;height:48px;border-radius:8px;border:2px dashed rgba(99,102,241,.3);display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--text-dim);font-size:1.4rem;background:transparent;transition:border-color .2s}
.palette-input .add-swatch:hover{border-color:var(--primary)}

/* === Simulation Grid === */
.sim-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:1rem;margin-top:1rem}
.sim-card{background:var(--surface2);border-radius:var(--radius);padding:1.2rem;position:relative}
.sim-card h3{font-size:.95rem;font-weight:700;margin-bottom:.3rem}
.sim-card .pop{font-size:.75rem;color:var(--text-dim);margin-bottom:.8rem}
.sim-colors{display:flex;gap:.4rem;flex-wrap:wrap}
.sim-colors .dot{width:40px;height:40px;border-radius:8px;position:relative}
.sim-colors .dot .hex-label{position:absolute;bottom:-18px;left:50%;transform:translateX(-50%);font-size:.6rem;font-family:'JetBrains Mono',monospace;color:var(--text-dim);white-space:nowrap}

/* === Original Preview === */
.original-preview{display:flex;gap:.5rem;align-items:center;margin-bottom:1rem}
.original-preview .big-dot{width:64px;height:64px;border-radius:var(--radius)}
.original-preview .info{font-family:'JetBrains Mono',monospace;font-size:.85rem}

/* === Contrast Checker === */
.contrast-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem;margin-top:1rem}
.contrast-card{background:var(--surface2);border-radius:8px;padding:1rem}
.contrast-card h4{font-size:.85rem;font-weight:700;margin-bottom:.5rem}
.contrast-row{display:flex;justify-content:space-between;align-items:center;padding:.3rem 0;font-size:.8rem;border-bottom:1px solid rgba(99,102,241,.05)}
.contrast-row .ratio{font-family:'JetBrains Mono',monospace;font-weight:600}
.contrast-row .pass{color:#22c55e}
.contrast-row .fail{color:#ef4444}
.contrast-row .warn{color:#f59e0b}

/* === Gradient Bar === */
.gradient-bar{height:60px;border-radius:8px;margin-bottom:1rem;position:relative}

/* === Recommendations === */
.recommendations{margin-top:1.5rem;padding:1.2rem;background:rgba(99,102,241,.08);border-radius:var(--radius);border-left:3px solid var(--primary)}
.recommendations h3{font-size:1rem;margin-bottom:.6rem}
.recommendations ul{padding-left:1.2rem;font-size:.9rem;color:var(--text-dim)}
.recommendations li{margin-bottom:.3rem}

/* === Info Section === */
.info-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem;margin-top:.5rem}
.info-card{background:var(--surface2);border-radius:8px;padding:1rem}
.info-card h4{font-size:.85rem;font-weight:700;margin-bottom:.3rem;color:var(--primary)}
.info-card p{font-size:.8rem;color:var(--text-dim);line-height:1.5}

/* === CTA Section === */
.cta-section{background:var(--surface);border:1px solid rgba(99,102,241,.15);border-radius:var(--radius-lg);padding:3rem 2rem;text-align:center;margin:3rem 0}
.cta-section h2{font-size:1.8rem;font-weight:800;margin-bottom:.5rem}
.cta-section p{color:var(--text-dim);margin-bottom:1.5rem;max-width:500px;margin-left:auto;margin-right:auto}
.cta-buttons{display:flex;gap:1rem;justify-content:center;flex-wrap:wrap}

/* === Footer === */
footer{border-top:1px solid rgba(99,102,241,.1);padding:2rem 1.5rem;text-align:center;max-width:1100px;margin:0 auto}
.footer-links{display:flex;justify-content:center;gap:2rem;flex-wrap:wrap;margin-bottom:1rem}
.footer-links a{color:var(--text-dim);text-decoration:none;font-size:.85rem;transition:color .2s}
.footer-links a:hover{color:var(--text)}
.footer-copy{font-size:.8rem;color:var(--text-dim)}

/* === Mobile Responsive === */
@media(max-width:600px){
  h1{font-size:1.7rem}
  .sim-grid{grid-template-columns:1fr}
  .contrast-grid{grid-template-columns:1fr}
  .info-grid{grid-template-columns:1fr}
  .input-row{flex-direction:column}
  nav{padding:0 1rem}
  .nav-links{gap:.8rem}
  .nav-links a:not(.nav-badge){display:none}
}
</style>
</head>
<body>
<!-- Navigation -->
<nav>
<a href="/" class="nav-logo"><span>N</span> NexTool</a>
<div class="nav-links">
<a href="/">Home</a>
<a href="/free-tools/">Tools</a>
<a href="/pro.html" class="nav-badge">Get Pro</a>
</div>
</nav>

<main>
<h1>Color Blindness Simulator</h1>
<p class="subtitle">Test how your colors appear to people with color vision deficiencies. Supports 8 types of CVD including Protanopia, Deuteranopia, Tritanopia, and more.</p>

<!-- Color Input -->
<div class="card">
<h2>Input Colors</h2>
<p style="font-size:.85rem;color:var(--text-dim);margin-bottom:1rem">Pick a color using the picker or enter a hex, RGB, or HSL value. Add up to 12 colors to your palette.</p>
<div class="input-row">
<div class="field">
<label>Color</label>
<div style="display:flex;gap:.5rem;align-items:center">
<input type="color" id="colorPicker" value="#6366f1">
<input type="text" id="colorHex" value="#6366f1" style="width:140px" placeholder="#hex, rgb(), hsl()">
</div>
</div>
<button class="btn" onclick="addToPalette()">Add to Palette</button>
<button class="btn btn-outline" onclick="randomPalette()">Random Palette</button>
<button class="btn btn-outline" onclick="simulateAll()">Simulate</button>
</div>
<div class="palette-input" id="palette">
<button class="add-swatch" onclick="document.getElementById('colorHex').focus()">+</button>
</div>
<div id="originalPreview"></div>
</div>

<!-- Gradient Preview -->
<div class="card">
<h2>Gradient Preview</h2>
<p style="font-size:.85rem;color:var(--text-dim);margin-bottom:1rem">Test how a gradient looks under different CVD types. Enter start, mid, and end colors.</p>
<div class="gradient-bar" id="gradientBar" style="background:linear-gradient(90deg,#6366f1,#a855f7,#ec4899)"></div>
<div class="input-row">
<div class="field"><label>Start</label><input type="text" id="gradStart" value="#6366f1" style="width:120px"></div>
<div class="field"><label>Mid</label><input type="text" id="gradMid" value="#a855f7" style="width:120px"></div>
<div class="field"><label>End</label><input type="text" id="gradEnd" value="#ec4899" style="width:120px"></div>
<button class="btn btn-sm" onclick="updateGradient()">Update</button>
</div>
</div>

<!-- Simulation Results -->
<div class="card">
<h2>Simulation Results</h2>
<p style="font-size:.85rem;color:var(--text-dim);margin-bottom:.5rem">See how your palette appears under each of the 8 color vision deficiency types.</p>
<div class="sim-grid" id="simGrid"></div>
</div>

<!-- Contrast Checker -->
<div class="card">
<h2>WCAG Contrast Check</h2>
<p style="font-size:.85rem;color:var(--text-dim);margin-bottom:.5rem">Checks contrast ratio between your first two palette colors across all CVD types (WCAG AA requires 4.5:1 for normal text, 3:1 for large text).</p>
<div class="contrast-grid" id="contrastGrid"></div>
</div>

<!-- Accessibility Recommendations -->
<div class="card recommendations" id="recommendations" style="display:none">
<h3>Accessibility Recommendations</h3>
<ul id="recList"></ul>
</div>

<!-- CVD Information -->
<div class="card">
<h2>About Color Vision Deficiency</h2>
<div class="info-grid">
<div class="info-card">
<h4>Red-Green (Most Common)</h4>
<p>Protanopia and Deuteranopia affect ~8% of males. People with these conditions have difficulty distinguishing red from green, making traffic lights and status indicators challenging.</p>
</div>
<div class="info-card">
<h4>Blue-Yellow (Rare)</h4>
<p>Tritanopia is extremely rare, affecting only 0.001% of the population. Blue and yellow appear similar, but red-green distinction is preserved.</p>
</div>
<div class="info-card">
<h4>Monochromacy</h4>
<p>Achromatopsia (total color blindness) is the rarest form at 0.003%. These individuals see only in shades of gray and rely entirely on brightness differences.</p>
</div>
<div class="info-card">
<h4>Design Best Practices</h4>
<p>Never use color as the only means of conveying information. Always pair color with text labels, icons, patterns, or shapes to ensure universal accessibility.</p>
</div>
</div>
</div>

<!-- CTA Section -->
<div class="cta-section">
<h2>Unlock the Full Design Toolkit</h2>
<p>Get 100+ premium tools, templates, and automation workflows in one bundle.</p>
<div class="cta-buttons">
<a href="/pro.html" class="btn">Get NexTool Pro - $29</a>
<a href="/free-tools/" class="btn btn-outline">Browse 150+ Free Tools &rarr;</a>
</div>
</div>
</main>

<!-- Footer -->

<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/box-shadow-generator.html" style="color:var(--primary);text-decoration:none">CSS Box Shadow Generator</a> 路 <a href="/free-tools/favicon-generator.html" style="color:var(--primary);text-decoration:none">Favicon Generator</a> 路 <a href="/free-tools/emoji-picker.html" style="color:var(--primary);text-decoration:none">Emoji Picker & Search</a> 路 <a href="/free-tools/meta-tag-generator.html" style="color:var(--primary);text-decoration:none">Meta Tag Generator</a> 路 <a href="/free-tools/color-palette.html" style="color:var(--primary);text-decoration:none">Free Color Palette Generator</a></p>
</div>
<footer>
<div class="footer-links">
<a href="/">Home</a>
<a href="/free-tools/">Tools</a>
<a href="/blog/">Blog</a>
<a href="/pro.html">Pro</a>
<a href="/#contact">Contact</a>
</div>
<div class="footer-copy">&copy; 2026 NexTool. All rights reserved.</div>
</footer>

<script>
/* === CVD Type Definitions with Color Transform Matrices === */
const CVD_TYPES = [
  { name: "Protanopia", pop: "1.3% of males", desc: "No red cones",
    matrix: [0.567, 0.433, 0, 0, 0.558, 0.442, 0, 0, 0, 0.242, 0.758, 0] },
  { name: "Deuteranopia", pop: "1.2% of males", desc: "No green cones",
    matrix: [0.625, 0.375, 0, 0, 0.7, 0.3, 0, 0, 0, 0.3, 0.7, 0] },
  { name: "Tritanopia", pop: "0.001% of population", desc: "No blue cones",
    matrix: [0.95, 0.05, 0, 0, 0, 0.433, 0.567, 0, 0, 0.475, 0.525, 0] },
  { name: "Protanomaly", pop: "1.08% of males", desc: "Reduced red sensitivity",
    matrix: [0.817, 0.183, 0, 0, 0.333, 0.667, 0, 0, 0, 0.125, 0.875, 0] },
  { name: "Deuteranomaly", pop: "4.63% of males", desc: "Reduced green (most common CVD)",
    matrix: [0.8, 0.2, 0, 0, 0.258, 0.742, 0, 0, 0, 0.142, 0.858, 0] },
  { name: "Tritanomaly", pop: "0.0001% of population", desc: "Reduced blue sensitivity",
    matrix: [0.967, 0.033, 0, 0, 0, 0.733, 0.267, 0, 0, 0.183, 0.817, 0] },
  { name: "Achromatopsia", pop: "0.003% of population", desc: "No color vision (grayscale)",
    matrix: [0.299, 0.587, 0.114, 0, 0.299, 0.587, 0.114, 0, 0.299, 0.587, 0.114, 0] },
  { name: "Achromatomaly", pop: "Extremely rare", desc: "Severely reduced color vision",
    matrix: [0.618, 0.32, 0.062, 0, 0.163, 0.775, 0.062, 0, 0.163, 0.32, 0.516, 0] }
];

/* === Palette State === */
let palette = [];

/* === Parse Color String (hex, rgb, hsl) === */
function parseColor(str) {
  str = str.trim();
  if (str.startsWith('#')) {
    let h = str.slice(1);
    if (h.length === 3) h = h[0] + h[0] + h[1] + h[1] + h[2] + h[2];
    return { r: parseInt(h.slice(0, 2), 16), g: parseInt(h.slice(2, 4), 16), b: parseInt(h.slice(4, 6), 16) };
  }
  let m = str.match(/rgb\w?\((\d+),\s*(\d+),\s*(\d+)/);
  if (m) return { r: +m[1], g: +m[2], b: +m[3] };
  m = str.match(/hsl\w?\((\d+),\s*([\d.]+)%?,\s*([\d.]+)%?/);
  if (m) {
    let h = +m[1] / 360, s = +m[2] / 100, l = +m[3] / 100;
    if (s === 0) { let v = Math.round(l * 255); return { r: v, g: v, b: v }; }
    const hue2rgb = (p, q, t) => { if (t < 0) t += 1; if (t > 1) t -= 1; if (t < 1 / 6) return p + (q - p) * 6 * t; if (t < 1 / 2) return q; if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6; return p; };
    const q = l < .5 ? l * (1 + s) : l + s - l * s, p = 2 * l - q;
    return { r: Math.round(hue2rgb(p, q, h + 1 / 3) * 255), g: Math.round(hue2rgb(p, q, h) * 255), b: Math.round(hue2rgb(p, q, h - 1 / 3) * 255) };
  }
  return null;
}

/* === Convert RGB to Hex === */
function rgbToHex(r, g, b) {
  return '#' + [r, g, b].map(v => Math.max(0, Math.min(255, Math.round(v))).toString(16).padStart(2, '0')).join('');
}

/* === Apply CVD Color Transform Matrix === */
function applyMatrix(rgb, m) {
  return {
    r: Math.max(0, Math.min(255, Math.round(m[0] * rgb.r + m[1] * rgb.g + m[2] * rgb.b))),
    g: Math.max(0, Math.min(255, Math.round(m[4] * rgb.r + m[5] * rgb.g + m[6] * rgb.b))),
    b: Math.max(0, Math.min(255, Math.round(m[8] * rgb.r + m[9] * rgb.g + m[10] * rgb.b)))
  };
}

/* === Euclidean Color Distance === */
function colorDist(a, b) {
  return Math.sqrt((a.r - b.r) ** 2 + (a.g - b.g) ** 2 + (a.b - b.b) ** 2);
}

/* === WCAG Relative Luminance === */
function luminance(rgb) {
  const [rs, gs, bs] = [rgb.r, rgb.g, rgb.b].map(c => {
    c = c / 255;
    return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
  });
  return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
}

/* === WCAG Contrast Ratio === */
function contrastRatio(a, b) {
  const la = luminance(a), lb = luminance(b);
  const lighter = Math.max(la, lb), darker = Math.min(la, lb);
  return (lighter + 0.05) / (darker + 0.05);
}

/* === WCAG Verdict === */
function wcagVerdict(ratio) {
  if (ratio >= 7) return { label: 'AAA', cls: 'pass' };
  if (ratio >= 4.5) return { label: 'AA', cls: 'pass' };
  if (ratio >= 3) return { label: 'AA Large', cls: 'warn' };
  return { label: 'Fail', cls: 'fail' };
}

/* === Sync Color Picker and Text Input === */
document.getElementById('colorPicker').addEventListener('input', e => {
  document.getElementById('colorHex').value = e.target.value;
});
document.getElementById('colorHex').addEventListener('input', e => {
  const c = parseColor(e.target.value);
  if (c) document.getElementById('colorPicker').value = rgbToHex(c.r, c.g, c.b);
});

/* === Add Color to Palette === */
function addToPalette() {
  const c = parseColor(document.getElementById('colorHex').value);
  if (!c) return;
  const hex = rgbToHex(c.r, c.g, c.b);
  if (palette.length >= 12) return;
  palette.push({ hex, rgb: c });
  renderPalette();
}

/* === Generate Random Palette === */
function randomPalette() {
  palette = [];
  for (let i = 0; i < 5; i++) {
    const r = Math.floor(Math.random() * 256);
    const g = Math.floor(Math.random() * 256);
    const b = Math.floor(Math.random() * 256);
    palette.push({ hex: rgbToHex(r, g, b), rgb: { r, g, b } });
  }
  renderPalette();
  simulateAll();
}

/* === Render Palette Swatches === */
function renderPalette() {
  const el = document.getElementById('palette');
  el.innerHTML = palette.map((p, i) =>
    `<div class="swatch" style="background:${p.hex}" title="${p.hex} (click to remove)" onclick="removeSwatch(${i})"></div>`
  ).join('') + `<button class="add-swatch" onclick="document.getElementById('colorHex').focus()">+</button>`;
}

/* === Remove Swatch from Palette === */
function removeSwatch(i) {
  palette.splice(i, 1);
  renderPalette();
}

/* === Run Full Simulation === */
function simulateAll() {
  /* Ensure at least one color in the palette */
  if (palette.length === 0) {
    const c = parseColor(document.getElementById('colorHex').value);
    if (!c) return;
    palette.push({ hex: rgbToHex(c.r, c.g, c.b), rgb: c });
    renderPalette();
  }

  /* Render simulation cards */
  const grid = document.getElementById('simGrid');
  grid.innerHTML = '';
  const recs = [];

  CVD_TYPES.forEach(cvd => {
    const dots = palette.map(p => {
      const sim = applyMatrix(p.rgb, cvd.matrix);
      const h = rgbToHex(sim.r, sim.g, sim.b);
      return `<div class="dot" style="background:${h}"><span class="hex-label">${h}</span></div>`;
    }).join('');
    grid.innerHTML += `<div class="sim-card"><h3>${cvd.name}</h3><p class="pop">${cvd.pop} &mdash; ${cvd.desc}</p><div class="sim-colors">${dots}</div></div>`;

    /* Check for indistinguishable color pairs */
    if (palette.length >= 2) {
      for (let i = 0; i < palette.length; i++) {
        for (let j = i + 1; j < palette.length; j++) {
          const a = applyMatrix(palette[i].rgb, cvd.matrix);
          const b = applyMatrix(palette[j].rgb, cvd.matrix);
          if (colorDist(a, b) < 30) {
            recs.push(`Colors ${palette[i].hex} and ${palette[j].hex} may be indistinguishable under <strong>${cvd.name}</strong>. Consider adding pattern, icon, or text labels.`);
          }
        }
      }
    }
  });

  /* Contrast check between first two palette colors */
  if (palette.length >= 2) {
    const cGrid = document.getElementById('contrastGrid');
    let html = '';
    /* Normal vision */
    const normalRatio = contrastRatio(palette[0].rgb, palette[1].rgb);
    const normalV = wcagVerdict(normalRatio);
    html += `<div class="contrast-card"><h4>Normal Vision</h4>
      <div class="contrast-row"><span>${palette[0].hex} vs ${palette[1].hex}</span><span class="ratio ${normalV.cls}">${normalRatio.toFixed(2)}:1 (${normalV.label})</span></div></div>`;
    /* Each CVD type */
    CVD_TYPES.forEach(cvd => {
      const a = applyMatrix(palette[0].rgb, cvd.matrix);
      const b = applyMatrix(palette[1].rgb, cvd.matrix);
      const r = contrastRatio(a, b);
      const v = wcagVerdict(r);
      html += `<div class="contrast-card"><h4>${cvd.name}</h4>
        <div class="contrast-row"><span>${rgbToHex(a.r, a.g, a.b)} vs ${rgbToHex(b.r, b.g, b.b)}</span><span class="ratio ${v.cls}">${r.toFixed(2)}:1 (${v.label})</span></div></div>`;
    });
    cGrid.innerHTML = html;
  }

  /* Render recommendations */
  const rSec = document.getElementById('recommendations');
  const rList = document.getElementById('recList');
  if (recs.length > 0) {
    rSec.style.display = 'block';
    rList.innerHTML = [...new Set(recs)].map(r => `<li>${r}</li>`).join('');
    rList.innerHTML += `<li>Always use sufficient contrast ratios (WCAG AA: 4.5:1 for text).</li>
      <li>Never rely on color alone to convey information.</li>
      <li>Add icons, patterns, or text labels alongside color indicators.</li>`;
  } else {
    rSec.style.display = 'block';
    rList.innerHTML = `<li>Your palette looks reasonably distinguishable across CVD types.</li>
      <li>Always verify with real-world testing for critical applications.</li>
      <li>Use sufficient contrast ratios (WCAG AA: 4.5:1 for text).</li>`;
  }
}

/* === Update Gradient Preview === */
function updateGradient() {
  const s = document.getElementById('gradStart').value;
  const m = document.getElementById('gradMid').value;
  const e = document.getElementById('gradEnd').value;
  document.getElementById('gradientBar').style.background = `linear-gradient(90deg,${s},${m},${e})`;
  palette = [];
  [s, m, e].forEach(c => {
    const p = parseColor(c);
    if (p) palette.push({ hex: rgbToHex(p.r, p.g, p.b), rgb: p });
  });
  renderPalette();
  simulateAll();
}

/* === Initialize with Default Palette === */
palette = [
  { hex: '#6366f1', rgb: { r: 99, g: 102, b: 241 } },
  { hex: '#22c55e', rgb: { r: 34, g: 197, b: 94 } },
  { hex: '#ef4444', rgb: { r: 239, g: 68, b: 68 } },
  { hex: '#f59e0b', rgb: { r: 245, g: 158, b: 11 } }
];
renderPalette();
simulateAll();
</script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script src="/js/analytics-lite.js" defer></script>
</body>
</html>

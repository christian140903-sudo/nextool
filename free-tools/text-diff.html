<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Text Diff Tool — Compare Text Side by Side | NexTool</title>
<meta name="description" content="Free online text diff tool. Compare two texts side by side with character, word, and line-level highlighting. See additions, deletions, and changes instantly.">
<meta name="keywords" content="text diff, compare text, diff checker, text comparison, side by side diff, online diff tool, free diff tool, NexTool">
<meta property="og:title" content="Free Text Diff Tool — Compare Text Side by Side | NexTool">
<meta property="og:description" content="Compare two texts with character, word, and line-level diff. Highlights additions, deletions, and modifications. 100% free.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/text-diff.html">
<meta property="og:image" content="https://nextool.app/assets/og-default.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<link rel="canonical" href="https://nextool.app/free-tools/text-diff.html">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free Text Diff Tool — Compare Text Side by Side | NexTool">
<meta name="twitter:description" content="Compare two texts with character, word, and line-level diff highlighting. Free online tool by NexTool.">
<meta name="robots" content="index, follow">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"NexTool Text Diff Tool","applicationCategory":"DeveloperApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"description":"Free online text diff tool to compare two texts side by side with character, word, and line-level highlighting."}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--border:#2a2a3a;--text:#e4e4eb;--text2:#9494a8;--primary:#6366f1;--accent:#a855f7;--pink:#ec4899;--green:#22c55e;--red:#ef4444;--cyan:#22d3ee;--yellow:#eab308;--radius:12px;--glass:rgba(17,17,24,0.7)}
html{scroll-behavior:smooth}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
/* NAV */
.nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{font-size:1.4rem;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-decoration:none}
.nav-links{display:flex;align-items:center;gap:1.5rem}
.nav-links a{color:var(--text2);text-decoration:none;font-size:.875rem;font-weight:500;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-cta{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff!important;padding:.5rem 1.2rem;border-radius:8px;font-weight:600;-webkit-text-fill-color:#fff!important}
.nav-cta:hover{opacity:.9}
.nav-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}
/* HERO */
.hero{text-align:center;padding:3rem 1.5rem 2rem;max-width:700px;margin:0 auto}
.hero h1{font-size:2.2rem;font-weight:800;line-height:1.2;margin-bottom:.75rem}
.hero h1 span{background:linear-gradient(135deg,var(--primary),var(--accent),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--text2);font-size:1rem}
/* TOOL */
.tool-container{max-width:1400px;margin:0 auto;padding:0 1.5rem 3rem}
.toolbar{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem;align-items:center}
.toolbar button,.toolbar select,.toolbar label{background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.45rem .9rem;border-radius:8px;font-size:.8rem;font-weight:500;cursor:pointer;transition:all .2s;font-family:inherit}
.toolbar button:hover{border-color:var(--primary);background:rgba(99,102,241,.12)}
.toolbar button.active{background:linear-gradient(135deg,var(--primary),var(--accent));border-color:transparent;color:#fff}
.toolbar select{appearance:none;padding-right:1.8rem;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%239494a8' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .6rem center}
.toolbar label{display:flex;align-items:center;gap:.4rem;cursor:pointer;user-select:none}
.toolbar label input[type="checkbox"]{accent-color:var(--primary);width:14px;height:14px;cursor:pointer}
.toolbar .sep{width:1px;height:24px;background:var(--border);margin:0 .25rem}
/* STATS */
.stats-bar{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:1rem;font-size:.8rem;color:var(--text2);padding:.6rem 1rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)}
.stat{display:flex;align-items:center;gap:.35rem}
.stat-dot{width:8px;height:8px;border-radius:50%;display:inline-block;flex-shrink:0}
.stat-dot.added{background:var(--green)}.stat-dot.removed{background:var(--red)}.stat-dot.modified{background:var(--yellow)}.stat-dot.unchanged{background:var(--border)}
.stat-val{font-weight:600;color:var(--text)}
/* PANELS */
.input-panels{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1rem}
.panel{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;display:flex;flex-direction:column}
.panel-header{padding:.6rem 1rem;border-bottom:1px solid var(--border);font-size:.8rem;font-weight:600;color:var(--text2);display:flex;justify-content:space-between;align-items:center;background:rgba(26,26,36,0.5)}
.panel-body{flex:1;position:relative;overflow:auto}
.input-area{width:100%;height:100%;min-height:260px;background:transparent;border:none;color:var(--text);font-family:'Courier New',monospace;font-size:.85rem;padding:1rem;resize:none;outline:none;line-height:1.7;tab-size:2}
.input-area::placeholder{color:var(--text2);opacity:.5}
/* OUTPUT */
.output-panel{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;display:flex;flex-direction:column;min-height:300px}
.diff-output{display:grid;grid-template-columns:1fr 1fr;flex:1;overflow:auto}
.diff-output.unified-view{grid-template-columns:1fr}
.diff-side{overflow:auto;border-right:1px solid var(--border);min-height:300px}
.diff-side:last-child{border-right:none}
.diff-line{display:flex;font-family:'Courier New',monospace;font-size:.82rem;line-height:1.7;min-height:1.7em;border-bottom:1px solid rgba(42,42,58,.3)}
.diff-ln{min-width:42px;padding:0 8px;text-align:right;color:var(--text2);background:rgba(26,26,36,.5);user-select:none;font-size:.75rem;display:flex;align-items:center;justify-content:flex-end;flex-shrink:0}
.diff-marker{min-width:20px;padding:0 4px;text-align:center;user-select:none;font-weight:700;font-size:.8rem;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.diff-content{flex:1;padding:0 8px;white-space:pre-wrap;word-break:break-all;display:flex;align-items:center}
/* Line types */
.diff-line.added{background:rgba(34,197,94,.08)}
.diff-line.added .diff-ln{background:rgba(34,197,94,.12);color:var(--green)}
.diff-line.added .diff-marker{color:var(--green)}
.diff-line.removed{background:rgba(239,68,68,.08)}
.diff-line.removed .diff-ln{background:rgba(239,68,68,.12);color:var(--red)}
.diff-line.removed .diff-marker{color:var(--red)}
.diff-line.modified{background:rgba(234,179,8,.06)}
.diff-line.modified .diff-ln{background:rgba(234,179,8,.1);color:var(--yellow)}
.diff-line.modified .diff-marker{color:var(--yellow)}
.diff-line.empty-placeholder{background:rgba(42,42,58,.15)}
.diff-line.empty-placeholder .diff-content{color:var(--border)}
/* Inline highlights */
.hl-add{background:rgba(34,197,94,.25);border-radius:2px;padding:0 1px}
.hl-del{background:rgba(239,68,68,.25);border-radius:2px;padding:0 1px;text-decoration:line-through;text-decoration-color:rgba(239,68,68,.5)}
/* Unified view extras */
.unified-view .diff-line{display:flex}
.unified-view .diff-ln-pair{display:flex;flex-shrink:0}
.unified-view .diff-ln{min-width:36px}
/* CTA */
.cta-section{text-align:center;padding:4rem 1.5rem;max-width:700px;margin:0 auto}
.cta-section h2{font-size:1.8rem;font-weight:800;margin-bottom:.75rem}
.cta-section h2 span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.cta-section p{color:var(--text2);margin-bottom:1.5rem}
.cta-btn{display:inline-block;background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;padding:.75rem 2rem;border-radius:10px;font-weight:700;text-decoration:none;font-size:1rem;transition:transform .2s,box-shadow .2s}
.cta-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(99,102,241,.3)}
/* FOOTER */
.footer{border-top:1px solid var(--border);padding:3rem 2rem 2rem;max-width:1200px;margin:0 auto}
.footer-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:2rem;margin-bottom:2rem}
.footer-col h4{font-size:.85rem;font-weight:700;margin-bottom:.75rem;color:var(--text)}
.footer-col a{display:block;color:var(--text2);text-decoration:none;font-size:.8rem;margin-bottom:.4rem;transition:color .2s}
.footer-col a:hover{color:var(--primary)}
.footer-bottom{text-align:center;color:var(--text2);font-size:.75rem;padding-top:1.5rem;border-top:1px solid var(--border)}
/* FADE IN */
.fade-in{opacity:0;transform:translateY(20px);transition:opacity .6s,transform .6s}
.fade-in.visible{opacity:1;transform:translateY(0)}
/* TOAST */
.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.6rem 1.2rem;border-radius:10px;font-size:.85rem;font-weight:500;z-index:200;transition:transform .3s;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0)}
/* RESPONSIVE */
@media(max-width:768px){
  .input-panels{grid-template-columns:1fr}
  .diff-output{grid-template-columns:1fr}
  .diff-output .diff-side:first-child{border-right:none;border-bottom:1px solid var(--border)}
  .nav-links{display:none;position:absolute;top:64px;left:0;right:0;background:var(--bg);border-bottom:1px solid var(--border);flex-direction:column;padding:1rem 2rem;gap:1rem}
  .nav-links.open{display:flex}
  .nav-toggle{display:block}
  .hero h1{font-size:1.6rem}
  .footer-grid{grid-template-columns:1fr}
  .toolbar{gap:.35rem}
  .stats-bar{gap:.6rem}
}
</style>
</head>
<body>

<nav class="nav">
  <a href="/" class="nav-logo">NexTool</a>
  <button class="nav-toggle" onclick="document.querySelector('.nav-links').classList.toggle('open')" aria-label="Menu">&#9776;</button>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Tools</a>
    <a href="/free-tools/">Free Tools</a>
    <a href="/blog/">Blog</a>
    <a href="/#contact" class="nav-cta">Get Pro &mdash; $29</a>
  </div>
</nav>

<section class="hero fade-in">
  <h1>Free <span>Text Diff</span> Tool</h1>
  <p class="tool-summary" style="color:#94a3b8;font-size:15px;line-height:1.6;margin-bottom:24px;max-width:700px;margin-left:auto;margin-right:auto;">Compare two texts side by side with character-level, word-level, or line-level diff highlighting. See additions, deletions, and modifications at a glance. 100% client-side, no data leaves your browser.</p>
</section>

<div class="tool-container fade-in">
  <div class="toolbar">
    <button onclick="runDiff()" title="Compare the two texts">Compare</button>
    <div class="sep"></div>
    <select id="diffMode" title="Diff granularity">
      <option value="char">Character-level</option>
      <option value="word">Word-level</option>
      <option value="line">Line-level</option>
    </select>
    <div class="sep"></div>
    <label title="Ignore leading/trailing whitespace and collapse spaces"><input type="checkbox" id="ignoreWhitespace"> Ignore whitespace</label>
    <label title="Treat uppercase and lowercase as the same"><input type="checkbox" id="ignoreCase"> Ignore case</label>
    <div class="sep"></div>
    <button onclick="swapPanels()" title="Swap left and right text">Swap</button>
    <button onclick="copyPatch()" title="Copy diff in unified patch format">Copy Patch</button>
    <button onclick="loadSample()" title="Load sample text to try the tool">Sample</button>
    <button onclick="clearAll()" title="Clear all inputs and output">Clear</button>
  </div>

  <div class="input-panels">
    <div class="panel">
      <div class="panel-header"><span>Original (Left)</span><span id="leftCount"></span></div>
      <div class="panel-body">
        <textarea class="input-area" id="leftInput" placeholder="Paste original text here..." spellcheck="false"></textarea>
      </div>
    </div>
    <div class="panel">
      <div class="panel-header"><span>Modified (Right)</span><span id="rightCount"></span></div>
      <div class="panel-body">
        <textarea class="input-area" id="rightInput" placeholder="Paste modified text here..." spellcheck="false"></textarea>
      </div>
    </div>
  </div>

  <div class="stats-bar" id="statsBar" style="display:none">
    <div class="stat"><span class="stat-dot added"></span> Added: <span class="stat-val" id="statAdded">0</span></div>
    <div class="stat"><span class="stat-dot removed"></span> Removed: <span class="stat-val" id="statRemoved">0</span></div>
    <div class="stat"><span class="stat-dot modified"></span> Modified: <span class="stat-val" id="statModified">0</span></div>
    <div class="stat"><span class="stat-dot unchanged"></span> Unchanged: <span class="stat-val" id="statUnchanged">0</span></div>
    <div class="stat" style="margin-left:auto">Total lines: <span class="stat-val" id="statTotal">0</span></div>
  </div>

  <div class="output-panel" id="outputPanel" style="display:none">
    <div class="panel-header"><span>Diff Result</span><span id="outputInfo"></span></div>
    <div class="diff-output" id="diffOutput">
      <div class="diff-side" id="diffLeft"></div>
      <div class="diff-side" id="diffRight"></div>
    </div>
  </div>
</div>

<section class="cta-section fade-in">
  <h2>Need something <span>more powerful</span>?</h2>
  <p>Let us build it for you. Custom APIs, dashboards, automations &mdash; whatever you need.</p>
  <a href="/#contact" class="cta-btn">Start a Project &rarr;</a>
</section>

<!-- Cross Promo -->
<section style="max-width:900px;margin:40px auto;padding:0 24px;">
<div style="background:linear-gradient(135deg,rgba(99,102,241,0.1),rgba(168,85,247,0.08));border:1px solid rgba(99,102,241,0.15);border-radius:20px;padding:32px 28px;text-align:center;">
<div style="font-size:13px;color:#818cf8;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Founding Member</div>
<h3 style="font-size:22px;font-weight:800;color:#fff;margin:0 0 8px;">Get NexTool Pro</h3>
<p style="color:#94a3b8;font-size:14px;margin:0 auto 20px;max-width:500px;">No banners, clean output, enhanced features on all 150+ tools. One-time payment.</p>
<div style="display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;">
<a href="/pro.html" style="display:inline-block;padding:12px 28px;background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);color:#fff;border-radius:10px;font-weight:700;font-size:15px;text-decoration:none;">$29 &mdash; Get Pro</a>
<a href="/free-tools/" style="color:#94a3b8;font-size:14px;text-decoration:none;">Browse 150+ Free Tools &rarr;</a>
</div>
</div>
</section>


<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/diff-checker.html" style="color:var(--primary);text-decoration:none">Text Diff Checker</a> · <a href="/free-tools/box-shadow-generator.html" style="color:var(--primary);text-decoration:none">CSS Box Shadow Generator</a> · <a href="/free-tools/code-diff-viewer.html" style="color:var(--primary);text-decoration:none">Free Code Diff Viewer</a></p>
</div>
<footer class="footer fade-in">
  <div class="footer-grid">
    <div class="footer-col">
      <h4>Products</h4>
      <a href="/free-tools/">150+ Free Tools</a>
<a href="/pro.html">NexTool Pro</a>
<a href="/workspace.html">Workspace</a>
    </div>
    <div class="footer-col">
      <h4>Explore</h4>
      <a href="/free-tools/">Free Tools</a><a href="/blog/">Blog</a><a href="/pro.html">FAQ</a><a href="/pro.html">Pro &mdash; $29</a>
    </div>
    <div class="footer-col">
      <h4>Ecosystem</h4>
      <a href="/">NexTool Home</a><a href="/#contact">Contact</a><a href="https://github.com/christian140903-sudo/nextool" target="_blank">GitHub</a>
    </div>
  </div>
  <div class="footer-bottom">&copy; 2026 NexTool. AI-powered tools for everyone.</div>
</footer>

<div class="toast" id="toast"></div>

<script>
const leftInput = document.getElementById('leftInput');
const rightInput = document.getElementById('rightInput');
const leftCount = document.getElementById('leftCount');
const rightCount = document.getElementById('rightCount');
const diffLeft = document.getElementById('diffLeft');
const diffRight = document.getElementById('diffRight');
const diffOutput = document.getElementById('diffOutput');
const outputPanel = document.getElementById('outputPanel');
const statsBar = document.getElementById('statsBar');
let lastDiffResult = null;

leftInput.addEventListener('input', () => updateCount(leftInput, leftCount));
rightInput.addEventListener('input', () => updateCount(rightInput, rightCount));

function updateCount(el, countEl) {
  const lines = el.value.split('\n').length;
  countEl.textContent = lines + ' line' + (lines !== 1 ? 's' : '');
}

/* ---- LCS-based line diff ---- */
function lcs(a, b) {
  const m = a.length, n = b.length;
  const dp = Array.from({length: m + 1}, () => new Uint16Array(n + 1));
  for (let i = 1; i <= m; i++)
    for (let j = 1; j <= n; j++)
      dp[i][j] = a[i-1] === b[j-1] ? dp[i-1][j-1] + 1 : Math.max(dp[i-1][j], dp[i][j-1]);
  const seq = [];
  let i = m, j = n;
  while (i > 0 && j > 0) {
    if (a[i-1] === b[j-1]) { seq.push({ai: i-1, bi: j-1}); i--; j--; }
    else if (dp[i-1][j] >= dp[i][j-1]) i--;
    else j--;
  }
  return seq.reverse();
}

function normalise(line, opts) {
  let s = line;
  if (opts.ignoreCase) s = s.toLowerCase();
  if (opts.ignoreWS) s = s.replace(/\s+/g, ' ').trim();
  return s;
}

function computeLineDiff(leftLines, rightLines, opts) {
  const normL = leftLines.map(l => normalise(l, opts));
  const normR = rightLines.map(l => normalise(l, opts));
  const common = lcs(normL, normR);
  const ops = []; // {type: 'equal'|'delete'|'insert'|'modify', li, ri, left, right}
  let li = 0, ri = 0;
  for (const c of common) {
    // Lines before this common pair
    while (li < c.ai && ri < c.bi) {
      ops.push({type: 'modify', li, ri, left: leftLines[li], right: rightLines[ri]});
      li++; ri++;
    }
    while (li < c.ai) {
      ops.push({type: 'delete', li, ri: null, left: leftLines[li], right: null});
      li++;
    }
    while (ri < c.bi) {
      ops.push({type: 'insert', li: null, ri, left: null, right: rightLines[ri]});
      ri++;
    }
    ops.push({type: 'equal', li, ri, left: leftLines[li], right: rightLines[ri]});
    li++; ri++;
  }
  // Remaining lines
  while (li < leftLines.length && ri < rightLines.length) {
    ops.push({type: 'modify', li, ri, left: leftLines[li], right: rightLines[ri]});
    li++; ri++;
  }
  while (li < leftLines.length) {
    ops.push({type: 'delete', li, ri: null, left: leftLines[li], right: null});
    li++;
  }
  while (ri < rightLines.length) {
    ops.push({type: 'insert', li: null, ri, left: null, right: rightLines[ri]});
    ri++;
  }
  return ops;
}

/* ---- Inline diff (character or word level) ---- */
function tokenize(str, mode) {
  if (mode === 'word') {
    const tokens = [];
    const re = /(\s+|\S+)/g;
    let m;
    while ((m = re.exec(str)) !== null) tokens.push(m[0]);
    return tokens;
  }
  return str.split('');
}

function inlineDiff(a, b, mode) {
  const tokA = tokenize(a, mode);
  const tokB = tokenize(b, mode);
  const common = lcs(tokA, tokB);
  const result = {left: [], right: []};
  let ai = 0, bi = 0;
  for (const c of common) {
    if (ai < c.ai) result.left.push({type: 'del', text: tokA.slice(ai, c.ai).join('')});
    if (bi < c.bi) result.right.push({type: 'add', text: tokB.slice(bi, c.bi).join('')});
    result.left.push({type: 'eq', text: tokA[c.ai]});
    result.right.push({type: 'eq', text: tokB[c.bi]});
    ai = c.ai + 1;
    bi = c.bi + 1;
  }
  if (ai < tokA.length) result.left.push({type: 'del', text: tokA.slice(ai).join('')});
  if (bi < tokB.length) result.right.push({type: 'add', text: tokB.slice(bi).join('')});
  return result;
}

function escHtml(s) { return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

function renderInline(parts, delClass, addClass) {
  return parts.map(p => {
    const txt = escHtml(p.text);
    if (p.type === 'del') return '<span class="' + delClass + '">' + txt + '</span>';
    if (p.type === 'add') return '<span class="' + addClass + '">' + txt + '</span>';
    return txt;
  }).join('');
}

/* ---- Main diff + render ---- */
function runDiff() {
  const leftText = leftInput.value;
  const rightText = rightInput.value;
  if (!leftText && !rightText) { showToast('Enter text in both panels'); return; }

  const mode = document.getElementById('diffMode').value;
  const ignoreWS = document.getElementById('ignoreWhitespace').checked;
  const ignoreCase = document.getElementById('ignoreCase').checked;
  const opts = {ignoreWS, ignoreCase};

  const leftLines = leftText.split('\n');
  const rightLines = rightText.split('\n');
  const ops = computeLineDiff(leftLines, rightLines, opts);

  lastDiffResult = {ops, leftLines, rightLines};

  // Stats
  let added = 0, removed = 0, modified = 0, unchanged = 0;
  ops.forEach(op => {
    if (op.type === 'equal') unchanged++;
    else if (op.type === 'insert') added++;
    else if (op.type === 'delete') removed++;
    else if (op.type === 'modify') modified++;
  });

  document.getElementById('statAdded').textContent = added;
  document.getElementById('statRemoved').textContent = removed;
  document.getElementById('statModified').textContent = modified;
  document.getElementById('statUnchanged').textContent = unchanged;
  document.getElementById('statTotal').textContent = ops.length;
  statsBar.style.display = '';

  // Render side-by-side
  let htmlL = '', htmlR = '';
  let lnL = 0, lnR = 0;

  for (const op of ops) {
    if (op.type === 'equal') {
      lnL++; lnR++;
      const txt = escHtml(op.left);
      htmlL += diffLineHTML('', lnL, '', txt);
      htmlR += diffLineHTML('', lnR, '', txt);
    } else if (op.type === 'delete') {
      lnL++;
      htmlL += diffLineHTML('removed', lnL, '-', escHtml(op.left));
      htmlR += diffLineHTML('empty-placeholder', '', '', '');
    } else if (op.type === 'insert') {
      lnR++;
      htmlL += diffLineHTML('empty-placeholder', '', '', '');
      htmlR += diffLineHTML('added', lnR, '+', escHtml(op.right));
    } else if (op.type === 'modify') {
      lnL++; lnR++;
      if (mode === 'line') {
        htmlL += diffLineHTML('removed', lnL, '-', escHtml(op.left));
        htmlR += diffLineHTML('added', lnR, '+', escHtml(op.right));
      } else {
        const inlineMode = mode === 'word' ? 'word' : 'char';
        const il = inlineDiff(op.left, op.right, inlineMode);
        const leftHtml = renderInline(il.left, 'hl-del', 'hl-add');
        const rightHtml = renderInline(il.right, 'hl-del', 'hl-add');
        htmlL += diffLineHTML('modified', lnL, '~', leftHtml);
        htmlR += diffLineHTML('modified', lnR, '~', rightHtml);
      }
    }
  }

  diffLeft.innerHTML = htmlL;
  diffRight.innerHTML = htmlR;
  outputPanel.style.display = '';

  document.getElementById('outputInfo').textContent =
    added + ' added, ' + removed + ' removed, ' + modified + ' modified';

  // Sync scroll
  syncScroll();
}

function diffLineHTML(cls, ln, marker, content) {
  return '<div class="diff-line ' + cls + '">' +
    '<div class="diff-ln">' + (ln || '') + '</div>' +
    '<div class="diff-marker">' + marker + '</div>' +
    '<div class="diff-content">' + (content || '&nbsp;') + '</div>' +
    '</div>';
}

function syncScroll() {
  const left = diffLeft;
  const right = diffRight;
  let syncing = false;
  left.addEventListener('scroll', () => {
    if (syncing) return;
    syncing = true;
    right.scrollTop = left.scrollTop;
    right.scrollLeft = left.scrollLeft;
    requestAnimationFrame(() => syncing = false);
  });
  right.addEventListener('scroll', () => {
    if (syncing) return;
    syncing = true;
    left.scrollTop = right.scrollTop;
    left.scrollLeft = right.scrollLeft;
    requestAnimationFrame(() => syncing = false);
  });
}

/* ---- Actions ---- */
function swapPanels() {
  const tmp = leftInput.value;
  leftInput.value = rightInput.value;
  rightInput.value = tmp;
  updateCount(leftInput, leftCount);
  updateCount(rightInput, rightCount);
  showToast('Panels swapped');
}

function copyPatch() {
  if (!lastDiffResult) { showToast('Run a diff first'); return; }
  const {ops} = lastDiffResult;
  let patch = '--- original\n+++ modified\n';
  let lnL = 0, lnR = 0;
  // Build hunks
  const hunks = [];
  let currentHunk = null;

  for (let i = 0; i < ops.length; i++) {
    const op = ops[i];
    const isChange = op.type !== 'equal';

    if (isChange) {
      if (!currentHunk) {
        const ctxStart = Math.max(0, i - 3);
        currentHunk = {startI: ctxStart, endI: i, ops: []};
        // Add context before
        for (let c = ctxStart; c < i; c++) currentHunk.ops.push(ops[c]);
      }
      currentHunk.ops.push(op);
      currentHunk.endI = i;
    } else {
      if (currentHunk) {
        // Check if we should extend or close
        if (i - currentHunk.endI <= 6) {
          currentHunk.ops.push(op);
          currentHunk.endI = i;
        } else {
          // Add trailing context
          const ctxEnd = Math.min(ops.length - 1, currentHunk.endI + 3);
          for (let c = currentHunk.endI + 1; c <= ctxEnd; c++) currentHunk.ops.push(ops[c]);
          hunks.push(currentHunk);
          currentHunk = null;
        }
      }
    }
  }
  if (currentHunk) {
    const ctxEnd = Math.min(ops.length - 1, currentHunk.endI + 3);
    for (let c = currentHunk.endI + 1; c <= ctxEnd; c++) currentHunk.ops.push(ops[c]);
    hunks.push(currentHunk);
  }

  if (hunks.length === 0) {
    patch += '@@ -1,0 +1,0 @@\n No differences found.\n';
  } else {
    for (const hunk of hunks) {
      let hLnL = 0, hLnR = 0, hStartL = 0, hStartR = 0, first = true;
      const lines = [];
      for (const op of hunk.ops) {
        if (op.type === 'equal') {
          if (first) { hStartL = (op.li || 0) + 1; hStartR = (op.ri || 0) + 1; first = false; }
          lines.push(' ' + op.left); hLnL++; hLnR++;
        } else if (op.type === 'delete') {
          if (first) { hStartL = (op.li || 0) + 1; hStartR = (hLnR || 0) + 1; first = false; }
          lines.push('-' + op.left); hLnL++;
        } else if (op.type === 'insert') {
          if (first) { hStartL = (hLnL || 0) + 1; hStartR = (op.ri || 0) + 1; first = false; }
          lines.push('+' + op.right); hLnR++;
        } else if (op.type === 'modify') {
          if (first) { hStartL = (op.li || 0) + 1; hStartR = (op.ri || 0) + 1; first = false; }
          lines.push('-' + op.left); lines.push('+' + op.right); hLnL++; hLnR++;
        }
      }
      patch += '@@ -' + hStartL + ',' + hLnL + ' +' + hStartR + ',' + hLnR + ' @@\n';
      patch += lines.join('\n') + '\n';
    }
  }

  navigator.clipboard.writeText(patch).then(() => showToast('Unified patch copied to clipboard'));
}

function loadSample() {
  leftInput.value = 'function greet(name) {\n  console.log("Hello, " + name);\n  return true;\n}\n\nconst users = ["Alice", "Bob", "Charlie"];\n\nfor (let i = 0; i < users.length; i++) {\n  greet(users[i]);\n}\n\n// End of script';
  rightInput.value = 'function greet(name, greeting) {\n  const message = `${greeting}, ${name}!`;\n  console.log(message);\n  return message;\n}\n\nconst users = ["Alice", "Bob", "Charlie", "Diana"];\n\nfor (const user of users) {\n  greet(user, "Welcome");\n}\n\nconsole.log("Done!");\n// End of script';
  updateCount(leftInput, leftCount);
  updateCount(rightInput, rightCount);
  runDiff();
}

function clearAll() {
  leftInput.value = '';
  rightInput.value = '';
  leftCount.textContent = '';
  rightCount.textContent = '';
  diffLeft.innerHTML = '';
  diffRight.innerHTML = '';
  outputPanel.style.display = 'none';
  statsBar.style.display = 'none';
  lastDiffResult = null;
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2000);
}

/* Tab key support */
[leftInput, rightInput].forEach(el => {
  el.addEventListener('keydown', e => {
    if (e.key === 'Tab') {
      e.preventDefault();
      const start = el.selectionStart, end = el.selectionEnd;
      el.value = el.value.substring(0, start) + '  ' + el.value.substring(end);
      el.selectionStart = el.selectionEnd = start + 2;
    }
  });
});

/* Ctrl+Enter to compare */
document.addEventListener('keydown', e => {
  if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') runDiff();
});

/* IntersectionObserver fade-in */
const observer = new IntersectionObserver(entries => {
  entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('visible'); observer.unobserve(entry.target); }});
}, { threshold: 0.1 });
document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));
</script>
<script src="/js/analytics-lite.js" defer></script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What is a text diff tool?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "A text diff tool compares two pieces of text and highlights the differences between them. It shows which lines were added, removed, or modified, making it easy to review changes between document versions or code revisions."
      }
    },
    {
      "@type": "Question",
      "name": "Is this text diff tool free?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, NexTool's Text Diff Tool is completely free with no signup required. It runs 100% in your browser so your data never leaves your device."
      }
    },
    {
      "@type": "Question",
      "name": "What is the difference between character-level and word-level diff?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Character-level diff highlights individual character changes within modified lines for maximum precision. Word-level diff highlights whole words that changed, which is often easier to read for prose and documentation. Line-level diff simply marks entire lines as added or removed without inline highlighting."
      }
    },
    {
      "@type": "Question",
      "name": "Can I export the diff as a patch file?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, click the Copy Patch button to copy the diff in unified patch format to your clipboard. This format is compatible with git apply and standard patch tools."
      }
    }
  ]
}
</script>
</body>
</html>

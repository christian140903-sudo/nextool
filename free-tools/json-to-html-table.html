<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JSON to HTML Table Converter — Free Online Tool | NexTool</title>
<meta name="description" content="Convert JSON arrays to styled HTML tables instantly. Live preview, dark/striped themes, nested object support, CSV export. Free browser-based tool, no signup.">
<meta name="keywords" content="JSON to HTML table, JSON table converter, JSON to table, convert JSON array, HTML table generator, free online tool, NexTool">
<meta name="robots" content="index, follow">
<meta property="og:title" content="JSON to HTML Table Converter — Free Online Tool | NexTool">
<meta property="og:description" content="Convert JSON arrays to styled HTML tables instantly. Live preview, CSV export, multiple themes. 100% free.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/json-to-html-table.html">
<meta property="og:image" content="https://nextool.app/assets/og-default.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<link rel="canonical" href="https://nextool.app/free-tools/json-to-html-table.html">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="JSON to HTML Table Converter — Free Online Tool | NexTool">
<meta name="twitter:description" content="Convert JSON arrays to styled HTML tables instantly. Free online tool by NexTool.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"NexTool JSON to HTML Table Converter","applicationCategory":"DeveloperApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"description":"Free online JSON to HTML table converter with live preview, themes, nested object support, and CSV export."}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--border:#2a2a3a;--text:#e4e4eb;--text2:#9494a8;--primary:#6366f1;--accent:#a855f7;--pink:#ec4899;--green:#22c55e;--red:#ef4444;--cyan:#22d3ee;--yellow:#eab308;--radius:12px;--glass:rgba(17,17,24,0.7)}
html{scroll-behavior:smooth}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
.nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{font-size:1.4rem;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-decoration:none}
.nav-links{display:flex;align-items:center;gap:1.5rem}
.nav-links a{color:var(--text2);text-decoration:none;font-size:.875rem;font-weight:500;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-cta{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff!important;padding:.5rem 1.2rem;border-radius:8px;font-weight:600;-webkit-text-fill-color:#fff!important}
.nav-cta:hover{opacity:.9}
.nav-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}
.hero{text-align:center;padding:3rem 1.5rem 2rem;max-width:700px;margin:0 auto}
.hero h1{font-size:2.2rem;font-weight:800;line-height:1.2;margin-bottom:.75rem}
.hero h1 span{background:linear-gradient(135deg,var(--primary),var(--accent),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--text2);font-size:1rem}
.tool-container{max-width:1200px;margin:0 auto;padding:0 1.5rem 3rem}
.toolbar{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem;align-items:center}
.toolbar button,.toolbar select,.toolbar label{background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.45rem .9rem;border-radius:8px;font-size:.8rem;font-weight:500;cursor:pointer;transition:all .2s;font-family:inherit}
.toolbar button:hover{border-color:var(--primary);background:rgba(99,102,241,.12)}
.toolbar button.active{background:linear-gradient(135deg,var(--primary),var(--accent));border-color:transparent;color:#fff}
.toolbar select{appearance:none;padding-right:1.8rem;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%239494a8' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .6rem center}
.toolbar label{display:flex;align-items:center;gap:.4rem;cursor:pointer}
.toolbar label input[type=checkbox]{accent-color:var(--primary)}
.status-bar{display:flex;align-items:center;gap:1rem;margin-bottom:1rem;font-size:.8rem;color:var(--text2)}
.status-dot{width:8px;height:8px;border-radius:50%;display:inline-block}
.status-dot.valid{background:var(--green)}
.status-dot.invalid{background:var(--red)}
.status-dot.empty{background:var(--border)}
.panels{display:grid;grid-template-columns:1fr 1fr;gap:1rem;min-height:500px}
.panel{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;display:flex;flex-direction:column}
.panel-header{padding:.6rem 1rem;border-bottom:1px solid var(--border);font-size:.8rem;font-weight:600;color:var(--text2);display:flex;justify-content:space-between;align-items:center;background:rgba(26,26,36,0.5)}
.panel-body{flex:1;position:relative;overflow:auto}
#jsonInput{width:100%;height:100%;min-height:400px;background:transparent;border:none;color:var(--text);font-family:'Courier New',monospace;font-size:.85rem;padding:1rem;resize:none;outline:none;line-height:1.7;tab-size:2}
#jsonInput::placeholder{color:var(--text2);opacity:.5}
.preview-area{padding:1rem;overflow:auto;min-height:400px}
.code-area{padding:1rem;font-family:'Courier New',monospace;font-size:.8rem;line-height:1.6;white-space:pre-wrap;word-break:break-all;color:var(--text);min-height:400px;overflow:auto}
.error-display{padding:1rem;color:var(--red);font-size:.85rem;font-family:'Courier New',monospace;white-space:pre-wrap}
/* Table styles for preview */
.preview-area table{width:100%;border-collapse:collapse;font-size:.85rem;color:var(--text)}
.preview-area th{background:rgba(99,102,241,.15);color:var(--primary);padding:.6rem .8rem;text-align:left;font-weight:600;font-size:.8rem;text-transform:uppercase;letter-spacing:.3px;border-bottom:2px solid var(--border);position:sticky;top:0}
.preview-area td{padding:.5rem .8rem;border-bottom:1px solid var(--border);vertical-align:top}
.preview-area tr:hover td{background:rgba(99,102,241,.05)}
/* Theme: Striped */
.preview-area.striped tr:nth-child(even) td{background:rgba(99,102,241,.04)}
/* Theme: Bordered */
.preview-area.bordered td,.preview-area.bordered th{border:1px solid var(--border)}
/* Theme: Minimal */
.preview-area.minimal th{background:transparent;border-bottom:2px solid var(--primary);color:var(--text)}
.preview-area.minimal td{border-bottom:1px solid rgba(255,255,255,.05)}
/* Nested toggle */
.nested-toggle{cursor:pointer;color:var(--primary);font-size:.75rem;user-select:none;display:inline-flex;align-items:center;gap:.25rem}
.nested-toggle::before{content:'';display:inline-block;width:0;height:0;border-left:5px solid currentColor;border-top:4px solid transparent;border-bottom:4px solid transparent;transition:transform .15s}
.nested-toggle.open::before{transform:rotate(90deg)}
.nested-content{margin-top:.3rem;padding-left:.5rem;border-left:2px solid var(--border);font-size:.8rem}
.nested-content.collapsed{display:none}
/* Tab switcher */
.tab-bar{display:flex;gap:0;border-bottom:1px solid var(--border)}
.tab-btn{background:none;border:none;color:var(--text2);padding:.5rem 1rem;font-size:.8rem;font-weight:500;cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;font-family:inherit}
.tab-btn.active{color:var(--primary);border-bottom-color:var(--primary)}
.tab-btn:hover{color:var(--text)}
.cta-section{text-align:center;padding:4rem 1.5rem;max-width:700px;margin:0 auto}
.cta-section h2{font-size:1.8rem;font-weight:800;margin-bottom:.75rem}
.cta-section h2 span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.cta-section p{color:var(--text2);margin-bottom:1.5rem}
.cta-btn{display:inline-block;background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;padding:.75rem 2rem;border-radius:10px;font-weight:700;text-decoration:none;font-size:1rem;transition:transform .2s,box-shadow .2s}
.cta-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(99,102,241,.3)}
.footer{border-top:1px solid var(--border);padding:3rem 2rem 2rem;max-width:1200px;margin:0 auto}
.footer-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:2rem;margin-bottom:2rem}
.footer-col h4{font-size:.85rem;font-weight:700;margin-bottom:.75rem;color:var(--text)}
.footer-col a{display:block;color:var(--text2);text-decoration:none;font-size:.8rem;margin-bottom:.4rem;transition:color .2s}
.footer-col a:hover{color:var(--primary)}
.footer-bottom{text-align:center;color:var(--text2);font-size:.75rem;padding-top:1.5rem;border-top:1px solid var(--border)}
.fade-in{opacity:0;transform:translateY(20px);transition:opacity .6s,transform .6s}
.fade-in.visible{opacity:1;transform:translateY(0)}
.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.6rem 1.2rem;border-radius:10px;font-size:.85rem;font-weight:500;z-index:200;transition:transform .3s;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0)}
@media(max-width:768px){
  .panels{grid-template-columns:1fr}
  .nav-links{display:none;position:absolute;top:64px;left:0;right:0;background:var(--bg);border-bottom:1px solid var(--border);flex-direction:column;padding:1rem 2rem;gap:1rem}
  .nav-links.open{display:flex}
  .nav-toggle{display:block}
  .hero h1{font-size:1.6rem}
  .footer-grid{grid-template-columns:1fr}
  .toolbar{gap:.35rem}
}
</style>
</head>
<body>

<nav class="nav">
  <a href="/" class="nav-logo">NexTool</a>
  <button class="nav-toggle" onclick="document.querySelector('.nav-links').classList.toggle('open')" aria-label="Menu">&#9776;</button>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Tools</a>
    <a href="/free-tools/">Free Tools</a>
    <a href="/blog/">Blog</a>
    <a href="/pro.html" class="nav-cta">Get Pro — $29</a>
  </div>
</nav>

<section class="hero fade-in">
  <h1>Free <span>JSON to HTML Table</span> Converter</h1>
  <p style="color:#94a3b8;font-size:15px;line-height:1.6;margin-bottom:24px;max-width:700px;margin-left:auto;margin-right:auto;">Paste a JSON array of objects and instantly generate a styled HTML table. Live preview with multiple themes, nested object support, copy HTML or export as CSV. No signup required.</p>
</section>

<div class="tool-container fade-in">
  <div class="toolbar">
    <button onclick="convertJSON()" title="Convert to table">Convert</button>
    <button onclick="copyHTML()" title="Copy HTML code">Copy HTML</button>
    <button onclick="downloadHTML()" title="Download HTML file">Download HTML</button>
    <button onclick="exportCSV()" title="Export as CSV">Export CSV</button>
    <select id="themeSelect" onchange="updateTheme()">
      <option value="default">Default Theme</option>
      <option value="striped">Striped Rows</option>
      <option value="bordered">Bordered</option>
      <option value="minimal">Minimal</option>
    </select>
    <label title="Include inline styles in output"><input type="checkbox" id="inlineStyles" checked> Inline Styles</label>
    <button onclick="clearAll()" title="Clear everything">Clear</button>
    <button onclick="loadSample()" title="Load sample JSON">Sample</button>
  </div>

  <div class="status-bar">
    <span><span class="status-dot empty" id="statusDot"></span></span>
    <span id="statusText">Paste a JSON array to begin</span>
    <span id="sizeInfo" style="margin-left:auto"></span>
  </div>

  <div class="panels">
    <div class="panel">
      <div class="panel-header"><span>JSON Input</span><span id="rowCount"></span></div>
      <div class="panel-body">
        <textarea id="jsonInput" placeholder='Paste a JSON array of objects...&#10;&#10;Example:&#10;[&#10;  { "name": "Alice", "age": 30 },&#10;  { "name": "Bob", "age": 25 }&#10;]' spellcheck="false"></textarea>
      </div>
    </div>
    <div class="panel">
      <div class="panel-header">
        <div class="tab-bar">
          <button class="tab-btn active" data-tab="preview" onclick="switchTab('preview')">Preview</button>
          <button class="tab-btn" data-tab="code" onclick="switchTab('code')">HTML Code</button>
        </div>
        <span id="colInfo"></span>
      </div>
      <div class="panel-body">
        <div class="preview-area" id="previewOutput"></div>
        <div class="code-area" id="codeOutput" style="display:none"></div>
        <div class="error-display" id="errorOutput" style="display:none"></div>
      </div>
    </div>
  </div>
</div>

<section class="cta-section fade-in">
  <h2>Need something <span>more powerful</span>?</h2>
  <p>Let us build it for you. Custom APIs, dashboards, automations &mdash; whatever you need.</p>
  <a href="/#contact" class="cta-btn">Start a Project &rarr;</a>
</section>

<section style="max-width:900px;margin:40px auto;padding:0 24px;">
<div style="background:linear-gradient(135deg,rgba(99,102,241,0.1),rgba(168,85,247,0.08));border:1px solid rgba(99,102,241,0.15);border-radius:20px;padding:32px 28px;text-align:center;">
<div style="font-size:13px;color:#818cf8;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Founding Member</div>
<h3 style="font-size:22px;font-weight:800;color:#fff;margin:0 0 8px;">Get NexTool Pro</h3>
<p style="color:#94a3b8;font-size:14px;margin:0 auto 20px;max-width:500px;">No banners, clean output, enhanced features on all 250+ tools. One-time payment.</p>
<div style="display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;">
<a href="/pro.html" style="display:inline-block;padding:12px 28px;background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);color:#fff;border-radius:10px;font-weight:700;font-size:15px;text-decoration:none;">$29 — Get Pro</a>
<a href="/free-tools/" style="color:#94a3b8;font-size:14px;text-decoration:none;">Browse 250+ Free Tools &rarr;</a>
</div>
</div>
</section>

<footer class="footer fade-in">
  <div class="footer-grid">
    <div class="footer-col">
      <h4>Products</h4>
      <a href="/free-tools/">250+ Free Tools</a>
<a href="/pro.html">NexTool Pro</a>
<a href="/workspace.html">Workspace</a>
    </div>
    <div class="footer-col">
      <h4>Explore</h4>
      <a href="/free-tools/">Free Tools</a><a href="/blog/">Blog</a><a href="/pro.html">FAQ</a><a href="/pro.html">Pro — $29</a>
    </div>
    <div class="footer-col">
      <h4>Ecosystem</h4>
      <a href="/">NexTool Home</a><a href="/#contact">Contact</a><a href="https://github.com/christian140903-sudo/nextool" target="_blank">GitHub</a>
    </div>
  </div>
  <div class="footer-bottom">&copy; 2026 NexTool. AI-powered tools for everyone.</div>
</footer>

<div class="toast" id="toast"></div>

<script>
const input = document.getElementById('jsonInput');
const previewOutput = document.getElementById('previewOutput');
const codeOutput = document.getElementById('codeOutput');
const errorOutput = document.getElementById('errorOutput');
const statusDot = document.getElementById('statusDot');
const statusText = document.getElementById('statusText');
const sizeInfo = document.getElementById('sizeInfo');
const rowCount = document.getElementById('rowCount');
const colInfo = document.getElementById('colInfo');
let lastParsed = null;
let lastHTML = '';
let lastCSV = '';
let currentTab = 'preview';

input.addEventListener('input', debounce(autoProcess, 400));

function debounce(fn, ms) { let t; return (...a) => { clearTimeout(t); t = setTimeout(() => fn(...a), ms); }; }

function autoProcess() {
  const raw = input.value.trim();
  if (!raw) {
    clearOutputs();
    statusDot.className = 'status-dot empty';
    statusText.textContent = 'Paste a JSON array to begin';
    sizeInfo.textContent = '';
    rowCount.textContent = '';
    colInfo.textContent = '';
    return;
  }
  sizeInfo.textContent = formatBytes(new Blob([raw]).size);
  convertJSON();
}

function convertJSON() {
  const raw = input.value.trim();
  if (!raw) return;
  try {
    let data = JSON.parse(raw);
    // Wrap single object in array
    if (data && typeof data === 'object' && !Array.isArray(data)) {
      data = [data];
    }
    if (!Array.isArray(data)) {
      throw new Error('Input must be a JSON array of objects');
    }
    if (data.length === 0) {
      throw new Error('Array is empty');
    }
    // Collect all keys across all objects
    const allKeys = [];
    const keySet = new Set();
    data.forEach(item => {
      if (item && typeof item === 'object' && !Array.isArray(item)) {
        Object.keys(item).forEach(k => {
          if (!keySet.has(k)) { keySet.add(k); allKeys.push(k); }
        });
      }
    });
    if (allKeys.length === 0) {
      throw new Error('No valid objects found in array');
    }
    lastParsed = { data, keys: allKeys };
    rowCount.textContent = data.length + ' row' + (data.length !== 1 ? 's' : '');
    colInfo.textContent = allKeys.length + ' column' + (allKeys.length !== 1 ? 's' : '');
    statusDot.className = 'status-dot valid';
    statusText.textContent = 'Valid JSON — ' + data.length + ' rows, ' + allKeys.length + ' columns';
    renderTable();
  } catch (e) {
    statusDot.className = 'status-dot invalid';
    statusText.textContent = 'Error: ' + e.message;
    errorOutput.textContent = e.message;
    showPanel('error');
    lastParsed = null;
    lastHTML = '';
    lastCSV = '';
    rowCount.textContent = '';
    colInfo.textContent = '';
  }
}

function renderTable() {
  if (!lastParsed) return;
  const { data, keys } = lastParsed;
  const theme = document.getElementById('themeSelect').value;
  const useInline = document.getElementById('inlineStyles').checked;

  // Build preview HTML
  let previewHTML = '<table>';
  previewHTML += '<thead><tr>';
  keys.forEach(k => { previewHTML += '<th>' + escapeHtml(k) + '</th>'; });
  previewHTML += '</tr></thead><tbody>';
  data.forEach(row => {
    previewHTML += '<tr>';
    keys.forEach(k => {
      const val = row !== null && row !== undefined ? row[k] : undefined;
      previewHTML += '<td>' + renderCell(val) + '</td>';
    });
    previewHTML += '</tr>';
  });
  previewHTML += '</tbody></table>';

  previewOutput.className = 'preview-area' + (theme !== 'default' ? ' ' + theme : '');
  previewOutput.innerHTML = previewHTML;

  // Bind nested toggles
  previewOutput.querySelectorAll('.nested-toggle').forEach(toggle => {
    toggle.addEventListener('click', function() {
      this.classList.toggle('open');
      const content = this.nextElementSibling;
      if (content) content.classList.toggle('collapsed');
    });
  });

  // Build exportable HTML
  lastHTML = buildExportHTML(data, keys, theme, useInline);

  // Build CSV
  lastCSV = buildCSV(data, keys);

  // Update code view
  codeOutput.textContent = lastHTML;

  showPanel(currentTab === 'code' ? 'code' : 'preview');
}

function renderCell(val) {
  if (val === undefined || val === null) return '<span style="color:#6b7280">null</span>';
  if (typeof val === 'boolean') return '<span style="color:#eab308">' + val + '</span>';
  if (typeof val === 'number') return '<span style="color:#22d3ee">' + val + '</span>';
  if (typeof val === 'string') return escapeHtml(val);
  if (Array.isArray(val)) {
    if (val.length === 0) return '<span style="color:#6b7280">[]</span>';
    // Check if array of primitives
    const allPrimitive = val.every(v => v === null || typeof v !== 'object');
    if (allPrimitive) return escapeHtml(val.join(', '));
    let html = '<span class="nested-toggle open">[' + val.length + ' items]</span>';
    html += '<div class="nested-content">';
    val.forEach((item, i) => {
      html += '<div style="margin:.2rem 0"><strong style="color:#94a3b8">[' + i + ']</strong> ' + renderCell(item) + '</div>';
    });
    html += '</div>';
    return html;
  }
  if (typeof val === 'object') {
    const entries = Object.entries(val);
    if (entries.length === 0) return '<span style="color:#6b7280">{}</span>';
    let html = '<span class="nested-toggle open">{' + entries.length + ' fields}</span>';
    html += '<div class="nested-content">';
    entries.forEach(([k, v]) => {
      html += '<div style="margin:.2rem 0"><strong style="color:#c084fc">' + escapeHtml(k) + ':</strong> ' + renderCell(v) + '</div>';
    });
    html += '</div>';
    return html;
  }
  return escapeHtml(String(val));
}

function buildExportHTML(data, keys, theme, useInline) {
  let styles = '';
  if (useInline) {
    const thBase = 'padding:10px 14px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;letter-spacing:0.3px;';
    const tdBase = 'padding:8px 14px;vertical-align:top;';
    let thStyle, tdStyle, trEven = '';
    switch (theme) {
      case 'striped':
        thStyle = thBase + 'background:#6366f1;color:#fff;border-bottom:2px solid #4f46e5;';
        tdStyle = tdBase + 'border-bottom:1px solid #e5e7eb;';
        break;
      case 'bordered':
        thStyle = thBase + 'background:#f8fafc;color:#1e293b;border:1px solid #cbd5e1;';
        tdStyle = tdBase + 'border:1px solid #cbd5e1;';
        break;
      case 'minimal':
        thStyle = thBase + 'background:transparent;color:#1e293b;border-bottom:2px solid #6366f1;';
        tdStyle = tdBase + 'border-bottom:1px solid #f1f5f9;';
        break;
      default:
        thStyle = thBase + 'background:#f1f5f9;color:#334155;border-bottom:2px solid #e2e8f0;';
        tdStyle = tdBase + 'border-bottom:1px solid #e5e7eb;';
    }
    let html = '<table style="width:100%;border-collapse:collapse;font-family:Inter,system-ui,sans-serif;font-size:14px;color:#1e293b;">\n';
    html += '  <thead>\n    <tr>\n';
    keys.forEach(k => { html += '      <th style="' + thStyle + '">' + escapeHtml(k) + '</th>\n'; });
    html += '    </tr>\n  </thead>\n  <tbody>\n';
    data.forEach((row, idx) => {
      let rowStyle = '';
      if (theme === 'striped' && idx % 2 === 1) rowStyle = ' style="background:#f8fafc;"';
      html += '    <tr' + rowStyle + '>\n';
      keys.forEach(k => {
        const val = row !== null && row !== undefined ? row[k] : null;
        html += '      <td style="' + tdStyle + '">' + flattenValue(val) + '</td>\n';
      });
      html += '    </tr>\n';
    });
    html += '  </tbody>\n</table>';
    return html;
  } else {
    let html = '<table class="json-table">\n  <thead>\n    <tr>\n';
    keys.forEach(k => { html += '      <th>' + escapeHtml(k) + '</th>\n'; });
    html += '    </tr>\n  </thead>\n  <tbody>\n';
    data.forEach(row => {
      html += '    <tr>\n';
      keys.forEach(k => {
        const val = row !== null && row !== undefined ? row[k] : null;
        html += '      <td>' + flattenValue(val) + '</td>\n';
      });
      html += '    </tr>\n';
    });
    html += '  </tbody>\n</table>';
    return html;
  }
}

function flattenValue(val) {
  if (val === undefined || val === null) return '';
  if (typeof val === 'object') return escapeHtml(JSON.stringify(val));
  return escapeHtml(String(val));
}

function buildCSV(data, keys) {
  const escape = v => {
    if (v === null || v === undefined) return '';
    let s = typeof v === 'object' ? JSON.stringify(v) : String(v);
    if (s.includes(',') || s.includes('"') || s.includes('\n')) {
      s = '"' + s.replace(/"/g, '""') + '"';
    }
    return s;
  };
  let csv = keys.map(k => escape(k)).join(',') + '\n';
  data.forEach(row => {
    csv += keys.map(k => escape(row ? row[k] : null)).join(',') + '\n';
  });
  return csv;
}

function updateTheme() { renderTable(); }

function switchTab(tab) {
  currentTab = tab;
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.toggle('active', b.dataset.tab === tab));
  if (tab === 'preview') {
    previewOutput.style.display = '';
    codeOutput.style.display = 'none';
    errorOutput.style.display = 'none';
  } else {
    previewOutput.style.display = 'none';
    codeOutput.style.display = '';
    errorOutput.style.display = 'none';
  }
}

function showPanel(which) {
  previewOutput.style.display = which === 'preview' ? '' : 'none';
  codeOutput.style.display = which === 'code' ? '' : 'none';
  errorOutput.style.display = which === 'error' ? '' : 'none';
}

function clearOutputs() {
  previewOutput.innerHTML = '';
  codeOutput.textContent = '';
  errorOutput.textContent = '';
  lastHTML = '';
  lastCSV = '';
  lastParsed = null;
}

function clearAll() {
  input.value = '';
  clearOutputs();
  statusDot.className = 'status-dot empty';
  statusText.textContent = 'Paste a JSON array to begin';
  sizeInfo.textContent = '';
  rowCount.textContent = '';
  colInfo.textContent = '';
}

function copyHTML() {
  if (!lastHTML) { showToast('Nothing to copy'); return; }
  navigator.clipboard.writeText(lastHTML).then(() => showToast('HTML copied to clipboard'));
}

function downloadHTML() {
  if (!lastHTML) { showToast('No table to download'); return; }
  const fullHTML = '<!DOCTYPE html>\n<html lang="en">\n<head>\n<meta charset="UTF-8">\n<meta name="viewport" content="width=device-width, initial-scale=1.0">\n<title>JSON Table</title>\n</head>\n<body>\n' + lastHTML + '\n</body>\n</html>';
  const blob = new Blob([fullHTML], { type: 'text/html' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'json-table.html';
  a.click();
  URL.revokeObjectURL(a.href);
  showToast('Downloaded json-table.html');
}

function exportCSV() {
  if (!lastCSV) { showToast('No data to export'); return; }
  const blob = new Blob([lastCSV], { type: 'text/csv' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'json-data.csv';
  a.click();
  URL.revokeObjectURL(a.href);
  showToast('Downloaded json-data.csv');
}

function loadSample() {
  input.value = JSON.stringify([
    { "id": 1, "name": "Alice Johnson", "email": "alice@example.com", "age": 28, "role": "Developer", "skills": ["JavaScript", "React", "Node.js"], "active": true },
    { "id": 2, "name": "Bob Smith", "email": "bob@example.com", "age": 34, "role": "Designer", "skills": ["Figma", "CSS"], "active": true },
    { "id": 3, "name": "Charlie Brown", "email": "charlie@example.com", "age": 22, "role": "Intern", "skills": ["Python"], "active": false },
    { "id": 4, "name": "Diana Prince", "email": "diana@example.com", "age": 31, "role": "Manager", "skills": ["Leadership", "Agile", "Scrum"], "active": true },
    { "id": 5, "name": "Eve Wilson", "email": "eve@example.com", "age": 26, "role": "Developer", "skills": ["Go", "Docker", "Kubernetes"], "active": true }
  ], null, 2);
  autoProcess();
}

function escapeHtml(s) { return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

function formatBytes(bytes) {
  if (bytes === 0) return '0 B';
  const k = 1024, sizes = ['B', 'KB', 'MB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2000);
}

input.addEventListener('keydown', e => {
  if (e.key === 'Tab') {
    e.preventDefault();
    const start = input.selectionStart, end = input.selectionEnd;
    input.value = input.value.substring(0, start) + '  ' + input.value.substring(end);
    input.selectionStart = input.selectionEnd = start + 2;
  }
});

const observer = new IntersectionObserver(entries => {
  entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('visible'); observer.unobserve(entry.target); }});
}, { threshold: 0.1 });
document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));
</script>
<script src="/js/analytics-lite.js" defer></script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "How do I convert JSON to an HTML table?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Paste a JSON array of objects into the input area. Each object becomes a table row, and keys become column headers. The tool converts it to a styled HTML table instantly with live preview."
      }
    },
    {
      "@type": "Question",
      "name": "Does this tool handle nested JSON objects?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes. Nested objects and arrays are rendered as collapsible sections in the preview. In the HTML export, they are serialized as JSON strings for compatibility."
      }
    },
    {
      "@type": "Question",
      "name": "Can I export the table as CSV?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes. Click the Export CSV button to download your JSON data as a CSV file. Nested values are serialized as JSON strings in the CSV output."
      }
    }
  ]
}
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Excel to PDF Converter Online — Convert XLSX to PDF | NexTool</title>
<meta name="description" content="Convert Excel XLSX, XLS, and CSV files to PDF instantly in your browser. Preview spreadsheet data, select sheets, customize layout. 100% free, no upload required.">
<meta name="keywords" content="excel to pdf, xlsx to pdf, csv to pdf, convert excel to pdf, excel to pdf converter free, spreadsheet to pdf, NexTool">
<meta name="robots" content="index, follow">
<meta property="og:title" content="Free Excel to PDF Converter Online — Convert XLSX to PDF | NexTool">
<meta property="og:description" content="Convert Excel XLSX, XLS, CSV files to PDF instantly. Preview data, select sheets, customize layout. 100% client-side, no upload needed.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/excel-to-pdf.html">
<meta property="og:image" content="https://nextool.app/assets/og-default.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<link rel="canonical" href="https://nextool.app/free-tools/excel-to-pdf.html">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free Excel to PDF Converter Online — Convert XLSX to PDF | NexTool">
<meta name="twitter:description" content="Convert Excel spreadsheets to PDF instantly. Free online tool by NexTool.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"NexTool Excel to PDF Converter","applicationCategory":"UtilitiesApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"description":"Free online tool to convert Excel XLSX, XLS, and CSV files to PDF. Preview data, select sheets, customize page size and orientation. Runs 100% in your browser."}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--border:#2a2a3a;--text:#e4e4eb;--text2:#9494a8;--primary:#6366f1;--accent:#a855f7;--pink:#ec4899;--green:#22c55e;--red:#ef4444;--cyan:#22d3ee;--yellow:#eab308;--radius:12px;--glass:rgba(17,17,24,0.7)}
html{scroll-behavior:smooth}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
/* NAV */
.nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{font-size:1.4rem;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-decoration:none}
.nav-links{display:flex;align-items:center;gap:1.5rem}
.nav-links a{color:var(--text2);text-decoration:none;font-size:.875rem;font-weight:500;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-cta{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff!important;padding:.5rem 1.2rem;border-radius:8px;font-weight:600;-webkit-text-fill-color:#fff!important}
.nav-cta:hover{opacity:.9}
.nav-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}
/* HERO */
.hero{text-align:center;padding:3rem 1.5rem 2rem;max-width:700px;margin:0 auto}
.hero h1{font-size:2.2rem;font-weight:800;line-height:1.2;margin-bottom:.75rem}
.hero h1 span{background:linear-gradient(135deg,var(--primary),var(--accent),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--text2);font-size:1rem}
/* TOOL */
.tool-container{max-width:960px;margin:0 auto;padding:0 1.5rem 3rem}
/* DROP ZONE */
.drop-zone{border:2px dashed var(--border);border-radius:var(--radius);padding:3rem 2rem;text-align:center;cursor:pointer;transition:all .3s;background:var(--glass);backdrop-filter:blur(16px);position:relative}
.drop-zone:hover,.drop-zone.dragover{border-color:var(--primary);background:rgba(99,102,241,.06)}
.drop-zone-icon{font-size:3rem;margin-bottom:.75rem;opacity:.6}
.drop-zone h3{font-size:1.1rem;font-weight:700;margin-bottom:.4rem;color:var(--text)}
.drop-zone p{font-size:.85rem;color:var(--text2)}
.drop-zone input{position:absolute;inset:0;opacity:0;cursor:pointer}
/* FILE INFO */
.file-info-bar{margin-top:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:.75rem 1rem;display:none;align-items:center;gap:.75rem}
.file-info-bar.visible{display:flex}
.file-icon{width:36px;height:36px;border-radius:8px;background:rgba(34,197,94,.12);display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:.75rem;font-weight:700;color:var(--green)}
.file-details{flex:1;min-width:0}
.file-name{font-size:.85rem;font-weight:600;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.file-meta{font-size:.75rem;color:var(--text2);margin-top:2px}
.file-remove{background:none;border:none;color:var(--text2);font-size:1.1rem;cursor:pointer;padding:4px 8px;border-radius:6px;transition:all .2s}
.file-remove:hover{color:var(--red);background:rgba(239,68,68,.1)}
/* SHEET SELECTOR */
.sheet-selector{margin-top:1rem;display:none}
.sheet-selector.visible{display:block}
.sheet-selector-title{font-size:.85rem;font-weight:700;margin-bottom:.5rem;color:var(--text)}
.sheet-chips{display:flex;flex-wrap:wrap;gap:.5rem}
.sheet-chip{background:var(--surface2);border:1px solid var(--border);color:var(--text2);padding:.35rem .8rem;border-radius:8px;font-size:.8rem;font-weight:500;cursor:pointer;transition:all .2s;font-family:inherit;user-select:none}
.sheet-chip:hover{border-color:var(--primary);color:var(--text)}
.sheet-chip.active{background:linear-gradient(135deg,var(--primary),var(--accent));border-color:transparent;color:#fff}
/* SETTINGS */
.settings-panel{margin-top:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:1.25rem;display:none}
.settings-panel.visible{display:block}
.settings-title{font-size:.85rem;font-weight:700;margin-bottom:.75rem;color:var(--text)}
.settings-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1rem}
.setting-group label{display:block;font-size:.75rem;font-weight:600;color:var(--text2);margin-bottom:.35rem}
.setting-group select,.setting-group input[type="range"]{width:100%;background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.45rem .7rem;border-radius:8px;font-size:.8rem;font-family:inherit;outline:none;transition:border-color .2s}
.setting-group select:focus{border-color:var(--primary)}
.font-size-display{display:inline-block;margin-left:.5rem;font-size:.8rem;font-weight:600;color:var(--primary)}
input[type="range"]{-webkit-appearance:none;height:6px;background:var(--surface2);border:none;border-radius:3px;padding:0;cursor:pointer}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:var(--primary);cursor:pointer;border:2px solid var(--bg)}
input[type="range"]::-moz-range-thumb{width:18px;height:18px;border-radius:50%;background:var(--primary);cursor:pointer;border:2px solid var(--bg)}
/* CONTROLS */
.controls{margin-top:1.5rem;display:none;flex-wrap:wrap;gap:.75rem;align-items:center}
.controls.visible{display:flex}
.controls button{background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.55rem 1.2rem;border-radius:8px;font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s;font-family:inherit}
.controls button:hover{border-color:var(--primary);background:rgba(99,102,241,.12)}
.controls button:disabled{opacity:.4;cursor:not-allowed;border-color:var(--border);background:var(--surface2)}
.convert-btn{background:linear-gradient(135deg,var(--primary),var(--accent))!important;border:none!important;color:#fff!important;padding:.6rem 2rem!important;font-size:.9rem!important}
.convert-btn:hover:not(:disabled){opacity:.9;transform:translateY(-1px);box-shadow:0 6px 24px rgba(99,102,241,.3)}
.convert-btn:disabled{opacity:.4!important;transform:none!important;box-shadow:none!important}
/* PROGRESS */
.progress-wrap{margin-top:1rem;display:none}
.progress-wrap.active{display:block}
.progress-bar{width:100%;height:6px;background:var(--surface2);border-radius:3px;overflow:hidden}
.progress-fill{height:100%;width:0%;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:3px;transition:width .3s}
.progress-text{font-size:.75rem;color:var(--text2);margin-top:.4rem;text-align:center}
/* PREVIEW */
.preview-section{margin-top:2rem;display:none}
.preview-section.visible{display:block}
.preview-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem;flex-wrap:wrap;gap:.5rem}
.preview-header h3{font-size:.95rem;font-weight:700}
.preview-tabs{display:flex;gap:.5rem;margin-bottom:.75rem;flex-wrap:wrap}
.preview-tab{background:var(--surface2);border:1px solid var(--border);color:var(--text2);padding:.4rem 1rem;border-radius:8px;font-size:.8rem;font-weight:600;cursor:pointer;transition:all .2s;font-family:inherit}
.preview-tab:hover{border-color:var(--primary);color:var(--text)}
.preview-tab.active{background:linear-gradient(135deg,var(--primary),var(--accent));border-color:transparent;color:#fff}
.preview-container{background:#fff;border-radius:var(--radius);overflow:hidden;border:1px solid var(--border);max-height:500px;overflow-y:auto;overflow-x:auto}
.preview-table{width:100%;border-collapse:collapse;font-size:13px;color:#1a1a2e;font-family:'Inter',sans-serif}
.preview-table th{background:#f0f0f5;font-weight:600;padding:8px 12px;text-align:left;border:1px solid #ddd;position:sticky;top:0;font-size:12px;color:#444;white-space:nowrap}
.preview-table td{padding:6px 12px;border:1px solid #eee;white-space:nowrap;max-width:300px;overflow:hidden;text-overflow:ellipsis}
.preview-table tr:nth-child(even){background:#f8f8fc}
.preview-table tr:hover{background:#eef0ff}
.row-count{font-size:.75rem;color:var(--text2);margin-top:.4rem}
/* CTA */
.cta-section{text-align:center;padding:4rem 1.5rem;max-width:700px;margin:0 auto}
.cta-section h2{font-size:1.8rem;font-weight:800;margin-bottom:.75rem}
.cta-section h2 span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.cta-section p{color:var(--text2);margin-bottom:1.5rem}
.cta-btn{display:inline-block;background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;padding:.75rem 2rem;border-radius:10px;font-weight:700;text-decoration:none;font-size:1rem;transition:transform .2s,box-shadow .2s}
.cta-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(99,102,241,.3)}
/* FOOTER */
.footer{border-top:1px solid var(--border);padding:3rem 2rem 2rem;max-width:1200px;margin:0 auto}
.footer-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:2rem;margin-bottom:2rem}
.footer-col h4{font-size:.85rem;font-weight:700;margin-bottom:.75rem;color:var(--text)}
.footer-col a{display:block;color:var(--text2);text-decoration:none;font-size:.8rem;margin-bottom:.4rem;transition:color .2s}
.footer-col a:hover{color:var(--primary)}
.footer-bottom{text-align:center;color:var(--text2);font-size:.75rem;padding-top:1.5rem;border-top:1px solid var(--border)}
/* FADE IN */
.fade-in{opacity:0;transform:translateY(20px);transition:opacity .6s,transform .6s}
.fade-in.visible{opacity:1;transform:translateY(0)}
/* TOAST */
.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.6rem 1.2rem;border-radius:10px;font-size:.85rem;font-weight:500;z-index:200;transition:transform .3s;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0)}
/* RESPONSIVE */
@media(max-width:768px){
  .nav-links{display:none;position:absolute;top:64px;left:0;right:0;background:var(--bg);border-bottom:1px solid var(--border);flex-direction:column;padding:1rem 2rem;gap:1rem}
  .nav-links.open{display:flex}
  .nav-toggle{display:block}
  .hero h1{font-size:1.6rem}
  .footer-grid{grid-template-columns:1fr}
  .drop-zone{padding:2rem 1rem}
  .controls{flex-direction:column}
  .controls button{width:100%}
  .settings-grid{grid-template-columns:1fr}
  .preview-container{max-height:350px}
}
</style>
</head>
<body>

<nav class="nav">
  <a href="/" class="nav-logo">NexTool</a>
  <button class="nav-toggle" onclick="document.querySelector('.nav-links').classList.toggle('open')" aria-label="Menu">&#9776;</button>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Tools</a>
    <a href="/free-tools/">Free Tools</a>
    <a href="/blog/">Blog</a>
    <a href="/pro.html" class="nav-cta">Get Pro &mdash; $29</a>
  </div>
</nav>

<section class="hero fade-in">
  <h1>Free <span>Excel to PDF</span> Converter</h1>
  <p class="tool-summary" style="color:#94a3b8;font-size:15px;line-height:1.6;margin-bottom:24px;max-width:700px;margin-left:auto;margin-right:auto;">Convert Excel XLSX, XLS, and CSV files to clean PDF documents instantly in your browser. Preview your spreadsheet data, select which sheets to include, choose page orientation and size, and download a formatted PDF. Your files never leave your device &mdash; 100% client-side, no signup required.</p>
</section>

<div class="tool-container fade-in">
  <div class="drop-zone" id="dropZone">
    <input type="file" id="fileInput" accept=".xlsx,.xls,.csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,text/csv">
    <div class="drop-zone-icon">&#128202;</div>
    <h3>Drop Excel or CSV file here</h3>
    <p>or click to browse &mdash; supports .xlsx, .xls, .csv</p>
  </div>

  <!-- File info -->
  <div class="file-info-bar" id="fileInfoBar">
    <div class="file-icon">XLS</div>
    <div class="file-details">
      <div class="file-name" id="fileName"></div>
      <div class="file-meta" id="fileMeta"></div>
    </div>
    <button class="file-remove" onclick="clearFile()" title="Remove file">&times;</button>
  </div>

  <!-- Sheet selector -->
  <div class="sheet-selector" id="sheetSelector">
    <div class="sheet-selector-title">Select Sheets to Include</div>
    <div class="sheet-chips" id="sheetChips"></div>
  </div>

  <!-- Settings -->
  <div class="settings-panel" id="settingsPanel">
    <div class="settings-title">PDF Settings</div>
    <div class="settings-grid">
      <div class="setting-group">
        <label for="pageSize">Page Size</label>
        <select id="pageSize">
          <option value="a4" selected>A4 (210 x 297 mm)</option>
          <option value="letter">Letter (8.5 x 11 in)</option>
          <option value="legal">Legal (8.5 x 14 in)</option>
        </select>
      </div>
      <div class="setting-group">
        <label for="orientation">Orientation</label>
        <select id="orientation">
          <option value="landscape" selected>Landscape</option>
          <option value="portrait">Portrait</option>
        </select>
      </div>
      <div class="setting-group">
        <label for="fontSize">Font Size <span class="font-size-display" id="fontSizeDisplay">10pt</span></label>
        <input type="range" id="fontSize" min="8" max="14" value="10" step="1">
      </div>
    </div>
  </div>

  <!-- Controls -->
  <div class="controls" id="controls">
    <button onclick="toggleSettings()">Settings</button>
    <button onclick="clearFile()">Clear</button>
    <button class="convert-btn" id="convertBtn" onclick="convertToPdf()">Convert to PDF</button>
  </div>

  <!-- Progress -->
  <div class="progress-wrap" id="progressWrap">
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    <div class="progress-text" id="progressText">Preparing conversion...</div>
  </div>

  <!-- Preview -->
  <div class="preview-section" id="previewSection">
    <div class="preview-header">
      <h3>Data Preview</h3>
    </div>
    <div class="preview-tabs" id="previewTabs"></div>
    <div class="preview-container">
      <table class="preview-table" id="previewTable"></table>
    </div>
    <div class="row-count" id="rowCount"></div>
  </div>
</div>

<section class="cta-section fade-in">
  <h2>Need something <span>more powerful</span>?</h2>
  <p>Let us build it for you. Custom APIs, dashboards, automations &mdash; whatever you need.</p>
  <a href="/#contact" class="cta-btn">Start a Project &rarr;</a>
</section>

<!-- Cross Promo -->
<section style="max-width:900px;margin:40px auto;padding:0 24px;">
<div style="background:linear-gradient(135deg,rgba(99,102,241,0.1),rgba(168,85,247,0.08));border:1px solid rgba(99,102,241,0.15);border-radius:20px;padding:32px 28px;text-align:center;">
<div style="font-size:13px;color:#818cf8;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Founding Member</div>
<h3 style="font-size:22px;font-weight:800;color:#fff;margin:0 0 8px;">Get NexTool Pro</h3>
<p style="color:#94a3b8;font-size:14px;margin:0 auto 20px;max-width:500px;">No banners, clean output, enhanced features on all 250+ tools. One-time payment.</p>
<div style="display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;">
<a href="/pro.html" style="display:inline-block;padding:12px 28px;background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);color:#fff;border-radius:10px;font-weight:700;font-size:15px;text-decoration:none;">$29 &mdash; Get Pro</a>
<a href="/free-tools/" style="color:#94a3b8;font-size:14px;text-decoration:none;">Browse 250+ Free Tools &rarr;</a>
</div>
</div>
</section>


<!-- AUTO-LINKED by NexTool Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/box-shadow-generator.html" style="color:var(--primary);text-decoration:none">CSS Box Shadow Generator</a> · <a href="/free-tools/emoji-picker.html" style="color:var(--primary);text-decoration:none">Emoji Picker & Search</a> · <a href="/free-tools/json-to-yaml-converter.html" style="color:var(--primary);text-decoration:none">Free JSON to YAML Converter</a></p>
</div>
<footer class="footer fade-in">
  <div class="footer-grid">
    <div class="footer-col">
      <h4>Products</h4>
      <a href="/free-tools/">250+ Free Tools</a>
<a href="/pro.html">NexTool Pro</a>
<a href="/workspace.html">Workspace</a>
    </div>
    <div class="footer-col">
      <h4>Explore</h4>
      <a href="/free-tools/">Free Tools</a><a href="/blog/">Blog</a><a href="/pro.html">FAQ</a><a href="/pro.html">Pro &mdash; $29</a>
    </div>
    <div class="footer-col">
      <h4>Ecosystem</h4>
      <a href="/">NexTool Home</a><a href="/#contact">Contact</a><a href="https://github.com/christian140903-sudo/nextool" target="_blank">GitHub</a>
    </div>
  </div>
  <div class="footer-bottom">&copy; 2026 NexTool. AI-powered tools for everyone.</div>
</footer>

<div class="toast" id="toast"></div>

<script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
<script>
var dropZone = document.getElementById('dropZone');
var fileInput = document.getElementById('fileInput');
var fileInfoBar = document.getElementById('fileInfoBar');
var fileNameEl = document.getElementById('fileName');
var fileMetaEl = document.getElementById('fileMeta');
var sheetSelector = document.getElementById('sheetSelector');
var sheetChips = document.getElementById('sheetChips');
var settingsPanel = document.getElementById('settingsPanel');
var controlsEl = document.getElementById('controls');
var convertBtn = document.getElementById('convertBtn');
var progressWrap = document.getElementById('progressWrap');
var progressFill = document.getElementById('progressFill');
var progressText = document.getElementById('progressText');
var previewSection = document.getElementById('previewSection');
var previewTabs = document.getElementById('previewTabs');
var previewTable = document.getElementById('previewTable');
var rowCountEl = document.getElementById('rowCount');
var fontSizeInput = document.getElementById('fontSize');
var fontSizeDisplay = document.getElementById('fontSizeDisplay');

var workbook = null;
var currentFile = null;
var selectedSheets = [];
var activePreviewSheet = null;

/* Font size display */
fontSizeInput.addEventListener('input', function() {
  fontSizeDisplay.textContent = this.value + 'pt';
});

/* Drop Zone */
dropZone.addEventListener('dragover', function(e) {
  e.preventDefault();
  dropZone.classList.add('dragover');
});
dropZone.addEventListener('dragleave', function() {
  dropZone.classList.remove('dragover');
});
dropZone.addEventListener('drop', function(e) {
  e.preventDefault();
  dropZone.classList.remove('dragover');
  if (e.dataTransfer.files.length > 0) {
    handleFile(e.dataTransfer.files[0]);
  }
});
fileInput.addEventListener('change', function() {
  if (fileInput.files.length > 0) {
    handleFile(fileInput.files[0]);
  }
  fileInput.value = '';
});

function handleFile(file) {
  var name = file.name.toLowerCase();
  if (!name.endsWith('.xlsx') && !name.endsWith('.xls') && !name.endsWith('.csv')) {
    showToast('Please select an Excel (.xlsx, .xls) or CSV file');
    return;
  }

  currentFile = file;
  fileNameEl.textContent = file.name;
  fileMetaEl.textContent = formatBytes(file.size);
  fileInfoBar.classList.add('visible');

  /* Update file icon */
  var iconEl = fileInfoBar.querySelector('.file-icon');
  if (name.endsWith('.csv')) {
    iconEl.textContent = 'CSV';
    iconEl.style.color = 'var(--cyan)';
    iconEl.style.background = 'rgba(34,211,238,.12)';
  } else {
    iconEl.textContent = 'XLS';
    iconEl.style.color = 'var(--green)';
    iconEl.style.background = 'rgba(34,197,94,.12)';
  }

  progressWrap.classList.add('active');
  progressFill.style.width = '30%';
  progressText.textContent = 'Reading file...';

  var reader = new FileReader();
  reader.onload = function(e) {
    try {
      progressFill.style.width = '60%';
      progressText.textContent = 'Parsing spreadsheet...';

      var data = new Uint8Array(e.target.result);
      workbook = XLSX.read(data, { type: 'array', cellDates: true, cellStyles: true });

      progressFill.style.width = '100%';
      progressText.textContent = 'File loaded successfully!';

      setTimeout(function() {
        progressWrap.classList.remove('active');
        progressFill.style.width = '0%';
      }, 1500);

      /* Build sheet selector */
      buildSheetSelector();

      /* Show controls */
      controlsEl.classList.add('visible');

      /* Show preview of first sheet */
      if (workbook.SheetNames.length > 0) {
        showPreview(workbook.SheetNames[0]);
      }

      var totalRows = 0;
      workbook.SheetNames.forEach(function(sn) {
        var ws = workbook.Sheets[sn];
        var json = XLSX.utils.sheet_to_json(ws, { header: 1, defval: '' });
        totalRows += json.length;
      });
      fileMetaEl.textContent = formatBytes(file.size) + ' | ' + workbook.SheetNames.length + ' sheet' + (workbook.SheetNames.length !== 1 ? 's' : '') + ' | ' + totalRows + ' rows total';

      showToast('File loaded: ' + workbook.SheetNames.length + ' sheet' + (workbook.SheetNames.length !== 1 ? 's' : '') + ' found');
    } catch (err) {
      progressWrap.classList.remove('active');
      showToast('Error reading file: ' + err.message);
      console.error(err);
    }
  };
  reader.readAsArrayBuffer(file);
}

function buildSheetSelector() {
  if (!workbook) return;
  var names = workbook.SheetNames;
  selectedSheets = names.slice(); /* select all by default */

  if (names.length <= 1) {
    sheetSelector.classList.remove('visible');
    return;
  }

  sheetSelector.classList.add('visible');
  sheetChips.innerHTML = '';

  names.forEach(function(name) {
    var chip = document.createElement('button');
    chip.className = 'sheet-chip active';
    chip.textContent = name;
    chip.addEventListener('click', function() {
      chip.classList.toggle('active');
      if (chip.classList.contains('active')) {
        if (selectedSheets.indexOf(name) === -1) selectedSheets.push(name);
      } else {
        selectedSheets = selectedSheets.filter(function(s) { return s !== name; });
      }
    });
    sheetChips.appendChild(chip);
  });
}

function showPreview(sheetName) {
  if (!workbook) return;
  activePreviewSheet = sheetName;
  previewSection.classList.add('visible');

  /* Build preview tabs */
  previewTabs.innerHTML = '';
  workbook.SheetNames.forEach(function(sn) {
    var tab = document.createElement('button');
    tab.className = 'preview-tab' + (sn === sheetName ? ' active' : '');
    tab.textContent = sn;
    tab.addEventListener('click', function() { showPreview(sn); });
    previewTabs.appendChild(tab);
  });

  /* Render table */
  var ws = workbook.Sheets[sheetName];
  var json = XLSX.utils.sheet_to_json(ws, { header: 1, defval: '' });

  previewTable.innerHTML = '';

  if (json.length === 0) {
    previewTable.innerHTML = '<tr><td style="padding:20px;color:#999;text-align:center">This sheet is empty</td></tr>';
    rowCountEl.textContent = '0 rows';
    return;
  }

  /* Find max columns */
  var maxCols = 0;
  json.forEach(function(row) {
    if (row.length > maxCols) maxCols = row.length;
  });

  /* Use first row as header */
  var thead = document.createElement('thead');
  var headerRow = document.createElement('tr');
  var firstRow = json[0];
  for (var c = 0; c < maxCols; c++) {
    var th = document.createElement('th');
    th.textContent = firstRow[c] !== undefined && firstRow[c] !== '' ? String(firstRow[c]) : columnLetter(c);
    headerRow.appendChild(th);
  }
  thead.appendChild(headerRow);
  previewTable.appendChild(thead);

  /* Body rows (limit preview to 100 rows) */
  var tbody = document.createElement('tbody');
  var previewLimit = Math.min(json.length, 101);
  for (var r = 1; r < previewLimit; r++) {
    var tr = document.createElement('tr');
    for (var c2 = 0; c2 < maxCols; c2++) {
      var td = document.createElement('td');
      var val = json[r] && json[r][c2] !== undefined ? json[r][c2] : '';
      if (val instanceof Date) {
        td.textContent = val.toLocaleDateString();
      } else {
        td.textContent = String(val);
      }
      tr.appendChild(td);
    }
    tbody.appendChild(tr);
  }
  previewTable.appendChild(tbody);

  var totalRows = json.length - 1;
  rowCountEl.textContent = totalRows + ' data row' + (totalRows !== 1 ? 's' : '') + (totalRows > 100 ? ' (showing first 100)' : '');

  previewSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function columnLetter(idx) {
  var s = '';
  var n = idx;
  while (n >= 0) {
    s = String.fromCharCode((n % 26) + 65) + s;
    n = Math.floor(n / 26) - 1;
  }
  return s;
}

/* Convert to PDF */
function convertToPdf() {
  if (!workbook) {
    showToast('Please upload an Excel or CSV file first');
    return;
  }

  if (selectedSheets.length === 0) {
    showToast('Please select at least one sheet');
    return;
  }

  convertBtn.disabled = true;
  progressWrap.classList.add('active');
  progressFill.style.width = '10%';
  progressText.textContent = 'Generating PDF...';

  /* Use setTimeout to allow UI update */
  setTimeout(function() {
    try {
      var pageSizeKey = document.getElementById('pageSize').value;
      var orientationVal = document.getElementById('orientation').value;
      var fontSizeVal = parseInt(fontSizeInput.value);

      var jsPDF = window.jspdf.jsPDF;
      var doc = new jsPDF({
        orientation: orientationVal,
        unit: 'mm',
        format: pageSizeKey
      });

      var sheetsToProcess = selectedSheets.filter(function(sn) {
        return workbook.SheetNames.indexOf(sn) !== -1;
      });

      for (var i = 0; i < sheetsToProcess.length; i++) {
        var sheetName = sheetsToProcess[i];
        var ws = workbook.Sheets[sheetName];
        var json = XLSX.utils.sheet_to_json(ws, { header: 1, defval: '' });

        if (json.length === 0) continue;

        if (i > 0) {
          doc.addPage();
        }

        /* Find max columns */
        var maxCols = 0;
        json.forEach(function(row) {
          if (row.length > maxCols) maxCols = row.length;
        });

        /* Sheet title */
        if (sheetsToProcess.length > 1) {
          doc.setFontSize(fontSizeVal + 4);
          doc.setFont('helvetica', 'bold');
          doc.text(sheetName, 14, 15);
        }

        /* Prepare header and body */
        var header = [];
        var firstRow = json[0];
        for (var c = 0; c < maxCols; c++) {
          var h = firstRow[c] !== undefined && firstRow[c] !== '' ? String(firstRow[c]) : columnLetter(c);
          header.push(h);
        }

        var body = [];
        for (var r = 1; r < json.length; r++) {
          var rowData = [];
          for (var c2 = 0; c2 < maxCols; c2++) {
            var val = json[r] && json[r][c2] !== undefined ? json[r][c2] : '';
            if (val instanceof Date) {
              rowData.push(val.toLocaleDateString());
            } else {
              rowData.push(String(val));
            }
          }
          body.push(rowData);
        }

        var startY = sheetsToProcess.length > 1 ? 20 : 14;

        doc.autoTable({
          head: [header],
          body: body,
          startY: startY,
          styles: {
            fontSize: fontSizeVal,
            cellPadding: 2,
            overflow: 'linebreak',
            lineColor: [200, 200, 200],
            lineWidth: 0.2
          },
          headStyles: {
            fillColor: [99, 102, 241],
            textColor: [255, 255, 255],
            fontStyle: 'bold',
            fontSize: fontSizeVal
          },
          alternateRowStyles: {
            fillColor: [245, 245, 250]
          },
          margin: { top: 10, right: 10, bottom: 10, left: 10 },
          didDrawPage: function(data) {
            /* Page number footer */
            var pageCount = doc.internal.getNumberOfPages();
            doc.setFontSize(8);
            doc.setTextColor(150);
            doc.text(
              'Page ' + data.pageNumber + ' of ' + pageCount,
              doc.internal.pageSize.getWidth() / 2,
              doc.internal.pageSize.getHeight() - 5,
              { align: 'center' }
            );
          }
        });

        var pct = Math.round(((i + 1) / sheetsToProcess.length) * 80) + 10;
        progressFill.style.width = pct + '%';
        progressText.textContent = 'Processing sheet ' + (i + 1) + ' of ' + sheetsToProcess.length + '...';
      }

      /* Fix page numbers (need to iterate through all pages) */
      var totalPages = doc.internal.getNumberOfPages();
      for (var p = 1; p <= totalPages; p++) {
        doc.setPage(p);
        doc.setFontSize(8);
        doc.setTextColor(150);
        var pageWidth = doc.internal.pageSize.getWidth();
        var pageHeight = doc.internal.pageSize.getHeight();
        doc.text(
          'Page ' + p + ' of ' + totalPages,
          pageWidth / 2,
          pageHeight - 5,
          { align: 'center' }
        );
      }

      progressFill.style.width = '100%';
      progressText.textContent = 'PDF generated successfully!';

      /* Download */
      var outputName = currentFile ? currentFile.name.replace(/\.(xlsx|xls|csv)$/i, '') + '.pdf' : 'spreadsheet.pdf';
      doc.save(outputName);

      showToast('PDF downloaded: ' + outputName);

      setTimeout(function() {
        progressWrap.classList.remove('active');
        progressFill.style.width = '0%';
      }, 2000);
    } catch (err) {
      progressWrap.classList.remove('active');
      showToast('Error generating PDF: ' + err.message);
      console.error(err);
    }

    convertBtn.disabled = false;
  }, 50);
}

function toggleSettings() {
  settingsPanel.classList.toggle('visible');
}

function clearFile() {
  workbook = null;
  currentFile = null;
  selectedSheets = [];
  activePreviewSheet = null;
  fileInfoBar.classList.remove('visible');
  sheetSelector.classList.remove('visible');
  settingsPanel.classList.remove('visible');
  controlsEl.classList.remove('visible');
  previewSection.classList.remove('visible');
  progressWrap.classList.remove('active');
  previewTable.innerHTML = '';
  previewTabs.innerHTML = '';
  rowCountEl.textContent = '';
  showToast('File cleared');
}

/* Helpers */
function formatBytes(bytes) {
  if (bytes === 0) return '0 B';
  var k = 1024, sizes = ['B', 'KB', 'MB', 'GB'];
  var i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
}

function showToast(msg) {
  var t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(function() { t.classList.remove('show'); }, 2500);
}

/* IntersectionObserver fade-in */
var observer = new IntersectionObserver(function(entries) {
  entries.forEach(function(entry) {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');
      observer.unobserve(entry.target);
    }
  });
}, { threshold: 0.1 });
document.querySelectorAll('.fade-in').forEach(function(el) { observer.observe(el); });
</script>
<script src="/js/analytics-lite.js" defer></script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "How do I convert an Excel file to PDF for free?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Simply drag and drop your .xlsx, .xls, or .csv file into NexTool's Excel to PDF Converter. Preview your data, select which sheets to include, choose page size and orientation, then click Convert to PDF. The formatted PDF downloads instantly. No signup or server upload required."
      }
    },
    {
      "@type": "Question",
      "name": "Is it safe to convert Excel to PDF with this tool?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes. NexTool's Excel to PDF Converter runs 100% in your browser using SheetJS and jsPDF. Your spreadsheet files are never uploaded to any server. All parsing and PDF generation happens locally on your device, ensuring complete privacy and data security."
      }
    },
    {
      "@type": "Question",
      "name": "Can I convert a multi-sheet Excel workbook to PDF?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes. When you upload an Excel file with multiple sheets, the tool displays sheet selector chips so you can choose which sheets to include in the PDF. Each selected sheet becomes a separate section in the generated PDF document with its own table."
      }
    },
    {
      "@type": "Question",
      "name": "What file formats are supported for conversion?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The tool supports Excel files in .xlsx format (Excel 2007+), .xls format (legacy Excel), and .csv (comma-separated values). All spreadsheet data including numbers, text, dates, and formulas (as computed values) are preserved in the PDF output."
      }
    },
    {
      "@type": "Question",
      "name": "Can I customize the PDF output layout?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes. You can customize page size (A4, Letter, Legal), page orientation (Portrait or Landscape), and font size (8pt to 14pt). Landscape orientation is recommended for spreadsheets with many columns. The PDF includes styled table headers, alternating row colors, and page numbers."
      }
    }
  ]
}
</script>
</body>
</html>

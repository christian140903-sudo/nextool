<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Color Picker &amp; Converter | NexTool Free Tools</title>
<meta name="description" content="Full-featured color picker with HSL, RGB, and HEX modes. Get complementary, analogous, and triadic color suggestions. Copy CSS variables instantly. Free online tool by NexTool.">
<meta name="keywords" content="color picker, hex to rgb, hsl converter, color palette, complementary colors, CSS color, color tool">
<meta property="og:title" content="Color Picker & Converter | NexTool Free Tools">
<meta property="og:description" content="Pick colors in HSL, RGB, or HEX. Get color harmonies, CSS variables, and save your color history.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/color-picker.html">
<meta property="og:image" content="https://nextool.app/free-tools/og/color-picker.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Color Picker & Converter | NexTool Free Tools">
<meta name="twitter:description" content="Pick colors in HSL, RGB, or HEX. Get color harmonies, CSS variables, and save your color history.">
<link rel="canonical" href="https://nextool.app/free-tools/color-picker.html">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://nextool.app/"},{"@type":"ListItem","position":2,"name":"Free Tools","item":"https://nextool.app/free-tools/"},{"@type":"ListItem","position":3,"name":"Color Picker","item":"https://nextool.app/free-tools/color-picker.html"}]}
</script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--primary:#6366f1;--accent:#a855f7;--pink:#ec4899;--cyan:#06b6d4;--text:#e2e8f0;--text2:#94a3b8;--radius:16px;--glow:0 0 30px rgba(236,72,153,0.15)}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;line-height:1.6;-webkit-font-smoothing:antialiased}
a{color:inherit;text-decoration:none}
/* NAV */
nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.85);backdrop-filter:blur(20px);border-bottom:1px solid rgba(255,255,255,0.06);padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{font-size:1.35rem;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.nav-links{display:flex;gap:1.5rem;align-items:center}
.nav-links a{font-size:.875rem;color:var(--text2);transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-hamburger{display:none;flex-direction:column;gap:5px;cursor:pointer;padding:8px}
.nav-hamburger span{width:22px;height:2px;background:var(--text);border-radius:2px;transition:all .3s}
@media(max-width:768px){.nav-links{display:none;position:absolute;top:64px;left:0;right:0;flex-direction:column;background:var(--surface);padding:1.5rem;gap:1rem;border-bottom:1px solid rgba(255,255,255,0.06)}.nav-links.open{display:flex}.nav-hamburger{display:flex}}
/* HERO */
.hero{text-align:center;padding:4rem 2rem 2rem}
.breadcrumb{font-size:.8rem;color:var(--text2);margin-bottom:1.5rem}
.breadcrumb a:hover{color:var(--pink)}
.breadcrumb span{margin:0 .5rem;opacity:.4}
.hero h1{font-size:clamp(2rem,5vw,3.2rem);font-weight:800;line-height:1.15;margin-bottom:1rem}
.hero h1 .grad{background:linear-gradient(135deg,var(--pink),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--text2);max-width:600px;margin:0 auto;font-size:1.05rem}
/* MAIN */
.container{max-width:1100px;margin:0 auto;padding:2rem}
.tool-grid{display:grid;grid-template-columns:1fr 340px;gap:1.5rem;margin-bottom:2rem}
@media(max-width:900px){.tool-grid{grid-template-columns:1fr}}
.stat-card{background:var(--surface);border:1px solid rgba(255,255,255,0.06);border-radius:var(--radius);padding:1.25rem}
.stat-card h3{font-size:.75rem;text-transform:uppercase;letter-spacing:.08em;color:var(--text2);margin-bottom:.75rem}
.stat-row{display:flex;justify-content:space-between;align-items:center;padding:.4rem 0;border-bottom:1px solid rgba(255,255,255,0.04)}
.stat-row:last-child{border-bottom:none}
.stat-label{font-size:.85rem;color:var(--text2)}
.stat-value{font-size:1rem;font-weight:700;color:var(--pink)}
/* BUTTONS */
.actions{display:flex;gap:.75rem;margin-bottom:1.5rem;flex-wrap:wrap}
.btn{padding:.65rem 1.25rem;border-radius:10px;border:none;font-family:'Inter',sans-serif;font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s}
.btn-primary{background:linear-gradient(135deg,var(--pink),var(--accent));color:#fff}
.btn-primary:hover{opacity:.9;transform:translateY(-1px)}
.btn-ghost{background:rgba(255,255,255,0.04);color:var(--text2);border:1px solid rgba(255,255,255,0.08)}
.btn-ghost:hover{background:rgba(255,255,255,0.08);color:var(--text)}
.btn-sm{padding:.4rem .85rem;font-size:.75rem;border-radius:8px}
/* COLOR PREVIEW */
.color-preview{width:100%;aspect-ratio:16/9;border-radius:var(--radius);border:1px solid rgba(255,255,255,0.08);position:relative;overflow:hidden;cursor:crosshair;margin-bottom:1.5rem}
.color-preview-inner{width:100%;height:100%;transition:background .15s}
.color-hex-overlay{position:absolute;bottom:1rem;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.6);backdrop-filter:blur(10px);padding:.5rem 1.25rem;border-radius:10px;font-size:1.1rem;font-weight:700;letter-spacing:.04em;color:#fff}
/* SPECTRUM */
.spectrum-wrap{position:relative;margin-bottom:1.5rem}
.spectrum-canvas{width:100%;height:220px;border-radius:var(--radius);cursor:crosshair;display:block;border:1px solid rgba(255,255,255,0.08)}
.hue-slider-wrap{margin-top:.75rem}
.hue-slider{-webkit-appearance:none;appearance:none;width:100%;height:18px;border-radius:9px;outline:none;cursor:pointer;background:linear-gradient(to right,#f00 0%,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,#f00 100%)}
.hue-slider::-webkit-slider-thumb{-webkit-appearance:none;width:22px;height:22px;border-radius:50%;background:#fff;border:3px solid rgba(0,0,0,0.3);box-shadow:0 2px 6px rgba(0,0,0,0.3);cursor:pointer}
.hue-slider::-moz-range-thumb{width:22px;height:22px;border-radius:50%;background:#fff;border:3px solid rgba(0,0,0,0.3);box-shadow:0 2px 6px rgba(0,0,0,0.3);cursor:pointer}
/* INPUT GROUPS */
.input-group{display:grid;grid-template-columns:1fr 1fr 1fr;gap:.5rem;margin-bottom:.75rem}
.input-group.hex-group{grid-template-columns:1fr}
.input-item{display:flex;flex-direction:column;gap:.25rem}
.input-item label{font-size:.65rem;text-transform:uppercase;letter-spacing:.06em;color:var(--text2)}
.input-item input{background:var(--surface2);border:1px solid rgba(255,255,255,0.08);border-radius:8px;padding:.5rem .65rem;color:var(--text);font-family:'Inter',sans-serif;font-size:.85rem;outline:none;transition:border-color .2s;width:100%}
.input-item input:focus{border-color:var(--pink)}
.copy-row{display:flex;gap:.5rem;align-items:center;margin-bottom:.75rem}
.copy-row input{flex:1;background:var(--surface2);border:1px solid rgba(255,255,255,0.08);border-radius:8px;padding:.5rem .65rem;color:var(--text);font-family:'Inter',monospace;font-size:.85rem;outline:none}
.copy-row input:focus{border-color:var(--pink)}
.copy-row label{font-size:.7rem;color:var(--text2);min-width:32px}
/* HISTORY */
.history-grid{display:grid;grid-template-columns:repeat(10,1fr);gap:.4rem}
.history-swatch{aspect-ratio:1;border-radius:6px;cursor:pointer;border:2px solid transparent;transition:all .2s;position:relative}
.history-swatch:hover{border-color:var(--pink);transform:scale(1.15)}
.history-swatch.empty{background:var(--surface2);border:1px dashed rgba(255,255,255,0.1);cursor:default}
.history-swatch.empty:hover{transform:none;border-color:rgba(255,255,255,0.1)}
/* HARMONIES */
.harmony-section{background:var(--surface);border:1px solid rgba(255,255,255,0.06);border-radius:var(--radius);padding:1.25rem;margin-bottom:1.5rem}
.harmony-section h3{font-size:.75rem;text-transform:uppercase;letter-spacing:.08em;color:var(--text2);margin-bottom:.75rem}
.harmony-row{display:flex;gap:.5rem;align-items:center;margin-bottom:.65rem}
.harmony-row:last-child{margin-bottom:0}
.harmony-label{font-size:.8rem;color:var(--text2);min-width:100px}
.harmony-colors{display:flex;gap:.35rem;flex:1}
.harmony-chip{height:36px;flex:1;border-radius:8px;cursor:pointer;position:relative;border:1px solid rgba(255,255,255,0.08);transition:all .2s}
.harmony-chip:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.3)}
.harmony-chip .chip-label{position:absolute;bottom:-18px;left:50%;transform:translateX(-50%);font-size:.6rem;color:var(--text2);white-space:nowrap;opacity:0;transition:opacity .2s}
.harmony-chip:hover .chip-label{opacity:1}
/* CSS OUTPUT */
.css-output{background:var(--surface);border:1px solid rgba(255,255,255,0.06);border-radius:var(--radius);padding:1.25rem;margin-bottom:1.5rem}
.css-output h3{font-size:.75rem;text-transform:uppercase;letter-spacing:.08em;color:var(--text2);margin-bottom:.75rem}
.css-code{background:var(--bg);border-radius:10px;padding:1rem;font-family:'SF Mono',Monaco,Consolas,monospace;font-size:.8rem;color:var(--text2);line-height:1.8;overflow-x:auto;white-space:pre}
.css-code .prop{color:var(--cyan)}
.css-code .val{color:var(--pink)}
/* TOAST */
.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface);border:1px solid var(--pink);border-radius:10px;padding:.6rem 1.25rem;font-size:.85rem;color:var(--text);opacity:0;transition:all .3s;z-index:300;pointer-events:none}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
/* MORE TOOLS */
.more-tools{margin-top:4rem;padding:3rem 0;border-top:1px solid rgba(255,255,255,0.06)}
.more-tools h2{text-align:center;font-size:1.5rem;margin-bottom:2rem}
.tools-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:1rem}
.tool-card{background:var(--surface);border:1px solid rgba(255,255,255,0.06);border-radius:var(--radius);padding:1.5rem;transition:all .3s}
.tool-card:hover{border-color:var(--primary);transform:translateY(-3px);box-shadow:0 8px 30px rgba(99,102,241,0.1)}
.tool-card .icon{font-size:1.5rem;margin-bottom:.75rem}
.tool-card h3{font-size:1rem;margin-bottom:.4rem}
.tool-card p{font-size:.8rem;color:var(--text2)}
/* CROSS PROMO */
.cross-promo{text-align:center;padding:3rem 2rem;margin-top:2rem;background:var(--surface);border:1px solid rgba(255,255,255,0.06);border-radius:var(--radius)}
.cross-promo h2{font-size:1.3rem;margin-bottom:.5rem}
.cross-promo p{color:var(--text2);font-size:.95rem;margin-bottom:1.25rem}
/* FOOTER */
footer{margin-top:4rem;padding:2rem;text-align:center;border-top:1px solid rgba(255,255,255,0.06);color:var(--text2);font-size:.8rem}
footer .brand{font-weight:700;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
footer .foot-links{display:flex;gap:1.5rem;justify-content:center;margin-bottom:.75rem;flex-wrap:wrap}
footer .foot-links a{color:var(--text2);transition:color .2s}
footer .foot-links a:hover{color:var(--text)}
</style>
</head>
<body>

<nav>
  <a href="/" class="nav-logo">NexTool</a>
  <div class="nav-links" id="navLinks">
    <a href="/">Home</a>
    <a href="/free-tools/">Free Tools</a>
    <a href="/blog/">Blog</a>
    <a href="/pro.html">Pro</a>
  </div>
  <div class="nav-hamburger" onclick="document.getElementById('navLinks').classList.toggle('open')">
    <span></span><span></span><span></span>
  </div>
</nav>

<section class="hero">
  <div class="breadcrumb"><a href="/">Home</a><span>/</span><a href="/free-tools/">Free Tools</a><span>/</span>Color Picker</div>
  <h1><span class="grad">Color Picker</span> &amp; Converter</h1>
  <p>Pick any color with the visual spectrum, convert between HSL, RGB, and HEX, explore color harmonies, and generate CSS variables.</p>
</section>

<div class="container">
  <div class="tool-grid">
    <div>
      <div class="color-preview">
        <div class="color-preview-inner" id="colorPreview"></div>
        <div class="color-hex-overlay" id="hexOverlay">#6366F1</div>
      </div>

      <div class="spectrum-wrap">
        <canvas class="spectrum-canvas" id="spectrumCanvas" width="760" height="220"></canvas>
        <div class="hue-slider-wrap">
          <input type="range" class="hue-slider" id="hueSlider" min="0" max="360" value="235">
        </div>
      </div>

      <div class="harmony-section">
        <h3>Color Harmonies</h3>
        <div class="harmony-row">
          <span class="harmony-label">Complementary</span>
          <div class="harmony-colors" id="harmComplementary"></div>
        </div>
        <div class="harmony-row">
          <span class="harmony-label">Analogous</span>
          <div class="harmony-colors" id="harmAnalogous"></div>
        </div>
        <div class="harmony-row">
          <span class="harmony-label">Triadic</span>
          <div class="harmony-colors" id="harmTriadic"></div>
        </div>
        <div class="harmony-row">
          <span class="harmony-label">Split-Compl.</span>
          <div class="harmony-colors" id="harmSplit"></div>
        </div>
        <div class="harmony-row">
          <span class="harmony-label">Tetradic</span>
          <div class="harmony-colors" id="harmTetradic"></div>
        </div>
      </div>
    </div>

    <div class="sidebar" style="display:flex;flex-direction:column;gap:1rem">
      <div class="stat-card">
        <h3>HEX</h3>
        <div class="copy-row">
          <input type="text" id="hexInput" value="#6366F1" spellcheck="false">
          <button class="btn btn-sm btn-ghost" onclick="copyValue('hexInput')">Copy</button>
        </div>
      </div>

      <div class="stat-card">
        <h3>RGB</h3>
        <div class="input-group">
          <div class="input-item"><label>R</label><input type="number" id="rInput" min="0" max="255" value="99"></div>
          <div class="input-item"><label>G</label><input type="number" id="gInput" min="0" max="255" value="102"></div>
          <div class="input-item"><label>B</label><input type="number" id="bInput" min="0" max="255" value="241"></div>
        </div>
        <div class="copy-row">
          <input type="text" id="rgbString" value="rgb(99, 102, 241)" readonly>
          <button class="btn btn-sm btn-ghost" onclick="copyValue('rgbString')">Copy</button>
        </div>
      </div>

      <div class="stat-card">
        <h3>HSL</h3>
        <div class="input-group">
          <div class="input-item"><label>H</label><input type="number" id="hInput" min="0" max="360" value="239"></div>
          <div class="input-item"><label>S</label><input type="number" id="sInput" min="0" max="100" value="84"></div>
          <div class="input-item"><label>L</label><input type="number" id="lInput" min="0" max="100" value="67"></div>
        </div>
        <div class="copy-row">
          <input type="text" id="hslString" value="hsl(239, 84%, 67%)" readonly>
          <button class="btn btn-sm btn-ghost" onclick="copyValue('hslString')">Copy</button>
        </div>
      </div>

      <div class="stat-card">
        <h3>Color History</h3>
        <div class="history-grid" id="historyGrid"></div>
      </div>

      <div class="css-output">
        <h3>CSS Variables</h3>
        <div class="css-code" id="cssOutput"></div>
        <div style="margin-top:.75rem;text-align:right">
          <button class="btn btn-sm btn-ghost" onclick="copyCss()">Copy CSS</button>
        </div>
      </div>
    </div>
  </div>

  <section class="cross-promo">
    <h2>Explore 150+ Free Tools at NexTool</h2>
    <p>Your all-in-one developer toolkit</p>
    <a href="/free-tools/" class="btn btn-primary">Browse All Tools</a>
  </section>

  <section class="more-tools">
    <h2>More Free Tools</h2>
    <div class="tools-grid">
      <a href="/free-tools/word-counter.html" class="tool-card"><div class="icon">W</div><h3>Word Counter</h3><p>Count words, characters, sentences with readability analysis.</p></a>
      <a href="/free-tools/json-viewer.html" class="tool-card"><div class="icon">{ }</div><h3>JSON Viewer</h3><p>Paste JSON, get a collapsible tree with search and path copying.</p></a>
      <a href="/free-tools/character-counter.html" class="tool-card"><div class="icon">Aa</div><h3>Character Counter</h3><p>Live character and word counts with social media limit tracking.</p></a>
      <a href="/free-tools/random-generator.html" class="tool-card"><div class="icon">&#x1f3b2;</div><h3>Random Generator</h3><p>Generate random numbers, strings, UUIDs, colors, and pick from lists.</p></a>
    </div>
  </section>
</div>

<footer>
  <div class="foot-links">
    <a href="/free-tools/">Free Tools</a>
    <a href="/blog/">Blog</a>
    <a href="/pro.html">Pro</a>
    <a href="/privacy.html">Privacy</a>
    <a href="/terms.html">Terms</a>
  </div>
  <p><span class="brand">NexTool</span> &mdash; AI Automation Studio &copy; 2026. All rights reserved.</p>
</footer>

<div class="toast" id="toast"></div>

<script>
// --- State ---
let currentH = 239, currentS = 84, currentL = 67;
let history = JSON.parse(localStorage.getItem('nexColorHistory') || '[]');
let spectrumDragging = false;

// --- Utility: HSL <-> RGB <-> HEX ---
function hslToRgb(h, s, l) {
  s /= 100; l /= 100;
  const a = s * Math.min(l, 1 - l);
  const f = n => { const k = (n + h / 30) % 12; return l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1); };
  return [Math.round(f(0) * 255), Math.round(f(8) * 255), Math.round(f(4) * 255)];
}

function rgbToHsl(r, g, b) {
  r /= 255; g /= 255; b /= 255;
  const max = Math.max(r, g, b), min = Math.min(r, g, b);
  let h, s, l = (max + min) / 2;
  if (max === min) { h = s = 0; }
  else {
    const d = max - min;
    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
    switch (max) {
      case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
      case g: h = ((b - r) / d + 2) / 6; break;
      case b: h = ((r - g) / d + 4) / 6; break;
    }
  }
  return [Math.round(h * 360), Math.round(s * 100), Math.round(l * 100)];
}

function rgbToHex(r, g, b) {
  return '#' + [r, g, b].map(c => c.toString(16).padStart(2, '0')).join('').toUpperCase();
}

function hexToRgb(hex) {
  hex = hex.replace('#', '');
  if (hex.length === 3) hex = hex.split('').map(c => c + c).join('');
  if (hex.length !== 6) return null;
  const n = parseInt(hex, 16);
  if (isNaN(n)) return null;
  return [(n >> 16) & 255, (n >> 8) & 255, n & 255];
}

// --- UI Update ---
function updateFromHSL(h, s, l, source) {
  currentH = h; currentS = s; currentL = l;
  const [r, g, b] = hslToRgb(h, s, l);
  const hex = rgbToHex(r, g, b);

  // Update preview
  document.getElementById('colorPreview').style.background = hex;
  document.getElementById('hexOverlay').textContent = hex;

  // Update inputs (skip the source to avoid loops)
  if (source !== 'hex') document.getElementById('hexInput').value = hex;
  if (source !== 'rgb') { document.getElementById('rInput').value = r; document.getElementById('gInput').value = g; document.getElementById('bInput').value = b; }
  if (source !== 'hsl') { document.getElementById('hInput').value = h; document.getElementById('sInput').value = s; document.getElementById('lInput').value = l; }

  document.getElementById('rgbString').value = `rgb(${r}, ${g}, ${b})`;
  document.getElementById('hslString').value = `hsl(${h}, ${s}%, ${l}%)`;

  // Update hue slider
  if (source !== 'hueSlider') document.getElementById('hueSlider').value = h;

  // Update CSS output
  updateCssOutput(hex, r, g, b, h, s, l);

  // Update harmonies
  updateHarmonies(h, s, l);

  // Redraw spectrum
  drawSpectrum(h);
}

function updateCssOutput(hex, r, g, b, h, s, l) {
  const el = document.getElementById('cssOutput');
  el.innerHTML =
    `<span class="prop">--color-hex</span>: <span class="val">${hex}</span>;\n` +
    `<span class="prop">--color-rgb</span>: <span class="val">${r}, ${g}, ${b}</span>;\n` +
    `<span class="prop">--color-hsl</span>: <span class="val">${h}, ${s}%, ${l}%</span>;\n` +
    `<span class="prop">--color-rgb-fn</span>: <span class="val">rgb(${r}, ${g}, ${b})</span>;\n` +
    `<span class="prop">--color-hsl-fn</span>: <span class="val">hsl(${h}, ${s}%, ${l}%)</span>;`;
}

// --- Harmonies ---
function updateHarmonies(h, s, l) {
  const make = (hue) => { const [r, g, b] = hslToRgb(((hue % 360) + 360) % 360, s, l); return rgbToHex(r, g, b); };

  setHarmonyChips('harmComplementary', [make(h), make(h + 180)]);
  setHarmonyChips('harmAnalogous', [make(h - 30), make(h), make(h + 30)]);
  setHarmonyChips('harmTriadic', [make(h), make(h + 120), make(h + 240)]);
  setHarmonyChips('harmSplit', [make(h), make(h + 150), make(h + 210)]);
  setHarmonyChips('harmTetradic', [make(h), make(h + 90), make(h + 180), make(h + 270)]);
}

function setHarmonyChips(id, colors) {
  const el = document.getElementById(id);
  el.innerHTML = colors.map(c =>
    `<div class="harmony-chip" style="background:${c}" onclick="pickHarmonyColor('${c}')" title="${c}"><span class="chip-label">${c}</span></div>`
  ).join('');
}

function pickHarmonyColor(hex) {
  const rgb = hexToRgb(hex);
  if (!rgb) return;
  const [h, s, l] = rgbToHsl(...rgb);
  addToHistory(hex);
  updateFromHSL(h, s, l, 'harmony');
}

// --- Spectrum Canvas ---
function drawSpectrum(hue) {
  const canvas = document.getElementById('spectrumCanvas');
  const ctx = canvas.getContext('2d');
  const w = canvas.width, h = canvas.height;

  // Saturation gradient (left to right: white to full color)
  const gradH = ctx.createLinearGradient(0, 0, w, 0);
  gradH.addColorStop(0, '#fff');
  gradH.addColorStop(1, `hsl(${hue}, 100%, 50%)`);
  ctx.fillStyle = gradH;
  ctx.fillRect(0, 0, w, h);

  // Lightness gradient (top to bottom: transparent to black)
  const gradV = ctx.createLinearGradient(0, 0, 0, h);
  gradV.addColorStop(0, 'rgba(0,0,0,0)');
  gradV.addColorStop(1, 'rgba(0,0,0,1)');
  ctx.fillStyle = gradV;
  ctx.fillRect(0, 0, w, h);
}

function spectrumPick(e) {
  const canvas = document.getElementById('spectrumCanvas');
  const rect = canvas.getBoundingClientRect();
  const x = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
  const y = Math.max(0, Math.min(1, (e.clientY - rect.top) / rect.height));

  // Convert x,y to saturation and lightness
  const s = Math.round(x * 100);
  const l = Math.round((1 - y) * (100 - s / 2));

  addToHistory(rgbToHex(...hslToRgb(currentH, s, l)));
  updateFromHSL(currentH, s, Math.max(0, Math.min(100, l)), 'spectrum');
}

document.getElementById('spectrumCanvas').addEventListener('mousedown', (e) => { spectrumDragging = true; spectrumPick(e); });
document.addEventListener('mousemove', (e) => { if (spectrumDragging) spectrumPick(e); });
document.addEventListener('mouseup', () => { spectrumDragging = false; });
document.getElementById('spectrumCanvas').addEventListener('touchstart', (e) => { e.preventDefault(); spectrumPick(e.touches[0]); }, { passive: false });
document.getElementById('spectrumCanvas').addEventListener('touchmove', (e) => { e.preventDefault(); spectrumPick(e.touches[0]); }, { passive: false });

// --- Hue Slider ---
document.getElementById('hueSlider').addEventListener('input', (e) => {
  const h = parseInt(e.target.value);
  updateFromHSL(h, currentS, currentL, 'hueSlider');
});

// --- Input Listeners ---
document.getElementById('hexInput').addEventListener('input', (e) => {
  let v = e.target.value.trim();
  if (!v.startsWith('#')) v = '#' + v;
  const rgb = hexToRgb(v);
  if (rgb) {
    const [h, s, l] = rgbToHsl(...rgb);
    addToHistory(v.toUpperCase());
    updateFromHSL(h, s, l, 'hex');
  }
});

['rInput', 'gInput', 'bInput'].forEach(id => {
  document.getElementById(id).addEventListener('input', () => {
    const r = clampInt(document.getElementById('rInput').value, 0, 255);
    const g = clampInt(document.getElementById('gInput').value, 0, 255);
    const b = clampInt(document.getElementById('bInput').value, 0, 255);
    const [h, s, l] = rgbToHsl(r, g, b);
    addToHistory(rgbToHex(r, g, b));
    updateFromHSL(h, s, l, 'rgb');
  });
});

['hInput', 'sInput', 'lInput'].forEach(id => {
  document.getElementById(id).addEventListener('input', () => {
    const h = clampInt(document.getElementById('hInput').value, 0, 360);
    const s = clampInt(document.getElementById('sInput').value, 0, 100);
    const l = clampInt(document.getElementById('lInput').value, 0, 100);
    addToHistory(rgbToHex(...hslToRgb(h, s, l)));
    updateFromHSL(h, s, l, 'hsl');
  });
});

function clampInt(val, min, max) { const n = parseInt(val) || 0; return Math.max(min, Math.min(max, n)); }

// --- History ---
function addToHistory(hex) {
  hex = hex.toUpperCase();
  history = history.filter(c => c !== hex);
  history.unshift(hex);
  if (history.length > 10) history = history.slice(0, 10);
  localStorage.setItem('nexColorHistory', JSON.stringify(history));
  renderHistory();
}

function renderHistory() {
  const grid = document.getElementById('historyGrid');
  let html = '';
  for (let i = 0; i < 10; i++) {
    if (i < history.length) {
      html += `<div class="history-swatch" style="background:${history[i]}" title="${history[i]}" onclick="pickHistory(${i})"></div>`;
    } else {
      html += `<div class="history-swatch empty"></div>`;
    }
  }
  grid.innerHTML = html;
}

function pickHistory(i) {
  if (i >= history.length) return;
  const hex = history[i];
  const rgb = hexToRgb(hex);
  if (!rgb) return;
  const [h, s, l] = rgbToHsl(...rgb);
  updateFromHSL(h, s, l, 'history');
}

// --- Copy ---
function copyValue(id) {
  const v = document.getElementById(id).value;
  navigator.clipboard.writeText(v).then(() => showToast('Copied: ' + v));
}

function copyCss() {
  const [r, g, b] = hslToRgb(currentH, currentS, currentL);
  const hex = rgbToHex(r, g, b);
  const text =
    `--color-hex: ${hex};\n` +
    `--color-rgb: ${r}, ${g}, ${b};\n` +
    `--color-hsl: ${currentH}, ${currentS}%, ${currentL}%;\n` +
    `--color-rgb-fn: rgb(${r}, ${g}, ${b});\n` +
    `--color-hsl-fn: hsl(${currentH}, ${currentS}%, ${currentL}%);`;
  navigator.clipboard.writeText(text).then(() => showToast('CSS variables copied!'));
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2000);
}

// --- Init ---
renderHistory();
updateFromHSL(currentH, currentS, currentL, 'init');
</script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script src="/js/analytics-lite.js" defer></script>
</body>
</html>
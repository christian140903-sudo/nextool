<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Audio Converter Online — MP3, WAV, OGG, FLAC | ANIMA</title>
<meta name="description" content="Convert audio files between MP3, WAV, OGG, FLAC, AAC, M4A, and WebM formats free online. Change sample rate, channels, preview audio with waveform visualization. No upload, 100% client-side.">
<meta name="keywords" content="audio converter, convert mp3 to wav, convert audio online, free audio converter, wav to ogg, change sample rate, audio format converter, ANIMA">
<meta name="robots" content="index, follow">
<meta property="og:title" content="Free Audio Converter Online — MP3, WAV, OGG, FLAC | ANIMA">
<meta property="og:description" content="Convert audio files between formats instantly in your browser. WAV, WebM, OGG output. Sample rate & channel control. Waveform visualization. 100% free.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/audio-converter.html">
<meta property="og:image" content="https://nextool.app/img/og-image.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<link rel="canonical" href="https://nextool.app/free-tools/audio-converter.html">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free Audio Converter Online — MP3, WAV, OGG, FLAC | ANIMA">
<meta name="twitter:description" content="Convert audio between MP3, WAV, OGG, FLAC formats free in your browser. No signup required.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"Audio Converter","applicationCategory":"MultimediaApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"description":"Free online audio converter. Convert between MP3, WAV, OGG, FLAC, AAC, M4A, WebM formats with sample rate and channel control."}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--border:#2a2a3a;--text:#e4e4eb;--text2:#9494a8;--primary:#00d4ff;--accent:#a855f7;--pink:#ec4899;--green:#22c55e;--red:#ef4444;--cyan:#22d3ee;--yellow:#eab308;--radius:12px;--glass:rgba(17,17,24,0.7)}
html{scroll-behavior:smooth}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
/* NAV */
.nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{font-size:1.4rem;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-decoration:none}
.nav-links{display:flex;align-items:center;gap:1.5rem}
.nav-links a{color:var(--text2);text-decoration:none;font-size:.875rem;font-weight:500;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-cta{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff!important;padding:.5rem 1.2rem;border-radius:8px;font-weight:600;-webkit-text-fill-color:#fff!important}
.nav-cta:hover{opacity:.9}
.nav-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}
/* HERO */
.hero{text-align:center;padding:3rem 1.5rem 2rem;max-width:700px;margin:0 auto}
.hero h1{font-size:2.2rem;font-weight:800;line-height:1.2;margin-bottom:.75rem}
.hero h1 span{background:linear-gradient(135deg,var(--primary),var(--accent),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--text2);font-size:1rem}
/* TOOL */
.tool-container{max-width:900px;margin:0 auto;padding:0 1.5rem 3rem}
/* DROP ZONE */
.drop-zone{border:2px dashed var(--border);border-radius:var(--radius);padding:3rem 2rem;text-align:center;cursor:pointer;transition:all .3s;background:var(--glass);backdrop-filter:blur(16px);margin-bottom:1.5rem}
.drop-zone:hover,.drop-zone.drag-over{border-color:var(--primary);background:rgba(0,212,255,.06)}
.drop-zone.has-file{border-color:var(--green);border-style:solid}
.drop-icon{font-size:3rem;margin-bottom:.75rem;opacity:.6}
.drop-text{color:var(--text2);font-size:.95rem;margin-bottom:.5rem}
.drop-sub{color:var(--text2);font-size:.8rem;opacity:.7}
.file-input{display:none}
/* FILE INFO */
.file-info{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);padding:1.25rem;margin-bottom:1.5rem;display:none}
.file-info.visible{display:block}
.file-info-row{display:flex;justify-content:space-between;align-items:center;gap:1rem;flex-wrap:wrap}
.file-name{font-weight:600;font-size:.95rem;color:var(--text);word-break:break-all}
.file-meta{display:flex;gap:1rem;font-size:.8rem;color:var(--text2)}
.file-meta span{display:flex;align-items:center;gap:.3rem}
/* SETTINGS */
.settings{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);padding:1.25rem;margin-bottom:1.5rem;display:none}
.settings.visible{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}
.setting-group label{display:block;font-size:.8rem;font-weight:600;color:var(--text2);margin-bottom:.4rem;text-transform:uppercase;letter-spacing:.5px}
.setting-group select{width:100%;background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.55rem .9rem;border-radius:8px;font-size:.85rem;font-family:inherit;cursor:pointer;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%239494a8' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .7rem center;transition:border-color .2s}
.setting-group select:focus{outline:none;border-color:var(--primary)}
/* CONVERT BTN */
.convert-row{display:flex;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap;display:none}
.convert-row.visible{display:flex}
.btn{padding:.65rem 1.5rem;border-radius:10px;font-weight:700;font-size:.9rem;cursor:pointer;border:none;transition:all .2s;font-family:inherit}
.btn-primary{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;flex:1;min-width:180px}
.btn-primary:hover{transform:translateY(-1px);box-shadow:0 6px 24px rgba(0,212,255,.3)}
.btn-primary:disabled{opacity:.5;cursor:not-allowed;transform:none;box-shadow:none}
.btn-outline{background:transparent;border:1px solid var(--border);color:var(--text);min-width:120px}
.btn-outline:hover{border-color:var(--primary);color:var(--primary)}
/* PROGRESS */
.progress-bar{width:100%;height:6px;background:var(--surface2);border-radius:3px;overflow:hidden;margin-bottom:1.5rem;display:none}
.progress-bar.visible{display:block}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:3px;transition:width .3s;width:0}
/* WAVEFORM */
.waveform-container{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);padding:1rem;margin-bottom:1.5rem;display:none}
.waveform-container.visible{display:block}
.waveform-label{font-size:.8rem;font-weight:600;color:var(--text2);margin-bottom:.5rem;text-transform:uppercase;letter-spacing:.5px}
.waveform-canvas{width:100%;height:80px;border-radius:8px;display:block;background:var(--surface)}
/* PLAYER */
.player-section{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);padding:1.25rem;margin-bottom:1.5rem;display:none}
.player-section.visible{display:block}
.player-row{display:flex;align-items:center;gap:1rem;flex-wrap:wrap}
.player-row label{font-size:.8rem;font-weight:600;color:var(--text2);text-transform:uppercase;letter-spacing:.5px;min-width:80px}
.player-row audio{flex:1;min-width:200px;height:40px;border-radius:8px}
audio::-webkit-media-controls-panel{background:var(--surface2)}
/* RESULTS */
.results{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem;margin-bottom:1.5rem;display:none}
.results.visible{display:block}
.results h3{font-size:1rem;font-weight:700;margin-bottom:1rem}
.comparison{display:grid;grid-template-columns:1fr auto 1fr;gap:1rem;align-items:center;margin-bottom:1.25rem}
.comp-card{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:1rem;text-align:center}
.comp-card.output{border-color:rgba(0,212,255,.3)}
.comp-label{font-size:.75rem;font-weight:600;color:var(--text2);text-transform:uppercase;letter-spacing:.5px;margin-bottom:.4rem}
.comp-size{font-size:1.4rem;font-weight:800;color:var(--text)}
.comp-format{font-size:.8rem;color:var(--text2);margin-top:.2rem}
.comp-arrow{font-size:1.5rem;color:var(--primary);font-weight:800}
.size-diff{text-align:center;padding:.5rem;border-radius:8px;font-size:.85rem;font-weight:600;margin-bottom:1rem}
.size-diff.smaller{background:rgba(34,197,94,.1);color:var(--green)}
.size-diff.larger{background:rgba(239,68,68,.1);color:var(--red)}
.size-diff.same{background:rgba(148,163,184,.1);color:var(--text2)}
.download-btn{display:inline-flex;align-items:center;gap:.5rem;background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;padding:.75rem 2rem;border-radius:10px;font-weight:700;font-size:.95rem;border:none;cursor:pointer;transition:all .2s;font-family:inherit}
.download-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,212,255,.3)}
/* CTA */
.cta-section{text-align:center;padding:4rem 1.5rem;max-width:700px;margin:0 auto}
.cta-section h2{font-size:1.8rem;font-weight:800;margin-bottom:.75rem}
.cta-section h2 span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.cta-section p{color:var(--text2);margin-bottom:1.5rem}
.cta-btn{display:inline-block;background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;padding:.75rem 2rem;border-radius:10px;font-weight:700;text-decoration:none;font-size:1rem;transition:transform .2s,box-shadow .2s}
.cta-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,212,255,.3)}
/* FOOTER */
.footer{border-top:1px solid var(--border);padding:3rem 2rem 2rem;max-width:1200px;margin:0 auto}
.footer-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:2rem;margin-bottom:2rem}
.footer-col h4{font-size:.85rem;font-weight:700;margin-bottom:.75rem;color:var(--text)}
.footer-col a{display:block;color:var(--text2);text-decoration:none;font-size:.8rem;margin-bottom:.4rem;transition:color .2s}
.footer-col a:hover{color:var(--primary)}
.footer-bottom{text-align:center;color:var(--text2);font-size:.75rem;padding-top:1.5rem;border-top:1px solid var(--border)}
/* FADE IN */
.fade-in{opacity:0;transform:translateY(20px);transition:opacity .6s,transform .6s}
.fade-in.visible{opacity:1;transform:translateY(0)}
/* TOAST */
.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.6rem 1.2rem;border-radius:10px;font-size:.85rem;font-weight:500;z-index:200;transition:transform .3s;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0)}
/* STATUS */
.status-msg{font-size:.85rem;color:var(--text2);text-align:center;margin-bottom:1rem;display:none}
.status-msg.visible{display:block}
.status-msg.error{color:var(--red)}
.status-msg.success{color:var(--green)}
/* RESPONSIVE */
@media(max-width:768px){
  .nav-links{display:none;position:absolute;top:64px;left:0;right:0;background:var(--bg);border-bottom:1px solid var(--border);flex-direction:column;padding:1rem 2rem;gap:1rem}
  .nav-links.open{display:flex}
  .nav-toggle{display:block}
  .hero h1{font-size:1.6rem}
  .footer-grid{grid-template-columns:1fr}
  .settings.visible{grid-template-columns:1fr}
  .comparison{grid-template-columns:1fr;text-align:center}
  .comp-arrow{transform:rotate(90deg)}
  .drop-zone{padding:2rem 1rem}
}
</style>
</head>
<body>

<nav class="nav">
  <a href="/" class="nav-logo">ANIMA</a>
  <button class="nav-toggle" onclick="document.querySelector('.nav-links').classList.toggle('open')" aria-label="Menu">&#9776;</button>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Tools</a>
    <a href="/free-tools/">Free Tools</a>
    <a href="/blog/">Blog</a>
    <a href="https://github.com/christian140903-sudo/nextool" class="nav-cta" target="_blank" rel="noopener">GitHub</a>
  </div>
</nav>

<section class="hero fade-in">
  <h1>Free <span>Audio Converter</span> Online</h1>
  <p class="tool-summary" style="color:#94a3b8;font-size:15px;line-height:1.6;margin-bottom:24px;max-width:700px;margin-left:auto;margin-right:auto;">Convert audio files between MP3, WAV, OGG, FLAC, AAC, M4A, and WebM formats entirely in your browser. Change sample rate, toggle mono/stereo, preview with waveform visualization. No upload to any server — 100% client-side and free.</p>
</section>

<div class="tool-container fade-in">
  <!-- Drop Zone -->
  <div class="drop-zone" id="dropZone" onclick="document.getElementById('fileInput').click()">
    <div class="drop-icon">&#127925;</div>
    <div class="drop-text">Drop an audio file here or click to browse</div>
    <div class="drop-sub">Supports MP3, WAV, OGG, FLAC, AAC, M4A, WebM — up to 500MB</div>
    <input type="file" id="fileInput" class="file-input" accept="audio/*,.mp3,.wav,.ogg,.flac,.aac,.m4a,.webm">
  </div>

  <!-- File Info -->
  <div class="file-info" id="fileInfo">
    <div class="file-info-row">
      <div class="file-name" id="fileName"></div>
      <div class="file-meta">
        <span id="fileSize"></span>
        <span id="fileType"></span>
        <span id="fileDuration"></span>
      </div>
    </div>
  </div>

  <!-- Settings -->
  <div class="settings" id="settings">
    <div class="setting-group">
      <label>Output Format</label>
      <select id="outputFormat">
        <option value="wav">WAV (Uncompressed)</option>
        <option value="webm">WebM (Opus)</option>
        <option value="ogg">OGG (Vorbis)</option>
      </select>
    </div>
    <div class="setting-group">
      <label>Sample Rate</label>
      <select id="sampleRate">
        <option value="44100" selected>44,100 Hz (CD Quality)</option>
        <option value="48000">48,000 Hz (Studio)</option>
        <option value="22050">22,050 Hz (Low)</option>
        <option value="16000">16,000 Hz (Voice)</option>
        <option value="8000">8,000 Hz (Telephone)</option>
      </select>
    </div>
    <div class="setting-group">
      <label>Channels</label>
      <select id="channels">
        <option value="2" selected>Stereo (2ch)</option>
        <option value="1">Mono (1ch)</option>
      </select>
    </div>
  </div>

  <!-- Convert Row -->
  <div class="convert-row" id="convertRow">
    <button class="btn btn-primary" id="convertBtn" onclick="convertAudio()">Convert Audio</button>
    <button class="btn btn-outline" onclick="resetAll()">Reset</button>
  </div>

  <!-- Status -->
  <div class="status-msg" id="statusMsg"></div>

  <!-- Progress -->
  <div class="progress-bar" id="progressBar">
    <div class="progress-fill" id="progressFill"></div>
  </div>

  <!-- Waveform - Original -->
  <div class="waveform-container" id="waveformOriginal">
    <div class="waveform-label">Original Waveform</div>
    <canvas class="waveform-canvas" id="canvasOriginal"></canvas>
  </div>

  <!-- Waveform - Converted -->
  <div class="waveform-container" id="waveformConverted">
    <div class="waveform-label">Converted Waveform</div>
    <canvas class="waveform-canvas" id="canvasConverted"></canvas>
  </div>

  <!-- Player Section -->
  <div class="player-section" id="playerSection">
    <div class="player-row" style="margin-bottom:.75rem">
      <label>Original</label>
      <audio id="playerOriginal" controls></audio>
    </div>
    <div class="player-row" id="playerConvertedRow" style="display:none">
      <label>Converted</label>
      <audio id="playerConverted" controls></audio>
    </div>
  </div>

  <!-- Results -->
  <div class="results" id="results">
    <h3>Conversion Result</h3>
    <div class="comparison">
      <div class="comp-card">
        <div class="comp-label">Original</div>
        <div class="comp-size" id="origSize"></div>
        <div class="comp-format" id="origFormat"></div>
      </div>
      <div class="comp-arrow">&rarr;</div>
      <div class="comp-card output">
        <div class="comp-label">Converted</div>
        <div class="comp-size" id="convSize"></div>
        <div class="comp-format" id="convFormat"></div>
      </div>
    </div>
    <div class="size-diff" id="sizeDiff"></div>
    <div style="text-align:center">
      <button class="download-btn" id="downloadBtn" onclick="downloadConverted()">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
        Download Converted File
      </button>
    </div>
  </div>
</div>

<section class="cta-section fade-in">
  <h2>Need something <span>more powerful</span>?</h2>
  <p>Let us build it for you. Custom APIs, dashboards, automations &mdash; whatever you need.</p>
  <a href="/#contact" class="cta-btn">Start a Project &rarr;</a>
</section>

<!-- Cross Promo -->
<section style="max-width:900px;margin:40px auto;padding:0 24px;">
<div style="background:linear-gradient(135deg,rgba(0,212,255,0.1),rgba(168,85,247,0.08));border:1px solid rgba(0,212,255,0.15);border-radius:20px;padding:32px 28px;text-align:center;">
<div style="font-size:13px;color:#818cf8;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Founding Member</div>
<h3 style="font-size:22px;font-weight:800;color:#fff;margin:0 0 8px;">ANIMA on GitHub</h3>
<p style="color:#94a3b8;font-size:14px;margin:0 auto 20px;max-width:500px;">248+ free tools. No signup. Open source. Built by Christian Bucher.</p>
<div style="display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;">
<a href="/about/" style="display:inline-block;padding:12px 28px;background:linear-gradient(135deg,#00d4ff,#a855f7,#ec4899);color:#fff;border-radius:10px;font-weight:700;font-size:15px;text-decoration:none;">GitHub</a>
<a href="/free-tools/" style="color:#94a3b8;font-size:14px;text-decoration:none;">Browse 250+ Free Tools &rarr;</a>
</div>
</div>
</section>


<!-- AUTO-LINKED by ANIMA Engine -->
<div style="margin:2rem 0;padding:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius)">
<p style="font-weight:600;margin-bottom:.5rem">Related Tools</p>
<p><a href="/free-tools/box-shadow-generator.html" style="color:var(--primary);text-decoration:none">CSS Box Shadow Generator</a> · <a href="/free-tools/emoji-picker.html" style="color:var(--primary);text-decoration:none">Emoji Picker & Search</a> · <a href="/free-tools/json-to-yaml-converter.html" style="color:var(--primary);text-decoration:none">Free JSON to YAML Converter</a></p>
</div>
<footer class="footer fade-in">
  <div class="footer-grid">
    <div class="footer-col">
      <h4>Products</h4>
      <a href="/free-tools/">250+ Free Tools</a>
<a href="/about/">About</a>
<a href="/docs/">Documentation</a>
    </div>
    <div class="footer-col">
      <h4>Explore</h4>
      <a href="/free-tools/">Free Tools</a><a href="/blog/">Blog</a><a href="/about/">FAQ</a><a href="/about/">About</a>
    </div>
    <div class="footer-col">
      <h4>Ecosystem</h4>
      <a href="/">ANIMA Home</a><a href="/#contact">Contact</a><a href="https://github.com/christian140903-sudo/nextool" target="_blank">GitHub</a>
    </div>
  </div>
  <div class="footer-bottom">&copy; 2026 ANIMA. AI-powered tools for everyone.</div>
</footer>

<div class="toast" id="toast"></div>

<script>
/* State */
let originalFile = null;
let originalBuffer = null;
let convertedBlob = null;
let convertedUrl = null;
let originalUrl = null;

/* Elements */
const dropZone = document.getElementById('dropZone');
const fileInput = document.getElementById('fileInput');
const fileInfo = document.getElementById('fileInfo');
const settings = document.getElementById('settings');
const convertRow = document.getElementById('convertRow');
const convertBtn = document.getElementById('convertBtn');
const progressBar = document.getElementById('progressBar');
const progressFill = document.getElementById('progressFill');
const statusMsg = document.getElementById('statusMsg');
const playerSection = document.getElementById('playerSection');
const playerOriginal = document.getElementById('playerOriginal');
const playerConverted = document.getElementById('playerConverted');
const playerConvertedRow = document.getElementById('playerConvertedRow');
const results = document.getElementById('results');
const waveformOriginal = document.getElementById('waveformOriginal');
const waveformConverted = document.getElementById('waveformConverted');

/* Drag & Drop */
dropZone.addEventListener('dragover', function(e) {
  e.preventDefault();
  dropZone.classList.add('drag-over');
});
dropZone.addEventListener('dragleave', function() {
  dropZone.classList.remove('drag-over');
});
dropZone.addEventListener('drop', function(e) {
  e.preventDefault();
  dropZone.classList.remove('drag-over');
  if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
});
fileInput.addEventListener('change', function() {
  if (fileInput.files.length) handleFile(fileInput.files[0]);
});

function handleFile(file) {
  if (!file.type.startsWith('audio/') && !isAudioExt(file.name)) {
    setStatus('Please select a valid audio file.', 'error');
    return;
  }
  originalFile = file;
  if (originalUrl) URL.revokeObjectURL(originalUrl);
  if (convertedUrl) URL.revokeObjectURL(convertedUrl);
  convertedBlob = null;
  convertedUrl = null;

  originalUrl = URL.createObjectURL(file);
  playerOriginal.src = originalUrl;

  /* Show file info */
  document.getElementById('fileName').textContent = file.name;
  document.getElementById('fileSize').textContent = formatBytes(file.size);
  document.getElementById('fileType').textContent = getExt(file.name).toUpperCase();
  fileInfo.classList.add('visible');

  /* Get duration */
  const tempAudio = new Audio();
  tempAudio.src = originalUrl;
  tempAudio.addEventListener('loadedmetadata', function() {
    document.getElementById('fileDuration').textContent = formatDuration(tempAudio.duration);
  });

  /* Decode and show waveform */
  setStatus('Decoding audio...', '');
  const reader = new FileReader();
  reader.onload = function() {
    const actx = new (window.AudioContext || window.webkitAudioContext)();
    actx.decodeAudioData(reader.result, function(buffer) {
      originalBuffer = buffer;
      drawWaveform(buffer, document.getElementById('canvasOriginal'));
      waveformOriginal.classList.add('visible');
      setStatus('');
      dropZone.classList.add('has-file');
    }, function(err) {
      setStatus('Could not decode audio. The format may not be supported by your browser.', 'error');
      console.error('Decode error:', err);
    });
    actx.close();
  };
  reader.readAsArrayBuffer(file);

  /* Show UI */
  settings.classList.add('visible');
  convertRow.classList.add('visible');
  playerSection.classList.add('visible');
  playerConvertedRow.style.display = 'none';
  results.classList.remove('visible');
  waveformConverted.classList.remove('visible');
  convertBtn.disabled = false;
}

function isAudioExt(name) {
  return /\.(mp3|wav|ogg|flac|aac|m4a|webm|opus|wma|aiff)$/i.test(name);
}

function getExt(name) {
  var m = name.match(/\.(\w+)$/);
  return m ? m[1] : 'unknown';
}

/* Conversion */
async function convertAudio() {
  if (!originalBuffer) {
    setStatus('No audio loaded. Please select a file first.', 'error');
    return;
  }

  convertBtn.disabled = true;
  setStatus('Converting...', '');
  showProgress(true);
  setProgress(10);

  const format = document.getElementById('outputFormat').value;
  const targetSR = parseInt(document.getElementById('sampleRate').value);
  const targetCh = parseInt(document.getElementById('channels').value);

  try {
    /* Resample using OfflineAudioContext */
    const srcLen = originalBuffer.length;
    const srcSR = originalBuffer.sampleRate;
    const srcCh = originalBuffer.numberOfChannels;
    const duration = originalBuffer.duration;
    const outLen = Math.ceil(duration * targetSR);

    setProgress(20);

    const offCtx = new OfflineAudioContext(targetCh, outLen, targetSR);
    const source = offCtx.createBufferSource();
    source.buffer = originalBuffer;

    /* Channel handling */
    if (targetCh !== srcCh) {
      if (targetCh === 1 && srcCh > 1) {
        const merger = offCtx.createChannelMerger(1);
        source.connect(merger);
        merger.connect(offCtx.destination);
      } else if (targetCh === 2 && srcCh === 1) {
        const splitter = offCtx.createChannelSplitter(1);
        const merger = offCtx.createChannelMerger(2);
        source.connect(splitter);
        splitter.connect(merger, 0, 0);
        splitter.connect(merger, 0, 1);
        merger.connect(offCtx.destination);
      } else {
        source.connect(offCtx.destination);
      }
    } else {
      source.connect(offCtx.destination);
    }

    source.start(0);
    setProgress(40);

    const renderedBuffer = await offCtx.startRendering();
    setProgress(60);

    /* Encode to target format */
    let blob;
    if (format === 'wav') {
      blob = audioBufferToWav(renderedBuffer);
      setProgress(90);
    } else {
      /* Use MediaRecorder for WebM/OGG */
      blob = await encodeWithMediaRecorder(renderedBuffer, format);
      setProgress(90);
    }

    if (convertedUrl) URL.revokeObjectURL(convertedUrl);
    convertedBlob = blob;
    convertedUrl = URL.createObjectURL(blob);

    /* Show converted player */
    playerConverted.src = convertedUrl;
    playerConvertedRow.style.display = 'flex';

    /* Draw converted waveform */
    drawWaveform(renderedBuffer, document.getElementById('canvasConverted'));
    waveformConverted.classList.add('visible');

    /* Show results */
    document.getElementById('origSize').textContent = formatBytes(originalFile.size);
    document.getElementById('origFormat').textContent = getExt(originalFile.name).toUpperCase() + ' | ' + originalBuffer.sampleRate + ' Hz | ' + originalBuffer.numberOfChannels + 'ch';
    document.getElementById('convSize').textContent = formatBytes(blob.size);
    document.getElementById('convFormat').textContent = format.toUpperCase() + ' | ' + targetSR + ' Hz | ' + targetCh + 'ch';

    const diff = blob.size - originalFile.size;
    const pct = ((diff / originalFile.size) * 100).toFixed(1);
    const diffEl = document.getElementById('sizeDiff');
    if (diff < 0) {
      diffEl.className = 'size-diff smaller';
      diffEl.textContent = formatBytes(Math.abs(diff)) + ' smaller (' + Math.abs(pct) + '% reduction)';
    } else if (diff > 0) {
      diffEl.className = 'size-diff larger';
      diffEl.textContent = formatBytes(diff) + ' larger (+' + pct + '%)';
    } else {
      diffEl.className = 'size-diff same';
      diffEl.textContent = 'Same file size';
    }

    results.classList.add('visible');
    setProgress(100);
    setStatus('Conversion complete!', 'success');

    setTimeout(function() { showProgress(false); }, 500);
  } catch (err) {
    setStatus('Conversion failed: ' + err.message, 'error');
    showProgress(false);
    console.error(err);
  }

  convertBtn.disabled = false;
}

/* WAV encoding */
function audioBufferToWav(buffer) {
  const numCh = buffer.numberOfChannels;
  const sampleRate = buffer.sampleRate;
  const format = 1; /* PCM */
  const bitDepth = 16;
  const channels = [];
  for (let i = 0; i < numCh; i++) {
    channels.push(buffer.getChannelData(i));
  }
  const numSamples = buffer.length;
  const bytesPerSample = bitDepth / 8;
  const blockAlign = numCh * bytesPerSample;
  const dataSize = numSamples * blockAlign;
  const headerSize = 44;
  const arrayBuffer = new ArrayBuffer(headerSize + dataSize);
  const view = new DataView(arrayBuffer);

  /* RIFF header */
  writeString(view, 0, 'RIFF');
  view.setUint32(4, 36 + dataSize, true);
  writeString(view, 8, 'WAVE');
  writeString(view, 12, 'fmt ');
  view.setUint32(16, 16, true);
  view.setUint16(20, format, true);
  view.setUint16(22, numCh, true);
  view.setUint32(24, sampleRate, true);
  view.setUint32(28, sampleRate * blockAlign, true);
  view.setUint16(32, blockAlign, true);
  view.setUint16(34, bitDepth, true);
  writeString(view, 36, 'data');
  view.setUint32(40, dataSize, true);

  /* Interleave samples */
  let offset = 44;
  for (let i = 0; i < numSamples; i++) {
    for (let ch = 0; ch < numCh; ch++) {
      let sample = channels[ch][i];
      sample = Math.max(-1, Math.min(1, sample));
      sample = sample < 0 ? sample * 0x8000 : sample * 0x7FFF;
      view.setInt16(offset, sample, true);
      offset += 2;
    }
  }

  return new Blob([arrayBuffer], { type: 'audio/wav' });
}

function writeString(view, offset, string) {
  for (let i = 0; i < string.length; i++) {
    view.setUint8(offset + i, string.charCodeAt(i));
  }
}

/* MediaRecorder encoding for WebM/OGG */
function encodeWithMediaRecorder(audioBuffer, format) {
  return new Promise(function(resolve, reject) {
    const actx = new AudioContext({ sampleRate: audioBuffer.sampleRate });
    const source = actx.createBufferSource();
    source.buffer = audioBuffer;

    const dest = actx.createMediaStreamDestination();
    source.connect(dest);

    /* Determine MIME */
    let mimeType;
    if (format === 'ogg') {
      if (MediaRecorder.isTypeSupported('audio/ogg;codecs=vorbis')) {
        mimeType = 'audio/ogg;codecs=vorbis';
      } else if (MediaRecorder.isTypeSupported('audio/ogg;codecs=opus')) {
        mimeType = 'audio/ogg;codecs=opus';
      } else if (MediaRecorder.isTypeSupported('audio/webm;codecs=opus')) {
        mimeType = 'audio/webm;codecs=opus';
      } else {
        mimeType = '';
      }
    } else {
      if (MediaRecorder.isTypeSupported('audio/webm;codecs=opus')) {
        mimeType = 'audio/webm;codecs=opus';
      } else if (MediaRecorder.isTypeSupported('audio/webm')) {
        mimeType = 'audio/webm';
      } else {
        mimeType = '';
      }
    }

    const options = mimeType ? { mimeType: mimeType } : {};
    let recorder;
    try {
      recorder = new MediaRecorder(dest.stream, options);
    } catch (e) {
      /* Fallback: use WAV instead */
      actx.close();
      resolve(audioBufferToWav(audioBuffer));
      return;
    }

    const chunks = [];
    recorder.ondataavailable = function(e) {
      if (e.data.size > 0) chunks.push(e.data);
    };
    recorder.onstop = function() {
      actx.close();
      const finalMime = format === 'ogg' ? 'audio/ogg' : 'audio/webm';
      resolve(new Blob(chunks, { type: finalMime }));
    };
    recorder.onerror = function(e) {
      actx.close();
      reject(new Error('MediaRecorder error: ' + (e.error ? e.error.message : 'unknown')));
    };

    recorder.start();
    source.start(0);

    source.onended = function() {
      setTimeout(function() {
        if (recorder.state !== 'inactive') recorder.stop();
      }, 100);
    };
  });
}

/* Waveform drawing */
function drawWaveform(buffer, canvas) {
  const ctx = canvas.getContext('2d');
  const dpr = window.devicePixelRatio || 1;
  const rect = canvas.getBoundingClientRect();
  canvas.width = rect.width * dpr;
  canvas.height = rect.height * dpr;
  ctx.scale(dpr, dpr);

  const width = rect.width;
  const height = rect.height;
  const data = buffer.getChannelData(0);
  const step = Math.ceil(data.length / width);
  const amp = height / 2;

  ctx.clearRect(0, 0, width, height);

  /* Gradient fill */
  const grad = ctx.createLinearGradient(0, 0, width, 0);
  grad.addColorStop(0, '#00d4ff');
  grad.addColorStop(0.5, '#a855f7');
  grad.addColorStop(1, '#ec4899');

  ctx.fillStyle = grad;
  ctx.globalAlpha = 0.8;

  for (let i = 0; i < width; i++) {
    let min = 1.0;
    let max = -1.0;
    const start = Math.floor(i * step);
    const end = Math.min(start + step, data.length);
    for (let j = start; j < end; j++) {
      const val = data[j];
      if (val < min) min = val;
      if (val > max) max = val;
    }
    const y = (1 + min) * amp;
    const h = Math.max(1, (max - min) * amp);
    ctx.fillRect(i, y, 1, h);
  }
  ctx.globalAlpha = 1;
}

/* Download */
function downloadConverted() {
  if (!convertedBlob) return;
  const format = document.getElementById('outputFormat').value;
  const baseName = originalFile.name.replace(/\.\w+$/, '');
  const ext = format === 'ogg' ? 'ogg' : format === 'webm' ? 'webm' : 'wav';
  const a = document.createElement('a');
  a.href = convertedUrl;
  a.download = baseName + '_converted.' + ext;
  a.click();
  showToast('Downloaded ' + baseName + '_converted.' + ext);
}

/* Reset */
function resetAll() {
  if (originalUrl) URL.revokeObjectURL(originalUrl);
  if (convertedUrl) URL.revokeObjectURL(convertedUrl);
  originalFile = null;
  originalBuffer = null;
  convertedBlob = null;
  convertedUrl = null;
  originalUrl = null;
  fileInput.value = '';
  playerOriginal.src = '';
  playerConverted.src = '';
  fileInfo.classList.remove('visible');
  settings.classList.remove('visible');
  convertRow.classList.remove('visible');
  playerSection.classList.remove('visible');
  results.classList.remove('visible');
  waveformOriginal.classList.remove('visible');
  waveformConverted.classList.remove('visible');
  dropZone.classList.remove('has-file');
  playerConvertedRow.style.display = 'none';
  setStatus('');
  showProgress(false);
}

/* Helpers */
function formatBytes(bytes) {
  if (bytes === 0) return '0 B';
  var k = 1024, sizes = ['B', 'KB', 'MB', 'GB'];
  var i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
}

function formatDuration(sec) {
  if (!sec || !isFinite(sec)) return '';
  var m = Math.floor(sec / 60);
  var s = Math.floor(sec % 60);
  return m + ':' + (s < 10 ? '0' : '') + s;
}

function setStatus(msg, type) {
  statusMsg.textContent = msg;
  statusMsg.className = 'status-msg' + (msg ? ' visible' : '') + (type ? ' ' + type : '');
}

function showProgress(show) {
  progressBar.classList.toggle('visible', show);
  if (!show) progressFill.style.width = '0';
}

function setProgress(pct) {
  progressFill.style.width = pct + '%';
}

function showToast(msg) {
  var t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(function() { t.classList.remove('show'); }, 2500);
}

/* IntersectionObserver fade-in */
var observer = new IntersectionObserver(function(entries) {
  entries.forEach(function(entry) {
    if (entry.isIntersecting) { entry.target.classList.add('visible'); observer.unobserve(entry.target); }
  });
}, { threshold: 0.1 });
document.querySelectorAll('.fade-in').forEach(function(el) { observer.observe(el); });

/* Resize waveforms on window resize */
window.addEventListener('resize', function() {
  if (originalBuffer && waveformOriginal.classList.contains('visible')) {
    drawWaveform(originalBuffer, document.getElementById('canvasOriginal'));
  }
});
</script>
<script src="/js/analytics-lite.js" defer></script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What audio formats can I convert with this tool?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "ANIMA's Audio Converter accepts MP3, WAV, OGG, FLAC, AAC, M4A, and WebM input files. It can output to WAV (uncompressed PCM), WebM (Opus codec), and OGG (Vorbis/Opus codec). All conversion happens entirely in your browser using the Web Audio API."
      }
    },
    {
      "@type": "Question",
      "name": "Is this audio converter really free and private?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, ANIMA's Audio Converter is 100% free with no signup required. Your audio files never leave your device — all processing happens client-side in your browser using the Web Audio API and MediaRecorder API. No data is uploaded to any server."
      }
    },
    {
      "@type": "Question",
      "name": "Can I change the sample rate and channels when converting?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, you can select a target sample rate (8,000 Hz, 16,000 Hz, 22,050 Hz, 44,100 Hz, or 48,000 Hz) and choose between mono and stereo output. The tool uses OfflineAudioContext for high-quality resampling."
      }
    },
    {
      "@type": "Question",
      "name": "Why is the WAV output file larger than the original MP3?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "WAV is an uncompressed audio format, so it stores every audio sample without compression. An MP3 file is lossy-compressed, typically 5-10x smaller than equivalent WAV. If you need a smaller file, try converting to WebM or OGG format instead."
      }
    },
    {
      "@type": "Question",
      "name": "What browsers support this audio converter?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "This tool works in all modern browsers including Chrome, Firefox, Edge, and Safari. WAV output is universally supported. WebM and OGG output use the MediaRecorder API, which has the best support in Chrome and Firefox. Safari has limited MediaRecorder support."
      }
    }
  ]
}
</script>
</body>
</html>

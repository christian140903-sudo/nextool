<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>.htaccess Generator - Free Tool | NexTool</title>
<meta name="description" content="Generate .htaccess rules easily. HTTPS redirect, caching, GZIP, security headers, custom error pages and more. Free online tool by NexTool.">
<meta name="keywords" content="htaccess generator, Apache configuration, HTTPS redirect, GZIP compression, browser caching, security headers, NexTool">
<meta property="og:title" content="Free .htaccess Generator | NexTool">
<meta property="og:description" content="Build your .htaccess configuration with toggles. No manual editing needed.">
<meta property="og:type" content="website">
<meta property="og:image" content="https://nextool.app/assets/og-default.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free .htaccess Generator | NexTool">
<meta name="twitter:description" content="Build your .htaccess configuration with toggles. No manual editing needed.">
<link rel="canonical" href="https://nextool.app/free-tools/htaccess-generator.html">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"NexTool .htaccess Generator","applicationCategory":"UtilityApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"description":"Generate .htaccess rules easily with toggles for HTTPS redirect, caching, GZIP, security headers, custom error pages."}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#050508;--surface:#111118;--surface2:#1a1a24;--surface3:#222233;
  --primary:#6366f1;--accent:#a855f7;--pink:#ec4899;
  --text:#e2e8f0;--text2:#94a3b8;--border:#252533;
  --radius:12px;--green:#22c55e;--glass:rgba(17,17,24,.7)
}
html{scroll-behavior:smooth}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:flex;flex-direction:column;line-height:1.6;overflow-x:hidden}
a{color:var(--primary);text-decoration:none;transition:color .2s}a:hover{color:var(--accent)}

/* NAV */
.nav{position:sticky;top:0;z-index:100;backdrop-filter:blur(20px);background:rgba(5,5,8,.85);border-bottom:1px solid var(--border);padding:0 24px}
.nav-inner{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;height:64px}
.logo{font-weight:800;font-size:1.35rem;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.nav-links{display:flex;gap:28px;align-items:center;list-style:none}
.nav-links a{color:var(--text2);font-size:.9rem;font-weight:500;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-links a.active{color:var(--primary)}
.nav-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}

/* HERO */
.hero{text-align:center;padding:72px 24px 36px;max-width:800px;margin:0 auto}
.hero .badge{display:inline-block;padding:6px 16px;border-radius:20px;background:var(--surface);border:1px solid var(--border);font-size:.8rem;color:var(--accent);font-weight:600;margin-bottom:20px}
.hero h1{font-size:clamp(2rem,5vw,2.8rem);font-weight:800;line-height:1.15;margin-bottom:14px}
.hero h1 .grad{background:linear-gradient(135deg,var(--primary),var(--accent),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--text2);font-size:1.05rem;max-width:560px;margin:0 auto}

/* MAIN LAYOUT */
.tool-section{max-width:1200px;width:100%;margin:0 auto;padding:0 24px 60px}
.layout{display:grid;grid-template-columns:1fr 1fr;gap:24px}
.card{background:var(--glass);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:var(--radius);padding:28px;margin-bottom:20px;transition:box-shadow .3s}
.card:hover{box-shadow:0 8px 40px rgba(99,102,241,.08)}
.card-title{font-size:1.05rem;font-weight:700;margin-bottom:16px;display:flex;align-items:center;gap:10px}
.card-title .icon{font-size:1.1rem}
.card-badge{font-size:.68rem;background:var(--green);color:#000;padding:2px 8px;border-radius:4px;font-weight:700}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.fade-in{opacity:0;transform:translateY(24px);transition:opacity .6s,transform .6s}
.fade-in.visible{opacity:1;transform:translateY(0)}

/* RULE ITEMS */
.rule-item{display:flex;align-items:flex-start;gap:12px;padding:12px 14px;background:var(--surface2);border:1px solid var(--border);border-radius:8px;margin-bottom:8px;transition:border-color .2s,background .2s;cursor:pointer}
.rule-item:hover{border-color:var(--primary);background:rgba(99,102,241,.03)}
.rule-item input[type="checkbox"]{margin-top:4px;accent-color:var(--primary);width:18px;height:18px;cursor:pointer;flex-shrink:0;border-radius:4px}
.rule-info{flex:1}
.rule-name{font-size:.88rem;font-weight:600;color:var(--text)}
.rule-desc{font-size:.78rem;color:var(--text2);margin-top:3px;line-height:1.5}
.rule-extra{margin-top:10px;display:none}
.rule-extra.visible{display:block}
.rule-extra input,.rule-extra textarea{width:100%;background:var(--bg);border:1px solid var(--border);color:var(--text);padding:8px 12px;border-radius:6px;font-family:inherit;font-size:.85rem;outline:none;margin-top:6px;transition:border-color .2s}
.rule-extra input:focus,.rule-extra textarea:focus{border-color:var(--primary)}
.rule-extra textarea{resize:vertical;min-height:64px;font-family:'SF Mono','Fira Code',Consolas,monospace;font-size:.8rem;line-height:1.5}
.rule-extra label{font-size:.75rem;color:var(--text2);margin-top:8px;display:block;font-weight:600}

/* OUTPUT */
.output-col{position:sticky;top:88px;align-self:start}
.code-area{background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:18px;font-family:'SF Mono','Fira Code',Consolas,monospace;font-size:.8rem;color:var(--green);white-space:pre-wrap;word-break:break-word;max-height:65vh;overflow-y:auto;line-height:1.7;min-height:220px}
.code-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.code-lang{font-size:.72rem;font-weight:600;color:var(--accent);text-transform:uppercase;letter-spacing:1px}

/* BUTTONS */
.btn{padding:10px 20px;border:none;border-radius:8px;font-family:inherit;font-size:.88rem;font-weight:600;cursor:pointer;transition:all .2s;display:inline-flex;align-items:center;gap:6px}
.btn-primary{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;box-shadow:0 2px 12px rgba(99,102,241,.25)}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(99,102,241,.4)}
.btn-secondary{background:var(--surface2);color:var(--text);border:1px solid var(--border)}
.btn-secondary:hover{border-color:var(--primary);color:var(--primary)}
.btn-danger{background:rgba(220,38,38,.15);color:#f87171;border:1px solid rgba(220,38,38,.3)}
.btn-danger:hover{background:rgba(220,38,38,.25)}
.btn-sm{padding:7px 14px;font-size:.8rem}
.btn-row{display:flex;gap:8px;margin-top:14px;flex-wrap:wrap}
.line-count{color:var(--text2);font-size:.78rem;margin-top:10px}

/* QUICK SELECT */
.quick-row{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:20px}
.quick-btn{padding:6px 14px;border:1px solid var(--border);background:var(--surface2);color:var(--text2);border-radius:6px;font-size:.78rem;font-weight:600;cursor:pointer;transition:all .2s;font-family:inherit}
.quick-btn:hover{border-color:var(--primary);color:var(--primary)}

/* FOOTER */
footer{border-top:1px solid var(--border);padding:48px 24px 28px;max-width:1200px;margin:0 auto;width:100%}
.footer-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:40px;margin-bottom:32px}
.footer-col h4{font-size:.85rem;font-weight:700;margin-bottom:14px;color:var(--text)}
.footer-col a{display:block;color:var(--text2);font-size:.85rem;margin-bottom:8px;transition:color .2s}
.footer-col a:hover{color:var(--primary)}
.footer-bottom{text-align:center;color:var(--text2);font-size:.8rem;padding-top:20px;border-top:1px solid var(--border)}

/* TOAST */
.toast{position:fixed;bottom:32px;left:50%;transform:translateX(-50%) translateY(80px);background:var(--primary);color:#fff;padding:12px 28px;border-radius:10px;font-weight:600;font-size:.9rem;z-index:200;transition:transform .35s cubic-bezier(.4,0,.2,1);pointer-events:none;box-shadow:0 4px 20px rgba(99,102,241,.4)}
.toast.show{transform:translateX(-50%) translateY(0)}

/* MOBILE */
@media(max-width:900px){
  .layout{grid-template-columns:1fr}
  .output-col{position:static}
}
@media(max-width:768px){
  .nav-links{display:none;position:absolute;top:64px;left:0;right:0;background:var(--surface);border-bottom:1px solid var(--border);flex-direction:column;padding:20px;gap:14px}
  .nav-links.open{display:flex}.nav-toggle{display:block}
  h1{font-size:1.6rem!important}
  .tool-section{padding:0 16px 40px}
  .card{padding:22px 16px}
  .footer-grid{grid-template-columns:1fr 1fr}
}
</style>
</head>
<body>

<nav class="nav">
  <div class="nav-inner">
    <a href="/" class="logo">NexTool</a>
    <button class="nav-toggle" onclick="document.querySelector('.nav-links').classList.toggle('open')" aria-label="Menu">&#9776;</button>
    <ul class="nav-links">
      <li><a href="/">Home</a></li>
      <li><a href="/free-tools/" class="active">Free Tools</a></li>
      <li><a href="/free-tools/">Tools</a></li>
      <li><a href="/pro.html">Pro</a></li>
      <li><a href="/blog/">Blog</a></li>
      <li><a href="/pro.html">Pro — $29</a></li>
    </ul>
  </div>
</nav>

<section class="hero fade-in">
  <div class="badge">Free Tool</div>
  <h1>.htaccess <span class="grad">Generator</span></h1>
  <p>Build your Apache .htaccess configuration visually. Toggle rules on and off, customize parameters, and copy production-ready code.</p>
</section>

<section class="tool-section">
  <!-- Quick Select -->
  <div class="quick-row fade-in">
    <button class="quick-btn" onclick="quickSelect('security')">Security Essentials</button>
    <button class="quick-btn" onclick="quickSelect('performance')">Performance Pack</button>
    <button class="quick-btn" onclick="quickSelect('wordpress')">WordPress Hardened</button>
    <button class="quick-btn" onclick="quickSelect('all')">Select All</button>
    <button class="quick-btn" onclick="quickSelect('none')">Deselect All</button>
  </div>

  <div class="layout">
    <div class="rules-col" id="rulesCol"></div>
    <div class="output-col">
      <div class="card">
        <div class="code-header">
          <div class="card-title" style="margin-bottom:0"><span class="icon">&#128196;</span> Generated .htaccess</div>
          <span class="code-lang">Apache</span>
        </div>
        <div class="code-area" id="codeOutput"># Enable rules on the left to generate your .htaccess</div>
        <p class="line-count" id="lineCount"></p>
        <div class="btn-row">
          <button class="btn btn-primary btn-sm" onclick="copyCode()">Copy Code</button>
          <button class="btn btn-secondary btn-sm" onclick="downloadFile()">Download .htaccess</button>
          <button class="btn btn-danger btn-sm" onclick="resetAll()">Reset All</button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Cross Promo -->n<section style="max-width:900px;margin:40px auto;padding:0 24px;">n<div style="background:linear-gradient(135deg,rgba(99,102,241,0.1),rgba(168,85,247,0.08));border:1px solid rgba(99,102,241,0.15);border-radius:20px;padding:32px 28px;text-align:center;">n<div style="font-size:13px;color:#818cf8;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Founding Member</div>n<h3 style="font-size:22px;font-weight:800;color:#fff;margin:0 0 8px;">Get NexTool Pro</h3>n<p style="color:#94a3b8;font-size:14px;margin:0 auto 20px;max-width:500px;">No banners, clean output, enhanced features on all 150+ tools. One-time payment.</p>n<div style="display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;">n<a href="/pro.html" style="display:inline-block;padding:12px 28px;background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);color:#fff;border-radius:10px;font-weight:700;font-size:15px;text-decoration:none;transition:transform 0.2s;" onmouseenter="this.style.transform='translateY(-2px)'" onmouseleave="this.style.transform='translateY(0)'">$29 — Get Pro</a>n<a href="/free-tools/" style="color:#94a3b8;font-size:14px;text-decoration:none;transition:color 0.2s;" onmouseenter="this.style.color='#e2e8f0'" onmouseleave="this.style.color='#94a3b8'">Browse 150+ Free Tools →</a>n</div>n</div>n</section>
<footer>
  <div class="footer-grid">
    <div class="footer-col"><h4>Products</h4>
      <a href="/free-tools/">150+ Free Tools</a><a href="/pro.html">NexTool Pro — $29</a><a href="/workspace.html">Workspace</a>
    </div>
    <div class="footer-col"><h4>Free Tools</h4>
      <a href="/free-tools/htaccess-generator.html">.htaccess Generator</a><a href="/free-tools/meta-tag-generator.html">Meta Tag Generator</a><a href="/free-tools/hash-generator.html">Hash Generator</a>
    </div>
    <div class="footer-col"><h4>Explore</h4>
      <a href="/free-tools/">All Free Tools</a><a href="/blog/">Blog</a><a href="/pro.html">Pro — $29</a>
    </div>
    <div class="footer-col"><h4>Legal</h4>
      <a href="/terms.html">Privacy Policy</a><a href="/terms.html">Terms of Service</a>
    </div>
  </div>
  <div class="footer-bottom">&copy; 2026 NexTool. All rights reserved.</div>
</footer>

<div class="toast" id="toast">Copied!</div>

<script>
// ========== RULE DEFINITIONS ==========
const rules = [
  { cat: 'Redirects', icon: '&#128268;', items: [
    { id: 'https', name: 'Force HTTPS', desc: 'Redirect all HTTP traffic to HTTPS', tags: ['security'],
      code: () => `RewriteEngine On\nRewriteCond %{HTTPS} off\nRewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]` },
    { id: 'wwwToNon', name: 'www to non-www', desc: 'Remove www prefix from your domain',
      code: () => `RewriteEngine On\nRewriteCond %{HTTP_HOST} ^www\\.(.*)$ [NC]\nRewriteRule ^(.*)$ https://%1/$1 [R=301,L]` },
    { id: 'nonToWww', name: 'non-www to www', desc: 'Add www prefix to your domain',
      code: () => `RewriteEngine On\nRewriteCond %{HTTP_HOST} !^www\\. [NC]\nRewriteRule ^(.*)$ https://www.%{HTTP_HOST}/$1 [R=301,L]` },
    { id: 'trailingSlash', name: 'Add trailing slash', desc: 'Append / to the end of all URLs',
      code: () => `RewriteEngine On\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_URI} !(.*)/$ \nRewriteRule ^(.*)$ %{REQUEST_URI}/ [L,R=301]` },
    { id: 'customRedirect', name: 'Custom redirect', desc: 'Redirect a specific URL to another', extra: [
      { label: 'Old path (e.g. /old-page)', id: 'crFrom', placeholder: '/old-page' },
      { label: 'New URL (e.g. /new-page)', id: 'crTo', placeholder: '/new-page' }
    ], code: () => `Redirect 301 ${gv('crFrom')||'/old-page'} ${gv('crTo')||'/new-page'}` },
  ]},
  { cat: 'Security', icon: '&#128274;', badge: 'Recommended', items: [
    { id: 'secHeaders', name: 'Security headers', desc: 'X-Frame-Options, X-Content-Type, XSS Protection, Referrer Policy, Permissions Policy', tags: ['security'],
      code: () => `<IfModule mod_headers.c>\n  Header always set X-Frame-Options "SAMEORIGIN"\n  Header always set X-Content-Type-Options "nosniff"\n  Header always set X-XSS-Protection "1; mode=block"\n  Header always set Referrer-Policy "strict-origin-when-cross-origin"\n  Header always set Permissions-Policy "camera=(), microphone=(), geolocation=()"\n</IfModule>` },
    { id: 'hsts', name: 'HSTS (Strict Transport)', desc: 'Force HTTPS for 1 year including subdomains with preload', tags: ['security'],
      code: () => `<IfModule mod_headers.c>\n  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"\n</IfModule>` },
    { id: 'csp', name: 'Content Security Policy', desc: 'Basic CSP header to prevent XSS and injection attacks', tags: ['security'],
      code: () => `<IfModule mod_headers.c>\n  Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' https://fonts.gstatic.com"\n</IfModule>` },
    { id: 'blockIps', name: 'Block IP addresses', desc: 'Deny access from specific IP addresses', extra: [
      { label: 'IPs to block (one per line)', id: 'blockIpList', type: 'textarea', placeholder: '192.168.1.1\n10.0.0.1' }
    ], code: () => { const ips = (gv('blockIpList')||'192.168.1.1').split('\n').filter(Boolean).map(ip => `Deny from ${ip.trim()}`).join('\n'); return `Order Allow,Deny\nAllow from all\n${ips}`; } },
    { id: 'hotlink', name: 'Hotlink protection', desc: 'Prevent others from embedding your images on their sites', extra: [
      { label: 'Your domain (e.g. example.com)', id: 'hotlinkDom', placeholder: 'example.com' }
    ], code: () => { const d = gv('hotlinkDom')||'example.com'; return `RewriteEngine On\nRewriteCond %{HTTP_REFERER} !^$\nRewriteCond %{HTTP_REFERER} !^https?://(www\\.)?${d.replace(/\./g,'\\.')}/ [NC]\nRewriteRule \\.(jpg|jpeg|png|gif|svg|webp)$ - [F,NC,L]`; } },
    { id: 'disableDir', name: 'Disable directory listing', desc: 'Prevent browsing folder contents directly', tags: ['security'],
      code: () => `Options -Indexes` },
    { id: 'blockXmlrpc', name: 'Block xmlrpc.php', desc: 'Block common WordPress brute force attack vector', tags: ['wordpress'],
      code: () => `<Files xmlrpc.php>\n  Order Deny,Allow\n  Deny from all\n</Files>` },
    { id: 'hideHtaccess', name: 'Protect .htaccess', desc: 'Deny all access to the .htaccess file itself', tags: ['security'],
      code: () => `<Files .htaccess>\n  Order Allow,Deny\n  Deny from all\n</Files>` },
    { id: 'blockWpLogin', name: 'Restrict wp-login.php', desc: 'Allow wp-login only from your IP (WordPress)', tags: ['wordpress'], extra: [
      { label: 'Your IP address', id: 'wpLoginIp', placeholder: '123.45.67.89' }
    ], code: () => `<Files wp-login.php>\n  Order Deny,Allow\n  Deny from all\n  Allow from ${gv('wpLoginIp')||'123.45.67.89'}\n</Files>` },
  ]},
  { cat: 'Performance', icon: '&#9889;', items: [
    { id: 'gzip', name: 'GZIP compression', desc: 'Compress HTML, CSS, JS, XML, JSON, fonts, and SVG', tags: ['performance'],
      code: () => `<IfModule mod_deflate.c>\n  AddOutputFilterByType DEFLATE text/plain\n  AddOutputFilterByType DEFLATE text/html\n  AddOutputFilterByType DEFLATE text/xml\n  AddOutputFilterByType DEFLATE text/css\n  AddOutputFilterByType DEFLATE application/xml\n  AddOutputFilterByType DEFLATE application/xhtml+xml\n  AddOutputFilterByType DEFLATE application/rss+xml\n  AddOutputFilterByType DEFLATE application/javascript\n  AddOutputFilterByType DEFLATE application/x-javascript\n  AddOutputFilterByType DEFLATE application/json\n  AddOutputFilterByType DEFLATE font/ttf\n  AddOutputFilterByType DEFLATE font/otf\n  AddOutputFilterByType DEFLATE image/svg+xml\n</IfModule>` },
    { id: 'browserCache', name: 'Browser caching', desc: 'Set expiry headers for images, CSS, JS, and fonts', tags: ['performance'],
      code: () => `<IfModule mod_expires.c>\n  ExpiresActive On\n  ExpiresByType image/jpg "access plus 1 year"\n  ExpiresByType image/jpeg "access plus 1 year"\n  ExpiresByType image/gif "access plus 1 year"\n  ExpiresByType image/png "access plus 1 year"\n  ExpiresByType image/webp "access plus 1 year"\n  ExpiresByType image/svg+xml "access plus 1 year"\n  ExpiresByType text/css "access plus 1 month"\n  ExpiresByType application/javascript "access plus 1 month"\n  ExpiresByType text/html "access plus 1 hour"\n  ExpiresByType application/pdf "access plus 1 month"\n  ExpiresByType font/ttf "access plus 1 year"\n  ExpiresByType font/otf "access plus 1 year"\n  ExpiresByType font/woff "access plus 1 year"\n  ExpiresByType font/woff2 "access plus 1 year"\n</IfModule>` },
    { id: 'etag', name: 'Remove ETags', desc: 'Reduce header size by disabling entity tags', tags: ['performance'],
      code: () => `<IfModule mod_headers.c>\n  Header unset ETag\n</IfModule>\nFileETag None` },
    { id: 'keepAlive', name: 'Enable Keep-Alive', desc: 'Keep persistent connections for faster loading', tags: ['performance'],
      code: () => `<IfModule mod_headers.c>\n  Header set Connection keep-alive\n</IfModule>` },
  ]},
  { cat: 'Error Pages', icon: '&#128679;', items: [
    { id: 'error404', name: 'Custom 404 page', desc: 'Show a custom Not Found page', extra: [
      { label: 'Path to 404 page', id: 'e404Path', placeholder: '/404.html' }
    ], code: () => `ErrorDocument 404 ${gv('e404Path')||'/404.html'}` },
    { id: 'error403', name: 'Custom 403 page', desc: 'Show a custom Forbidden page', extra: [
      { label: 'Path to 403 page', id: 'e403Path', placeholder: '/403.html' }
    ], code: () => `ErrorDocument 403 ${gv('e403Path')||'/403.html'}` },
    { id: 'error500', name: 'Custom 500 page', desc: 'Show a custom Server Error page', extra: [
      { label: 'Path to 500 page', id: 'e500Path', placeholder: '/500.html' }
    ], code: () => `ErrorDocument 500 ${gv('e500Path')||'/500.html'}` },
    { id: 'maintenance', name: 'Maintenance mode', desc: 'Show a maintenance page to all visitors except your IP', extra: [
      { label: 'Your IP (bypass maintenance)', id: 'maintIp', placeholder: '123.45.67.89' },
      { label: 'Maintenance page path', id: 'maintPage', placeholder: '/maintenance.html' }
    ], code: () => { const ip = gv('maintIp')||'123.45.67.89'; const pg = gv('maintPage')||'/maintenance.html'; return `RewriteEngine On\nRewriteCond %{REMOTE_ADDR} !^${ip.replace(/\./g,'\\.')}$\nRewriteCond %{REQUEST_URI} !^${pg}$\nRewriteRule ^(.*)$ ${pg} [R=503,L]`; } },
  ]},
  { cat: 'Miscellaneous', icon: '&#128736;', items: [
    { id: 'charset', name: 'Default charset UTF-8', desc: 'Set the default character encoding to UTF-8',
      code: () => `AddDefaultCharset UTF-8` },
    { id: 'serverSig', name: 'Hide server signature', desc: 'Remove Apache version info from error pages',
      code: () => `ServerSignature Off` },
    { id: 'phpSettings', name: 'PHP settings', desc: 'Common PHP limits: upload size, memory, execution time',
      code: () => `php_value upload_max_filesize 64M\nphp_value post_max_size 64M\nphp_value max_execution_time 300\nphp_value max_input_time 300\nphp_value memory_limit 256M\nphp_flag display_errors Off` },
    { id: 'cors', name: 'CORS headers', desc: 'Allow cross-origin requests from specified origins', extra: [
      { label: 'Allowed origin (* for all)', id: 'corsOrigin', placeholder: '*' }
    ], code: () => { const o = gv('corsOrigin')||'*'; return `<IfModule mod_headers.c>\n  Header set Access-Control-Allow-Origin "${o}"\n  Header set Access-Control-Allow-Methods "GET, POST, OPTIONS, PUT, DELETE"\n  Header set Access-Control-Allow-Headers "Content-Type, Authorization"\n</IfModule>`; } },
    { id: 'noSniff', name: 'Force file download', desc: 'Force download for specific file types', extra: [
      { label: 'File extensions (comma separated)', id: 'dlExts', placeholder: 'pdf,zip,doc' }
    ], code: () => { const exts = (gv('dlExts')||'pdf,zip,doc').split(',').map(e => e.trim()).filter(Boolean); return exts.map(ext => `<FilesMatch "\\.${ext}$">\n  ForceType application/octet-stream\n  Header set Content-Disposition attachment\n</FilesMatch>`).join('\n\n'); } },
  ]}
];

// ========== HELPER ==========
function gv(id) { const el = document.getElementById(id); return el ? el.value.trim() : ''; }

// ========== BUILD UI ==========
function buildRulesUI() {
  const col = document.getElementById('rulesCol');
  col.innerHTML = rules.map(cat => `
    <div class="card fade-in">
      <div class="card-title">
        <span class="icon">${cat.icon}</span> ${cat.cat}
        ${cat.badge ? `<span class="card-badge">${cat.badge}</span>` : ''}
      </div>
      ${cat.items.map(item => `
        <div class="rule-item" onclick="toggleCheck(event,'${item.id}')">
          <input type="checkbox" id="cb_${item.id}" onchange="generate()">
          <div class="rule-info">
            <div class="rule-name">${item.name}</div>
            <div class="rule-desc">${item.desc}</div>
            ${item.extra ? `<div class="rule-extra" id="extra_${item.id}">
              ${item.extra.map(e => `
                <label>${e.label}</label>
                ${e.type === 'textarea'
                  ? `<textarea id="${e.id}" placeholder="${e.placeholder || ''}" oninput="generate()"></textarea>`
                  : `<input type="text" id="${e.id}" placeholder="${e.placeholder || ''}" oninput="generate()">`}
              `).join('')}
            </div>` : ''}
          </div>
        </div>
      `).join('')}
    </div>
  `).join('');
}

function toggleCheck(e, id) {
  if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'LABEL') return;
  const cb = document.getElementById(`cb_${id}`);
  cb.checked = !cb.checked;
  generate();
}

// ========== QUICK SELECT ==========
function quickSelect(preset) {
  const securityIds = ['https', 'secHeaders', 'hsts', 'disableDir', 'hideHtaccess'];
  const performanceIds = ['gzip', 'browserCache', 'etag', 'keepAlive'];
  const wordpressIds = [...securityIds, ...performanceIds, 'blockXmlrpc', 'blockWpLogin', 'charset'];

  rules.forEach(cat => cat.items.forEach(item => {
    const cb = document.getElementById(`cb_${item.id}`);
    if (!cb) return;
    switch (preset) {
      case 'all': cb.checked = true; break;
      case 'none': cb.checked = false; break;
      case 'security': cb.checked = securityIds.includes(item.id); break;
      case 'performance': cb.checked = performanceIds.includes(item.id); break;
      case 'wordpress': cb.checked = wordpressIds.includes(item.id); break;
    }
  }));
  generate();
  showToast(`Applied "${preset}" preset`);
}

// ========== GENERATE CODE ==========
function generate() {
  const sections = [];
  let enabledCount = 0;

  rules.forEach(cat => {
    const catSections = [];
    cat.items.forEach(item => {
      const cb = document.getElementById(`cb_${item.id}`);
      const extra = document.getElementById(`extra_${item.id}`);
      if (extra) extra.classList.toggle('visible', cb.checked);
      if (cb.checked) {
        enabledCount++;
        catSections.push(`# ${item.name}\n${item.code()}`);
      }
    });
    if (catSections.length) {
      sections.push(`# ${'='.repeat(40)}\n# ${cat.cat.toUpperCase()}\n# ${'='.repeat(40)}\n\n${catSections.join('\n\n')}`);
    }
  });

  const output = document.getElementById('codeOutput');
  const lineCount = document.getElementById('lineCount');

  if (sections.length === 0) {
    output.textContent = '# Enable rules on the left to generate your .htaccess\n# Use the quick-select buttons for common presets';
    lineCount.textContent = '';
    return;
  }

  const header = `# .htaccess generated by NexTool\n# https://nextool.app/free-tools/htaccess-generator\n# Generated: ${new Date().toISOString().split('T')[0]}\n# Rules enabled: ${enabledCount}`;
  const code = header + '\n\n' + sections.join('\n\n');
  output.textContent = code;
  const lines = code.split('\n').length;
  lineCount.textContent = `${lines} lines | ${enabledCount} rules enabled`;
}

// ========== ACTIONS ==========
function copyCode() {
  const code = document.getElementById('codeOutput').textContent;
  navigator.clipboard.writeText(code).then(() => showToast('Copied to clipboard'));
}

function downloadFile() {
  const code = document.getElementById('codeOutput').textContent;
  const blob = new Blob([code], { type: 'text/plain' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = '.htaccess';
  a.click();
  URL.revokeObjectURL(a.href);
  showToast('Downloaded .htaccess');
}

function resetAll() {
  rules.forEach(cat => cat.items.forEach(item => {
    const cb = document.getElementById(`cb_${item.id}`);
    if (cb) cb.checked = false;
    const extra = document.getElementById(`extra_${item.id}`);
    if (extra) extra.classList.remove('visible');
  }));
  generate();
  showToast('All rules reset');
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2200);
}

// ========== INIT ==========
function init() {
  buildRulesUI();
  generate();
  // IntersectionObserver
  const obs = new IntersectionObserver(entries => {
    entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add('visible'); obs.unobserve(e.target); } });
  }, { threshold: 0.1 });
  document.querySelectorAll('.fade-in').forEach(el => obs.observe(el));
}

init();
</script>
<script src="/js/analytics-lite.js" defer></script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Word to PDF Converter — DOCX to PDF Online | NexTool</title>
<meta name="description" content="Convert Word DOCX files to PDF instantly in your browser. Preserves formatting, headings, tables, images. Batch convert, preview, and download. 100% free, no upload.">
<meta name="keywords" content="word to pdf, docx to pdf, convert word to pdf, word to pdf converter, docx converter, free pdf converter, NexTool">
<meta name="robots" content="index, follow">
<meta property="og:title" content="Free Word to PDF Converter — DOCX to PDF Online | NexTool">
<meta property="og:description" content="Convert Word DOCX files to PDF instantly. Preserves formatting, tables, images. 100% client-side, no upload needed.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/word-to-pdf.html">
<meta property="og:image" content="https://nextool.app/assets/og-default.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<link rel="canonical" href="https://nextool.app/free-tools/word-to-pdf.html">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free Word to PDF Converter — DOCX to PDF Online | NexTool">
<meta name="twitter:description" content="Convert Word DOCX files to PDF instantly. Free online tool by NexTool.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"NexTool Word to PDF Converter","applicationCategory":"UtilitiesApplication","operatingSystem":"Web","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"description":"Free online tool to convert Word DOCX files to PDF. Preserves formatting, headings, tables, and images. Runs 100% in your browser."}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--border:#2a2a3a;--text:#e4e4eb;--text2:#9494a8;--primary:#6366f1;--accent:#a855f7;--pink:#ec4899;--green:#22c55e;--red:#ef4444;--cyan:#22d3ee;--yellow:#eab308;--radius:12px;--glass:rgba(17,17,24,0.7)}
html{scroll-behavior:smooth}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;overflow-x:hidden}
/* NAV */
.nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between}
.nav-logo{font-size:1.4rem;font-weight:800;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-decoration:none}
.nav-links{display:flex;align-items:center;gap:1.5rem}
.nav-links a{color:var(--text2);text-decoration:none;font-size:.875rem;font-weight:500;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.nav-cta{background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff!important;padding:.5rem 1.2rem;border-radius:8px;font-weight:600;-webkit-text-fill-color:#fff!important}
.nav-cta:hover{opacity:.9}
.nav-toggle{display:none;background:none;border:none;color:var(--text);font-size:1.5rem;cursor:pointer}
/* HERO */
.hero{text-align:center;padding:3rem 1.5rem 2rem;max-width:700px;margin:0 auto}
.hero h1{font-size:2.2rem;font-weight:800;line-height:1.2;margin-bottom:.75rem}
.hero h1 span{background:linear-gradient(135deg,var(--primary),var(--accent),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:var(--text2);font-size:1rem}
/* TOOL */
.tool-container{max-width:960px;margin:0 auto;padding:0 1.5rem 3rem}
/* DROP ZONE */
.drop-zone{border:2px dashed var(--border);border-radius:var(--radius);padding:3rem 2rem;text-align:center;cursor:pointer;transition:all .3s;background:var(--glass);backdrop-filter:blur(16px);position:relative}
.drop-zone:hover,.drop-zone.dragover{border-color:var(--primary);background:rgba(99,102,241,.06)}
.drop-zone-icon{font-size:3rem;margin-bottom:.75rem;opacity:.6}
.drop-zone h3{font-size:1.1rem;font-weight:700;margin-bottom:.4rem;color:var(--text)}
.drop-zone p{font-size:.85rem;color:var(--text2)}
.drop-zone input{position:absolute;inset:0;opacity:0;cursor:pointer}
/* FILE LIST */
.file-list{margin-top:1.5rem;display:flex;flex-direction:column;gap:.5rem}
.file-item{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:.75rem 1rem;display:flex;align-items:center;gap:.75rem;transition:all .2s}
.file-icon{width:36px;height:36px;border-radius:8px;background:rgba(99,102,241,.12);display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:.75rem;font-weight:700;color:var(--primary)}
.file-info{flex:1;min-width:0}
.file-name{font-size:.85rem;font-weight:600;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.file-meta{font-size:.75rem;color:var(--text2);margin-top:2px}
.file-actions{display:flex;gap:.4rem;flex-shrink:0}
.file-actions button{background:none;border:none;color:var(--text2);font-size:.8rem;cursor:pointer;padding:4px 8px;border-radius:6px;transition:all .2s;font-family:inherit;font-weight:500}
.file-actions button:hover{color:var(--primary);background:rgba(99,102,241,.1)}
.file-remove:hover{color:var(--red)!important;background:rgba(239,68,68,.1)!important}
.file-status{font-size:.7rem;font-weight:600;padding:2px 8px;border-radius:10px;flex-shrink:0}
.file-status.ready{background:rgba(34,197,94,.1);color:var(--green)}
.file-status.converting{background:rgba(99,102,241,.1);color:var(--primary)}
.file-status.done{background:rgba(34,197,94,.15);color:var(--green)}
.file-status.error{background:rgba(239,68,68,.1);color:var(--red)}
/* SETTINGS */
.settings-panel{margin-top:1.5rem;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:1.25rem;display:none}
.settings-panel.visible{display:block}
.settings-title{font-size:.85rem;font-weight:700;margin-bottom:.75rem;color:var(--text)}
.settings-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1rem}
.setting-group label{display:block;font-size:.75rem;font-weight:600;color:var(--text2);margin-bottom:.35rem}
.setting-group select,.setting-group input{width:100%;background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.45rem .7rem;border-radius:8px;font-size:.8rem;font-family:inherit;outline:none;transition:border-color .2s}
.setting-group select:focus,.setting-group input:focus{border-color:var(--primary)}
/* CONTROLS */
.controls{margin-top:1.5rem;display:flex;flex-wrap:wrap;gap:.75rem;align-items:center}
.controls button{background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.55rem 1.2rem;border-radius:8px;font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s;font-family:inherit}
.controls button:hover{border-color:var(--primary);background:rgba(99,102,241,.12)}
.controls button:disabled{opacity:.4;cursor:not-allowed;border-color:var(--border);background:var(--surface2)}
.convert-btn{background:linear-gradient(135deg,var(--primary),var(--accent))!important;border:none!important;color:#fff!important;padding:.6rem 2rem!important;font-size:.9rem!important}
.convert-btn:hover:not(:disabled){opacity:.9;transform:translateY(-1px);box-shadow:0 6px 24px rgba(99,102,241,.3)}
.convert-btn:disabled{opacity:.4!important;transform:none!important;box-shadow:none!important}
/* STATUS */
.status-bar{display:flex;align-items:center;gap:1rem;margin-top:1rem;font-size:.8rem;color:var(--text2);flex-wrap:wrap}
.status-pill{display:inline-flex;align-items:center;gap:.4rem;padding:.3rem .7rem;background:var(--surface);border:1px solid var(--border);border-radius:20px;font-size:.75rem;font-weight:500}
.status-pill .dot{width:6px;height:6px;border-radius:50%;background:var(--green)}
/* PROGRESS */
.progress-wrap{margin-top:1rem;display:none}
.progress-wrap.active{display:block}
.progress-bar{width:100%;height:6px;background:var(--surface2);border-radius:3px;overflow:hidden}
.progress-fill{height:100%;width:0%;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:3px;transition:width .3s}
.progress-text{font-size:.75rem;color:var(--text2);margin-top:.4rem;text-align:center}
/* PREVIEW */
.preview-section{margin-top:2rem;display:none}
.preview-section.visible{display:block}
.preview-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem}
.preview-header h3{font-size:.95rem;font-weight:700}
.preview-header button{background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.4rem 1rem;border-radius:8px;font-size:.8rem;font-weight:600;cursor:pointer;transition:all .2s;font-family:inherit}
.preview-header button:hover{border-color:var(--primary);background:rgba(99,102,241,.12)}
.preview-container{background:#fff;border-radius:var(--radius);overflow:hidden;border:1px solid var(--border);max-height:600px;overflow-y:auto}
.preview-content{padding:2rem;color:#1a1a2e;font-family:'Times New Roman',serif;font-size:14px;line-height:1.8}
.preview-content h1{font-size:24px;font-weight:700;margin:0 0 12px;color:#111;font-family:'Inter',sans-serif}
.preview-content h2{font-size:20px;font-weight:700;margin:18px 0 10px;color:#222;font-family:'Inter',sans-serif}
.preview-content h3{font-size:17px;font-weight:700;margin:14px 0 8px;color:#333;font-family:'Inter',sans-serif}
.preview-content h4,.preview-content h5,.preview-content h6{font-size:15px;font-weight:700;margin:12px 0 6px;color:#444;font-family:'Inter',sans-serif}
.preview-content p{margin:0 0 10px}
.preview-content ul,.preview-content ol{margin:0 0 10px;padding-left:24px}
.preview-content li{margin-bottom:4px}
.preview-content table{border-collapse:collapse;width:100%;margin:12px 0}
.preview-content table td,.preview-content table th{border:1px solid #ccc;padding:6px 10px;text-align:left;font-size:13px}
.preview-content table th{background:#f0f0f0;font-weight:700}
.preview-content img{max-width:100%;height:auto;margin:8px 0;border-radius:4px}
.preview-content a{color:var(--primary);text-decoration:underline}
.preview-content blockquote{border-left:3px solid #6366f1;padding-left:12px;margin:10px 0;color:#555;font-style:italic}
.preview-content pre{background:#f5f5f5;border:1px solid #ddd;border-radius:6px;padding:10px;overflow-x:auto;font-size:12px;margin:10px 0}
.preview-content code{background:#f0f0f0;padding:1px 4px;border-radius:3px;font-size:12px}
/* TABS */
.preview-tabs{display:flex;gap:.5rem;margin-bottom:.75rem}
.preview-tab{background:var(--surface2);border:1px solid var(--border);color:var(--text2);padding:.4rem 1rem;border-radius:8px;font-size:.8rem;font-weight:600;cursor:pointer;transition:all .2s;font-family:inherit}
.preview-tab:hover{border-color:var(--primary);color:var(--text)}
.preview-tab.active{background:linear-gradient(135deg,var(--primary),var(--accent));border-color:transparent;color:#fff}
/* CTA */
.cta-section{text-align:center;padding:4rem 1.5rem;max-width:700px;margin:0 auto}
.cta-section h2{font-size:1.8rem;font-weight:800;margin-bottom:.75rem}
.cta-section h2 span{background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.cta-section p{color:var(--text2);margin-bottom:1.5rem}
.cta-btn{display:inline-block;background:linear-gradient(135deg,var(--primary),var(--accent));color:#fff;padding:.75rem 2rem;border-radius:10px;font-weight:700;text-decoration:none;font-size:1rem;transition:transform .2s,box-shadow .2s}
.cta-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(99,102,241,.3)}
/* FOOTER */
.footer{border-top:1px solid var(--border);padding:3rem 2rem 2rem;max-width:1200px;margin:0 auto}
.footer-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:2rem;margin-bottom:2rem}
.footer-col h4{font-size:.85rem;font-weight:700;margin-bottom:.75rem;color:var(--text)}
.footer-col a{display:block;color:var(--text2);text-decoration:none;font-size:.8rem;margin-bottom:.4rem;transition:color .2s}
.footer-col a:hover{color:var(--primary)}
.footer-bottom{text-align:center;color:var(--text2);font-size:.75rem;padding-top:1.5rem;border-top:1px solid var(--border)}
/* FADE IN */
.fade-in{opacity:0;transform:translateY(20px);transition:opacity .6s,transform .6s}
.fade-in.visible{opacity:1;transform:translateY(0)}
/* TOAST */
.toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(80px);background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:.6rem 1.2rem;border-radius:10px;font-size:.85rem;font-weight:500;z-index:200;transition:transform .3s;pointer-events:none}
.toast.show{transform:translateX(-50%) translateY(0)}
/* RESPONSIVE */
@media(max-width:768px){
  .nav-links{display:none;position:absolute;top:64px;left:0;right:0;background:var(--bg);border-bottom:1px solid var(--border);flex-direction:column;padding:1rem 2rem;gap:1rem}
  .nav-links.open{display:flex}
  .nav-toggle{display:block}
  .hero h1{font-size:1.6rem}
  .footer-grid{grid-template-columns:1fr}
  .drop-zone{padding:2rem 1rem}
  .controls{flex-direction:column}
  .controls button{width:100%}
  .settings-grid{grid-template-columns:1fr}
  .preview-container{max-height:400px}
  .file-item{flex-wrap:wrap}
}
</style>
</head>
<body>

<nav class="nav">
  <a href="/" class="nav-logo">NexTool</a>
  <button class="nav-toggle" onclick="document.querySelector('.nav-links').classList.toggle('open')" aria-label="Menu">&#9776;</button>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Tools</a>
    <a href="/free-tools/">Free Tools</a>
    <a href="/blog/">Blog</a>
    <a href="/pro.html" class="nav-cta">Get Pro &mdash; $29</a>
  </div>
</nav>

<section class="hero fade-in">
  <h1>Free <span>Word to PDF</span> Converter</h1>
  <p class="tool-summary" style="color:#94a3b8;font-size:15px;line-height:1.6;margin-bottom:24px;max-width:700px;margin-left:auto;margin-right:auto;">Convert Word DOCX files to PDF instantly, right in your browser. Preserves headings, bold, italic, underline, lists, tables, images, and links. Batch convert multiple files, preview before downloading, and customize page size and margins. Your files never leave your device &mdash; 100% client-side, no signup required.</p>
</section>

<div class="tool-container fade-in">
  <div class="drop-zone" id="dropZone">
    <input type="file" id="fileInput" multiple accept=".docx,application/vnd.openxmlformats-officedocument.wordprocessingml.document">
    <div class="drop-zone-icon">&#128196;</div>
    <h3>Drop DOCX files here</h3>
    <p>or click to browse &mdash; select multiple .docx files at once</p>
  </div>

  <div class="file-list" id="fileList"></div>

  <div class="status-bar" id="statusBar" style="display:none">
    <span class="status-pill"><span class="dot"></span> <span id="fileCount">0 files</span></span>
    <span class="status-pill" id="totalSize">0 KB</span>
  </div>

  <!-- Settings -->
  <div class="settings-panel" id="settingsPanel">
    <div class="settings-title">PDF Settings</div>
    <div class="settings-grid">
      <div class="setting-group">
        <label for="pageSize">Page Size</label>
        <select id="pageSize">
          <option value="a4" selected>A4 (210 x 297 mm)</option>
          <option value="letter">Letter (8.5 x 11 in)</option>
          <option value="legal">Legal (8.5 x 14 in)</option>
        </select>
      </div>
      <div class="setting-group">
        <label for="marginSize">Margins</label>
        <select id="marginSize">
          <option value="normal" selected>Normal (1 inch)</option>
          <option value="narrow">Narrow (0.5 inch)</option>
          <option value="wide">Wide (1.5 inch)</option>
          <option value="none">None</option>
        </select>
      </div>
      <div class="setting-group">
        <label for="fontSize">Base Font Size</label>
        <select id="fontSize">
          <option value="11">11pt</option>
          <option value="12" selected>12pt</option>
          <option value="14">14pt</option>
          <option value="16">16pt</option>
        </select>
      </div>
    </div>
  </div>

  <div class="controls" id="controls" style="display:none">
    <button onclick="addMoreFiles()">+ Add More</button>
    <button onclick="toggleSettings()">Settings</button>
    <button onclick="clearAllFiles()">Clear All</button>
    <button class="convert-btn" id="convertBtn" onclick="convertAll()">Convert to PDF</button>
  </div>

  <div class="progress-wrap" id="progressWrap">
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    <div class="progress-text" id="progressText">Preparing conversion...</div>
  </div>

  <!-- Preview -->
  <div class="preview-section" id="previewSection">
    <div class="preview-header">
      <h3>Preview</h3>
      <div style="display:flex;gap:.5rem">
        <button onclick="downloadCurrentPreview()">Download This PDF</button>
        <button onclick="downloadAllPDFs()">Download All</button>
      </div>
    </div>
    <div class="preview-tabs" id="previewTabs"></div>
    <div class="preview-container">
      <div class="preview-content" id="previewContent"></div>
    </div>
  </div>
</div>

<section class="cta-section fade-in">
  <h2>Need something <span>more powerful</span>?</h2>
  <p>Let us build it for you. Custom APIs, dashboards, automations &mdash; whatever you need.</p>
  <a href="/#contact" class="cta-btn">Start a Project &rarr;</a>
</section>

<!-- Cross Promo -->
<section style="max-width:900px;margin:40px auto;padding:0 24px;">
<div style="background:linear-gradient(135deg,rgba(99,102,241,0.1),rgba(168,85,247,0.08));border:1px solid rgba(99,102,241,0.15);border-radius:20px;padding:32px 28px;text-align:center;">
<div style="font-size:13px;color:#818cf8;font-weight:600;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;">Founding Member</div>
<h3 style="font-size:22px;font-weight:800;color:#fff;margin:0 0 8px;">Get NexTool Pro</h3>
<p style="color:#94a3b8;font-size:14px;margin:0 auto 20px;max-width:500px;">No banners, clean output, enhanced features on all 250+ tools. One-time payment.</p>
<div style="display:flex;align-items:center;justify-content:center;gap:12px;flex-wrap:wrap;">
<a href="/pro.html" style="display:inline-block;padding:12px 28px;background:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);color:#fff;border-radius:10px;font-weight:700;font-size:15px;text-decoration:none;">$29 &mdash; Get Pro</a>
<a href="/free-tools/" style="color:#94a3b8;font-size:14px;text-decoration:none;">Browse 250+ Free Tools &rarr;</a>
</div>
</div>
</section>

<footer class="footer fade-in">
  <div class="footer-grid">
    <div class="footer-col">
      <h4>Products</h4>
      <a href="/free-tools/">250+ Free Tools</a>
<a href="/pro.html">NexTool Pro</a>
<a href="/workspace.html">Workspace</a>
    </div>
    <div class="footer-col">
      <h4>Explore</h4>
      <a href="/free-tools/">Free Tools</a><a href="/blog/">Blog</a><a href="/pro.html">FAQ</a><a href="/pro.html">Pro &mdash; $29</a>
    </div>
    <div class="footer-col">
      <h4>Ecosystem</h4>
      <a href="/">NexTool Home</a><a href="/#contact">Contact</a><a href="https://github.com/christian140903-sudo/nextool" target="_blank">GitHub</a>
    </div>
  </div>
  <div class="footer-bottom">&copy; 2026 NexTool. AI-powered tools for everyone.</div>
</footer>

<div class="toast" id="toast"></div>

<script src="https://cdn.jsdelivr.net/npm/mammoth@1.8.0/mammoth.browser.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.2/dist/html2pdf.bundle.min.js"></script>
<script>
var dropZone = document.getElementById('dropZone');
var fileInput = document.getElementById('fileInput');
var fileListEl = document.getElementById('fileList');
var statusBar = document.getElementById('statusBar');
var controlsEl = document.getElementById('controls');
var convertBtn = document.getElementById('convertBtn');
var progressWrap = document.getElementById('progressWrap');
var progressFill = document.getElementById('progressFill');
var progressText = document.getElementById('progressText');
var previewSection = document.getElementById('previewSection');
var previewTabs = document.getElementById('previewTabs');
var previewContent = document.getElementById('previewContent');
var settingsPanel = document.getElementById('settingsPanel');

var docxFiles = []; // {file, name, size, htmlContent, pdfBlob, status}
var activePreviewIndex = 0;

/* Page size configs in mm */
var PAGE_SIZES = {
  a4: [210, 297],
  letter: [215.9, 279.4],
  legal: [215.9, 355.6]
};

var MARGINS = {
  normal: { top: 25.4, right: 25.4, bottom: 25.4, left: 25.4 },
  narrow: { top: 12.7, right: 12.7, bottom: 12.7, left: 12.7 },
  wide: { top: 38.1, right: 38.1, bottom: 38.1, left: 38.1 },
  none: { top: 0, right: 0, bottom: 0, left: 0 }
};

/* ---- Drop Zone ---- */
dropZone.addEventListener('dragover', function(e) {
  e.preventDefault();
  dropZone.classList.add('dragover');
});
dropZone.addEventListener('dragleave', function() {
  dropZone.classList.remove('dragover');
});
dropZone.addEventListener('drop', function(e) {
  e.preventDefault();
  dropZone.classList.remove('dragover');
  handleFiles(e.dataTransfer.files);
});
fileInput.addEventListener('change', function() {
  handleFiles(fileInput.files);
  fileInput.value = '';
});

function addMoreFiles() {
  var inp = document.createElement('input');
  inp.type = 'file';
  inp.multiple = true;
  inp.accept = '.docx,application/vnd.openxmlformats-officedocument.wordprocessingml.document';
  inp.addEventListener('change', function() { handleFiles(inp.files); });
  inp.click();
}

async function handleFiles(filesList) {
  var newFiles = Array.from(filesList).filter(function(f) {
    return f.name.toLowerCase().endsWith('.docx') ||
           f.type === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document';
  });
  if (newFiles.length === 0) {
    showToast('Please select .docx files only');
    return;
  }
  for (var i = 0; i < newFiles.length; i++) {
    var f = newFiles[i];
    docxFiles.push({
      file: f,
      name: f.name,
      size: f.size,
      htmlContent: null,
      pdfBlob: null,
      status: 'ready'
    });
  }
  renderFileList();
  updateStatus();
}

/* ---- Render file list ---- */
function renderFileList() {
  fileListEl.innerHTML = '';
  docxFiles.forEach(function(df, idx) {
    var div = document.createElement('div');
    div.className = 'file-item';
    var statusClass = df.status;
    var statusLabel = df.status === 'ready' ? 'Ready' : df.status === 'converting' ? 'Converting...' : df.status === 'done' ? 'Done' : 'Error';
    div.innerHTML =
      '<div class="file-icon">DOCX</div>' +
      '<div class="file-info">' +
        '<div class="file-name">' + escHtml(df.name) + '</div>' +
        '<div class="file-meta">' + formatBytes(df.size) + '</div>' +
      '</div>' +
      '<span class="file-status ' + statusClass + '">' + statusLabel + '</span>' +
      '<div class="file-actions">' +
        (df.status === 'done' ? '<button onclick="previewFile(' + idx + ')">Preview</button><button onclick="downloadSingle(' + idx + ')">Download</button>' : '') +
        '<button class="file-remove" onclick="removeFile(' + idx + ')">&times;</button>' +
      '</div>';
    fileListEl.appendChild(div);
  });
}

function removeFile(idx) {
  docxFiles.splice(idx, 1);
  renderFileList();
  updateStatus();
  if (docxFiles.length === 0) {
    previewSection.classList.remove('visible');
  }
}

/* ---- Status ---- */
function updateStatus() {
  if (docxFiles.length === 0) {
    statusBar.style.display = 'none';
    controlsEl.style.display = 'none';
    return;
  }
  statusBar.style.display = 'flex';
  controlsEl.style.display = 'flex';
  document.getElementById('fileCount').textContent = docxFiles.length + ' file' + (docxFiles.length !== 1 ? 's' : '');
  var totalSz = docxFiles.reduce(function(s, f) { return s + f.size; }, 0);
  document.getElementById('totalSize').textContent = formatBytes(totalSz);
}

function toggleSettings() {
  settingsPanel.classList.toggle('visible');
}

/* ---- Convert ---- */
async function convertAll() {
  if (docxFiles.length === 0) {
    showToast('Add at least one DOCX file');
    return;
  }
  convertBtn.disabled = true;
  progressWrap.classList.add('active');
  progressFill.style.width = '0%';
  progressText.textContent = 'Starting conversion...';

  var pageSizeKey = document.getElementById('pageSize').value;
  var marginKey = document.getElementById('marginSize').value;
  var baseFontSize = document.getElementById('fontSize').value;
  var pageSize = PAGE_SIZES[pageSizeKey];
  var margin = MARGINS[marginKey];

  for (var i = 0; i < docxFiles.length; i++) {
    var df = docxFiles[i];
    df.status = 'converting';
    renderFileList();

    var pct = Math.round((i / docxFiles.length) * 90);
    progressFill.style.width = pct + '%';
    progressText.textContent = 'Converting ' + (i + 1) + ' of ' + docxFiles.length + ': ' + df.name;

    try {
      /* Read file as ArrayBuffer */
      var ab = await df.file.arrayBuffer();

      /* Parse DOCX to HTML with mammoth */
      var result = await mammoth.convertToHtml(
        { arrayBuffer: ab },
        {
          styleMap: [
            "p[style-name='Heading 1'] => h1:fresh",
            "p[style-name='Heading 2'] => h2:fresh",
            "p[style-name='Heading 3'] => h3:fresh",
            "p[style-name='Heading 4'] => h4:fresh",
            "p[style-name='Heading 5'] => h5:fresh",
            "p[style-name='Heading 6'] => h6:fresh"
          ],
          convertImage: mammoth.images.imgElement(function(image) {
            return image.read("base64").then(function(imageBuffer) {
              return {
                src: "data:" + image.contentType + ";base64," + imageBuffer
              };
            });
          })
        }
      );

      df.htmlContent = result.value;

      /* Build styled HTML for PDF */
      var styledHtml = buildStyledHtml(df.htmlContent, baseFontSize);

      /* Convert HTML to PDF using html2pdf.js */
      var pdfBlob = await generatePdf(styledHtml, pageSize, margin, df.name);
      df.pdfBlob = pdfBlob;
      df.status = 'done';

      if (result.messages && result.messages.length > 0) {
        var warnings = result.messages.filter(function(m) { return m.type === 'warning'; });
        if (warnings.length > 0) {
          console.warn('Mammoth warnings for ' + df.name + ':', warnings);
        }
      }
    } catch (err) {
      df.status = 'error';
      df.errorMsg = err.message;
      console.error('Conversion error for ' + df.name + ':', err);
      showToast('Error converting ' + df.name + ': ' + err.message);
    }
    renderFileList();
  }

  progressFill.style.width = '100%';
  var doneCount = docxFiles.filter(function(f) { return f.status === 'done'; }).length;
  progressText.textContent = 'Done! ' + doneCount + ' of ' + docxFiles.length + ' converted successfully.';

  setTimeout(function() {
    progressWrap.classList.remove('active');
    progressFill.style.width = '0%';
  }, 3000);

  convertBtn.disabled = false;

  /* Show preview of first successful file */
  var firstDone = docxFiles.findIndex(function(f) { return f.status === 'done'; });
  if (firstDone >= 0) {
    showPreview(firstDone);
    showToast('Conversion complete! ' + doneCount + ' file' + (doneCount !== 1 ? 's' : '') + ' ready.');
  }
}

function buildStyledHtml(htmlContent, baseFontSize) {
  return '<div style="font-family: \'Times New Roman\', Georgia, serif; font-size: ' + baseFontSize + 'pt; line-height: 1.8; color: #1a1a2e; word-wrap: break-word;">' +
    '<style>' +
      'h1 { font-family: Arial, Helvetica, sans-serif; font-size: 24pt; font-weight: 700; margin: 0 0 12px; color: #111; }' +
      'h2 { font-family: Arial, Helvetica, sans-serif; font-size: 20pt; font-weight: 700; margin: 18px 0 10px; color: #222; }' +
      'h3 { font-family: Arial, Helvetica, sans-serif; font-size: 16pt; font-weight: 700; margin: 14px 0 8px; color: #333; }' +
      'h4, h5, h6 { font-family: Arial, Helvetica, sans-serif; font-size: 14pt; font-weight: 700; margin: 12px 0 6px; color: #444; }' +
      'p { margin: 0 0 10px; }' +
      'ul, ol { margin: 0 0 10px; padding-left: 24px; }' +
      'li { margin-bottom: 4px; }' +
      'table { border-collapse: collapse; width: 100%; margin: 12px 0; }' +
      'td, th { border: 1px solid #ccc; padding: 6px 10px; text-align: left; font-size: ' + (parseInt(baseFontSize) - 1) + 'pt; }' +
      'th { background: #f0f0f0; font-weight: 700; }' +
      'img { max-width: 100%; height: auto; margin: 8px 0; }' +
      'a { color: #6366f1; text-decoration: underline; }' +
      'blockquote { border-left: 3px solid #6366f1; padding-left: 12px; margin: 10px 0; color: #555; font-style: italic; }' +
      'pre { background: #f5f5f5; border: 1px solid #ddd; border-radius: 6px; padding: 10px; overflow-x: auto; font-size: 10pt; margin: 10px 0; }' +
      'code { background: #f0f0f0; padding: 1px 4px; border-radius: 3px; font-size: 10pt; }' +
    '</style>' +
    htmlContent +
  '</div>';
}

function generatePdf(styledHtml, pageSize, margin, filename) {
  return new Promise(function(resolve, reject) {
    /* Create a temporary container for rendering */
    var container = document.createElement('div');
    container.style.position = 'absolute';
    container.style.left = '-9999px';
    container.style.top = '0';
    container.style.width = (pageSize[0] - margin.left - margin.right) + 'mm';
    container.style.background = '#fff';
    container.innerHTML = styledHtml;
    document.body.appendChild(container);

    var jsPDFUnit = 'mm';
    var opt = {
      margin: [margin.top, margin.right, margin.bottom, margin.left],
      filename: filename.replace(/\.docx$/i, '') + '.pdf',
      image: { type: 'jpeg', quality: 0.95 },
      html2canvas: {
        scale: 2,
        useCORS: true,
        logging: false,
        letterRendering: true
      },
      jsPDF: {
        unit: jsPDFUnit,
        format: [pageSize[0], pageSize[1]],
        orientation: 'portrait'
      },
      pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
    };

    html2pdf().set(opt).from(container).outputPdf('blob').then(function(blob) {
      document.body.removeChild(container);
      resolve(blob);
    }).catch(function(err) {
      document.body.removeChild(container);
      reject(err);
    });
  });
}

/* ---- Preview ---- */
function showPreview(idx) {
  activePreviewIndex = idx;
  previewSection.classList.add('visible');

  /* Build tabs */
  previewTabs.innerHTML = '';
  docxFiles.forEach(function(df, i) {
    if (df.status !== 'done') return;
    var tab = document.createElement('button');
    tab.className = 'preview-tab' + (i === idx ? ' active' : '');
    tab.textContent = df.name.replace(/\.docx$/i, '');
    tab.onclick = function() { showPreview(i); };
    previewTabs.appendChild(tab);
  });

  /* Show HTML preview */
  if (docxFiles[idx] && docxFiles[idx].htmlContent) {
    previewContent.innerHTML = docxFiles[idx].htmlContent;
  }

  /* Scroll to preview */
  previewSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function previewFile(idx) {
  showPreview(idx);
}

/* ---- Download ---- */
function downloadSingle(idx) {
  var df = docxFiles[idx];
  if (!df || !df.pdfBlob) {
    showToast('PDF not ready yet');
    return;
  }
  triggerDownload(df.pdfBlob, df.name.replace(/\.docx$/i, '') + '.pdf');
  showToast('Downloaded ' + df.name.replace(/\.docx$/i, '') + '.pdf');
}

function downloadCurrentPreview() {
  downloadSingle(activePreviewIndex);
}

function downloadAllPDFs() {
  var count = 0;
  docxFiles.forEach(function(df) {
    if (df.status === 'done' && df.pdfBlob) {
      triggerDownload(df.pdfBlob, df.name.replace(/\.docx$/i, '') + '.pdf');
      count++;
    }
  });
  if (count > 0) {
    showToast('Downloaded ' + count + ' PDF file' + (count !== 1 ? 's' : ''));
  } else {
    showToast('No converted PDFs to download');
  }
}

function triggerDownload(blob, filename) {
  var url = URL.createObjectURL(blob);
  var a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  setTimeout(function() { URL.revokeObjectURL(url); }, 1000);
}

/* ---- Clear ---- */
function clearAllFiles() {
  docxFiles = [];
  renderFileList();
  updateStatus();
  previewSection.classList.remove('visible');
  settingsPanel.classList.remove('visible');
  showToast('All files cleared');
}

/* ---- Helpers ---- */
function formatBytes(bytes) {
  if (bytes === 0) return '0 B';
  var k = 1024, sizes = ['B', 'KB', 'MB', 'GB'];
  var i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
}

function escHtml(s) {
  return s.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
}

function showToast(msg) {
  var t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(function() { t.classList.remove('show'); }, 2500);
}

/* IntersectionObserver fade-in */
var observer = new IntersectionObserver(function(entries) {
  entries.forEach(function(entry) {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');
      observer.unobserve(entry.target);
    }
  });
}, { threshold: 0.1 });
document.querySelectorAll('.fade-in').forEach(function(el) { observer.observe(el); });
</script>
<script src="/js/analytics-lite.js" defer></script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "How do I convert Word to PDF online for free?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Simply drag and drop your .docx file into NexTool's Word to PDF Converter, adjust page size and margins if needed, and click Convert to PDF. The converted file can be previewed and downloaded instantly. No signup or server upload required."
      }
    },
    {
      "@type": "Question",
      "name": "Is it safe to convert DOCX to PDF with this tool?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes. NexTool's Word to PDF Converter runs 100% in your browser using mammoth.js and html2pdf.js. Your files are never uploaded to any server. All processing happens locally on your device, ensuring complete privacy."
      }
    },
    {
      "@type": "Question",
      "name": "What formatting is preserved when converting Word to PDF?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The converter preserves headings (H1-H6), paragraphs, bold, italic, underline formatting, ordered and unordered lists, tables, embedded images, and hyperlinks. Page size (A4, Letter, Legal) and margins are customizable."
      }
    },
    {
      "@type": "Question",
      "name": "Can I convert multiple Word files to PDF at once?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes. You can drag and drop or select multiple .docx files at once. Each file is converted independently, and you can preview and download them individually or all at once."
      }
    }
  ]
}
</script>
</body>
</html>

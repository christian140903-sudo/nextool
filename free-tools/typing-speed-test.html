<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Typing Speed Test - WPM Test with Accuracy Tracking | NexTool</title>
<meta name="description" content="Free online Typing Speed Test. Measure your WPM, accuracy, and errors with tech-themed paragraphs. Multiple durations, real-time stats, and personal best tracking.">
<meta name="keywords" content="typing speed test, WPM test, typing test, words per minute, typing practice, accuracy test, NexTool">
<link rel="canonical" href="https://nextool.app/free-tools/typing-speed-test.html">
<meta property="og:title" content="Typing Speed Test - WPM Test with Accuracy Tracking | NexTool">
<meta property="og:description" content="Free Typing Speed Test. Measure your WPM and accuracy with tech-themed paragraphs. Track your personal best.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://nextool.app/free-tools/typing-speed-test.html">
<meta property="og:image" content="https://nextool.app/free-tools/og/typing-speed-test.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Typing Speed Test - WPM Test with Accuracy Tracking | NexTool">
<meta name="twitter:description" content="Free Typing Speed Test. Measure WPM and accuracy with tech-themed paragraphs.">
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"BreadcrumbList",
  "itemListElement":[
    {"@type":"ListItem","position":1,"name":"Home","item":"https://nextool.app/"},
    {"@type":"ListItem","position":2,"name":"Free Tools","item":"https://nextool.app/free-tools/"},
    {"@type":"ListItem","position":3,"name":"Typing Speed Test","item":"https://nextool.app/free-tools/typing-speed-test.html"}
  ]
}
</script>
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"SoftwareApplication",
  "name":"Typing Speed Test",
  "applicationCategory":"UtilitiesApplication",
  "operatingSystem":"Web",
  "description":"Free Typing Speed Test with WPM, accuracy tracking, multiple durations, and personal best history.",
  "url":"https://nextool.app/free-tools/typing-speed-test.html",
  "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
  "author":{"@type":"Organization","name":"NexTool","url":"https://nextool.app"}
}
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#050508;--surface:#111118;--surface2:#1a1a24;--surface3:#22222f;--primary:#6366f1;--accent:#a855f7;--pink:#ec4899;--text:#e2e8f0;--text-dim:#94a3b8;--text-muted:#64748b;--gradient:linear-gradient(135deg,#6366f1,#a855f7,#ec4899);--green:#22c55e;--red:#ef4444;--yellow:#eab308;--radius:12px;--radius-lg:20px}
html{scroll-behavior:smooth}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);line-height:1.6;-webkit-font-smoothing:antialiased;min-height:100vh}
.nav{position:fixed;top:0;left:0;right:0;z-index:1000;padding:0 2rem;height:64px;display:flex;align-items:center;justify-content:space-between;background:rgba(5,5,8,.75);backdrop-filter:blur(20px);border-bottom:1px solid rgba(99,102,241,.1)}
.nav-logo{display:flex;align-items:center;gap:.5rem;font-weight:800;font-size:1.15rem;text-decoration:none;color:var(--text)}
.nav-logo .ico{width:28px;height:28px;border-radius:7px;background:var(--gradient);display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:900;color:#fff}
.nav-logo span{background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.nav-links{display:flex;gap:1.5rem;align-items:center}
.nav-links a{color:var(--text-dim);font-size:.85rem;font-weight:500;text-decoration:none;transition:color .2s}
.nav-links a:hover{color:var(--text)}
.breadcrumb{max-width:800px;margin:0 auto;padding:80px 1.5rem 0;font-size:.8rem}
.breadcrumb a{color:var(--text-muted);text-decoration:none;transition:color .2s}
.breadcrumb a:hover{color:var(--text)}
.breadcrumb span{color:var(--text-muted);margin:0 .4rem}
.breadcrumb .current{color:var(--text-dim)}
.main{max-width:800px;margin:0 auto;padding:1rem 1.5rem 3rem}
.tool-header{text-align:center;margin-bottom:2.5rem}
.tool-badge{display:inline-flex;align-items:center;gap:.4rem;padding:.3rem .8rem;border-radius:100px;background:rgba(99,102,241,.1);border:1px solid rgba(99,102,241,.15);font-size:.72rem;font-weight:600;color:var(--primary);text-transform:uppercase;letter-spacing:.06em;margin-bottom:1rem}
.tool-header h1{font-size:clamp(1.75rem,4vw,2.5rem);font-weight:800;margin-bottom:.5rem}
.tool-header h1 .gr{background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.tool-header p{color:var(--text-dim);font-size:1rem;max-width:560px;margin:0 auto}
.card{background:var(--surface);border:1px solid rgba(99,102,241,.1);border-radius:var(--radius-lg);padding:2rem;position:relative;overflow:hidden;margin-bottom:1.5rem}
.card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:var(--gradient)}

/* Duration selector */
.duration-bar{display:flex;gap:4px;background:var(--surface2);padding:4px;border-radius:var(--radius);margin-bottom:1.5rem;justify-content:center}
.dur-btn{padding:.5rem 1.25rem;border-radius:8px;border:none;background:transparent;color:var(--text-dim);font-family:'Inter',sans-serif;font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s}
.dur-btn.active{background:var(--primary);color:#fff}
.dur-btn:hover:not(.active){color:var(--text)}

/* Stats bar */
.stats-bar{display:grid;grid-template-columns:repeat(4,1fr);gap:.75rem;margin-bottom:1.5rem}
.stat-box{background:var(--surface2);border-radius:var(--radius);padding:.75rem;text-align:center}
.stat-val{font-family:'JetBrains Mono',monospace;font-size:1.5rem;font-weight:700;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;line-height:1.2}
.stat-label{font-size:.7rem;color:var(--text-muted);font-weight:600;text-transform:uppercase;letter-spacing:.05em;margin-top:.15rem}

/* Timer bar */
.timer-bar{width:100%;height:6px;background:var(--surface3);border-radius:3px;overflow:hidden;margin-bottom:1.5rem}
.timer-fill{height:100%;background:var(--gradient);border-radius:3px;transition:width .3s linear;width:100%}

/* Text display */
.text-display{font-family:'JetBrains Mono',monospace;font-size:1.1rem;line-height:2;padding:1.5rem;background:var(--surface2);border-radius:var(--radius);margin-bottom:1.25rem;min-height:160px;position:relative;user-select:none;overflow:hidden}
.text-display .char{transition:color .05s}
.char-correct{color:var(--green)}
.char-wrong{color:var(--red);text-decoration:underline;text-decoration-color:var(--red)}
.char-current{background:rgba(99,102,241,.35);border-radius:2px}
.char-pending{color:var(--text-muted)}

/* Hidden input */
.type-input{position:absolute;left:-9999px;opacity:0}

/* Click overlay */
.text-overlay{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;cursor:text;z-index:2;background:rgba(17,17,24,.7);border-radius:var(--radius);backdrop-filter:blur(2px);transition:opacity .3s}
.text-overlay.hidden{opacity:0;pointer-events:none}
.text-overlay span{font-size:1rem;color:var(--text-dim);font-weight:600}

/* Restart button */
.restart-btn{display:flex;align-items:center;justify-content:center;gap:.5rem;margin:0 auto;padding:.6rem 2rem;border-radius:var(--radius);border:none;background:var(--gradient);color:#fff;font-weight:700;font-size:.9rem;cursor:pointer;font-family:'Inter',sans-serif;transition:transform .2s,box-shadow .2s}
.restart-btn:hover{transform:translateY(-2px);box-shadow:0 4px 20px rgba(99,102,241,.4)}

/* Results screen */
.results-overlay{display:none;flex-direction:column;align-items:center;text-align:center;padding:2rem 0}
.results-overlay.show{display:flex}
.results-title{font-size:1.5rem;font-weight:800;margin-bottom:.5rem}
.results-title .gr{background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.results-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:.75rem;width:100%;margin:1.5rem 0}
.result-card{background:var(--surface2);border-radius:var(--radius);padding:1rem}
.result-val{font-family:'JetBrains Mono',monospace;font-size:1.75rem;font-weight:700;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.result-label{font-size:.75rem;color:var(--text-muted);font-weight:600;text-transform:uppercase;letter-spacing:.05em;margin-top:.25rem}
.best-badge{display:inline-flex;align-items:center;gap:.3rem;padding:.25rem .65rem;border-radius:6px;background:rgba(34,197,94,.12);border:1px solid rgba(34,197,94,.2);color:var(--green);font-size:.75rem;font-weight:700;margin-top:.75rem}

/* CTA */
.cta-section{text-align:center;padding:3rem 0;margin-top:1rem}
.cta-section h2{font-size:1.5rem;font-weight:800;margin-bottom:.5rem}
.cta-section p{color:var(--text-dim);margin-bottom:1.5rem;font-size:.95rem}
.cta-btn{display:inline-block;padding:.7rem 2rem;border-radius:var(--radius);background:var(--gradient);color:#fff;font-weight:700;font-size:.95rem;text-decoration:none;transition:transform .2s,box-shadow .2s}
.cta-btn:hover{transform:translateY(-2px);box-shadow:0 4px 20px rgba(99,102,241,.4)}

/* Footer */
.footer{border-top:1px solid rgba(99,102,241,.06);padding:2rem 0;text-align:center}
.footer-inner{max-width:800px;margin:0 auto;padding:0 1.5rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem}
.footer-logo{display:flex;align-items:center;gap:.4rem;font-weight:700;font-size:.9rem}
.footer-logo .ico{width:20px;height:20px;border-radius:5px;background:var(--gradient);display:flex;align-items:center;justify-content:center;font-size:.5rem;font-weight:900;color:#fff}
.footer-logo span{color:var(--text-dim)}
.footer-links{display:flex;gap:1.25rem}
.footer-links a{color:var(--text-muted);font-size:.8rem;text-decoration:none;transition:color .2s}
.footer-links a:hover{color:var(--text)}
.footer-copy{color:var(--text-muted);font-size:.75rem;width:100%;text-align:center;margin-top:.5rem}

@keyframes popIn{from{transform:scale(.9);opacity:0}to{transform:scale(1);opacity:1}}
.pop-in{animation:popIn .35s ease}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-3px)}75%{transform:translateX(3px)}}
.shake{animation:shake .15s}

@media(max-width:600px){
  .main{padding:1rem 1rem 2rem}
  .breadcrumb{padding:80px 1rem 0}
  .nav-links{display:none}
  .stats-bar{grid-template-columns:repeat(2,1fr)}
  .results-grid{grid-template-columns:repeat(2,1fr)}
  .text-display{font-size:.9rem;padding:1rem}
  .footer-inner{flex-direction:column;text-align:center}
}
</style>
</head>
<body>
<nav class="nav">
  <a class="nav-logo" href="/"><div class="ico">N</div><span>NexTool</span></a>
  <div class="nav-links">
    <a href="/">Home</a>
    <a href="/free-tools/">Free Tools</a>
    <a href="/pro.html">Pro</a>
    <a href="/blog/">Blog</a>
  </div>
</nav>

<div class="breadcrumb">
  <a href="/">Home</a><span>/</span><a href="/free-tools/">Free Tools</a><span>/</span><span class="current">Typing Speed Test</span>
</div>

<div class="main">
  <div class="tool-header">
    <div class="tool-badge">Free Tool</div>
    <h1><span class="gr">Typing Speed</span> Test</h1>
    <p>Measure your WPM and accuracy with tech-themed paragraphs. Choose your duration, start typing, and beat your personal best.</p>
  </div>

  <div class="card">
    <div class="duration-bar">
      <button class="dur-btn" data-dur="30" onclick="setDuration(30)">30s</button>
      <button class="dur-btn active" data-dur="60" onclick="setDuration(60)">60s</button>
      <button class="dur-btn" data-dur="120" onclick="setDuration(120)">120s</button>
    </div>

    <div class="stats-bar">
      <div class="stat-box"><div class="stat-val" id="stat-wpm">0</div><div class="stat-label">WPM</div></div>
      <div class="stat-box"><div class="stat-val" id="stat-acc">100%</div><div class="stat-label">Accuracy</div></div>
      <div class="stat-box"><div class="stat-val" id="stat-chars">0</div><div class="stat-label">Chars</div></div>
      <div class="stat-box"><div class="stat-val" id="stat-errors">0</div><div class="stat-label">Errors</div></div>
    </div>

    <div class="timer-bar"><div class="timer-fill" id="timer-fill"></div></div>

    <div style="position:relative">
      <div class="text-display" id="text-display"></div>
      <div class="text-overlay" id="text-overlay" onclick="focusInput()"><span>Click here or start typing to begin</span></div>
    </div>
    <input type="text" class="type-input" id="type-input" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">

    <div id="active-controls" style="margin-top:1.25rem;text-align:center">
      <button class="restart-btn" onclick="restartTest()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" width="16" height="16"><path d="M1 4v6h6"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
        Restart
      </button>
    </div>

    <div class="results-overlay" id="results-overlay">
      <div class="results-title"><span class="gr">Test Complete!</span></div>
      <p style="color:var(--text-dim);margin-bottom:.5rem" id="results-subtitle"></p>
      <div class="results-grid">
        <div class="result-card"><div class="result-val" id="res-wpm">0</div><div class="result-label">WPM</div></div>
        <div class="result-card"><div class="result-val" id="res-acc">0%</div><div class="result-label">Accuracy</div></div>
        <div class="result-card"><div class="result-val" id="res-chars">0</div><div class="result-label">Characters</div></div>
        <div class="result-card"><div class="result-val" id="res-errors">0</div><div class="result-label">Errors</div></div>
        <div class="result-card"><div class="result-val" id="res-time">0s</div><div class="result-label">Duration</div></div>
        <div class="result-card"><div class="result-val" id="res-best">0</div><div class="result-label">Best WPM</div></div>
      </div>
      <div id="best-badge-wrap"></div>
      <button class="restart-btn" onclick="restartTest()" style="margin-top:1.25rem">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" width="16" height="16"><path d="M1 4v6h6"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
        Try Again
      </button>
    </div>
  </div>

  <div class="cta-section">
    <h2>Unlock All NexTool <span style="background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent">Pro Tools</span></h2>
    <p>Get access to premium features, no limits, and priority support.</p>
    <a href="/pro.html" class="cta-btn">Explore Pro</a>
  </div>
</div>

<footer class="footer">
  <div class="footer-inner">
    <div class="footer-logo"><div class="ico">N</div><span>NexTool</span></div>
    <div class="footer-links">
      <a href="/">Home</a>
      <a href="/free-tools/">Tools</a>
      <a href="/blog/">Blog</a>
      <a href="/pro.html">Pro</a>
    </div>
    <div class="footer-copy">&copy; 2026 NexTool. All rights reserved.</div>
  </div>
</footer>

<script>
const paragraphs = [
  "The best programs are the ones written when the programmer is supposed to be working on something else. Software developers spend most of their time figuring out what went wrong instead of writing new code. The code you write makes you a programmer. The code you delete makes you a good one.",
  "Artificial intelligence is not a substitute for human intelligence. It is a tool to amplify human creativity and ingenuity. Machine learning models learn patterns from data rather than being explicitly programmed. Neural networks are inspired by biological brain structures but work very differently in practice.",
  "Every great developer you know got there by solving problems they were unqualified to solve until they actually did it. The most damaging phrase in the language is we have always done it this way. Talk is cheap. Show me the code. Simplicity is the soul of efficiency in programming.",
  "A distributed system is one in which the failure of a computer you did not even know existed can render your own computer unusable. Microservices architecture breaks applications into small, independent services that communicate over well-defined interfaces and simple protocols.",
  "The function of good software is to make the complex appear to be simple. Good code is its own best documentation. As you are about to add a comment, ask yourself how can I improve the code so that this comment is not needed. Refactoring is the process of changing software in such a way that it does not alter the external behavior of the code yet improves its internal structure.",
  "Open source software is built by communities of developers who contribute their time and expertise. Version control systems like Git allow teams to collaborate efficiently by tracking every change made to the codebase. Pull requests and code reviews ensure quality and knowledge sharing across the team.",
  "Cybersecurity is not just about building walls. It is about building resilient systems that can detect, respond to, and recover from threats. Encryption transforms readable data into an unreadable format using complex mathematical algorithms. Zero trust architecture assumes that no user or system should be inherently trusted.",
  "Cloud computing has transformed how businesses deploy and scale their applications. Containers provide a lightweight way to package applications with their dependencies. Kubernetes orchestrates container deployment across clusters of machines, handling scaling, load balancing, and self-healing automatically.",
  "The internet protocol suite provides end-to-end data communication specifying how data should be packetized, addressed, transmitted, routed, and received. DNS translates human-readable domain names into machine-readable IP addresses. HTTP defines how messages are formatted and transmitted on the world wide web.",
  "Functional programming treats computation as the evaluation of mathematical functions and avoids changing state and mutable data. Pure functions always return the same result for the same input and have no side effects. Higher-order functions can take other functions as arguments or return them as results.",
  "Database indexing improves the speed of data retrieval operations on a database table at the cost of additional writes and storage space. SQL databases enforce structured schemas while NoSQL databases offer flexibility with document-based, key-value, columnar, or graph data models for different use cases.",
  "Responsive web design ensures that web applications look and function well on all screen sizes. CSS Grid and Flexbox provide powerful layout systems for creating complex, responsive designs without relying on float hacks or JavaScript. Progressive web apps combine the best of web and mobile applications."
];

let duration = 60;
let currentText = '';
let charIndex = 0;
let errors = 0;
let totalTyped = 0;
let correctTyped = 0;
let timerInterval = null;
let timeLeft = 60;
let started = false;
let finished = false;
let startTime = null;

const display = document.getElementById('text-display');
const overlay = document.getElementById('text-overlay');
const input = document.getElementById('type-input');
const timerFill = document.getElementById('timer-fill');
const activeControls = document.getElementById('active-controls');
const resultsOverlay = document.getElementById('results-overlay');

function setDuration(d) {
  if (started && !finished) return;
  duration = d;
  document.querySelectorAll('.dur-btn').forEach(b => b.classList.toggle('active', parseInt(b.dataset.dur) === d));
  restartTest();
}

function pickText() {
  let t = paragraphs[Math.floor(Math.random() * paragraphs.length)];
  while (t.length < duration * 6) {
    t += ' ' + paragraphs[Math.floor(Math.random() * paragraphs.length)];
  }
  return t;
}

function renderText() {
  let html = '';
  for (let i = 0; i < currentText.length; i++) {
    let cls = 'char-pending';
    if (i < charIndex) {
      cls = currentText[i] === '__correct__' ? 'char-correct' : (i < charIndex ? 'char-correct' : 'char-pending');
    }
    if (i === charIndex) cls = 'char-current';
    html += '<span class="char ' + cls + '">' + escHtml(currentText[i]) + '</span>';
  }
  display.innerHTML = html;
}

function renderTextState() {
  const spans = display.querySelectorAll('.char');
  spans.forEach((sp, i) => {
    sp.className = 'char';
    if (i < charIndex) {
      sp.classList.add(sp.dataset.correct === '1' ? 'char-correct' : 'char-wrong');
    } else if (i === charIndex) {
      sp.classList.add('char-current');
    } else {
      sp.classList.add('char-pending');
    }
  });

  // Auto-scroll to keep current character visible
  if (charIndex < spans.length) {
    const current = spans[charIndex];
    const rect = current.getBoundingClientRect();
    const dispRect = display.getBoundingClientRect();
    if (rect.top > dispRect.bottom - 30 || rect.bottom < dispRect.top + 10) {
      current.scrollIntoView({ block: 'center', behavior: 'smooth' });
    }
  }
}

function initText() {
  currentText = pickText();
  let html = '';
  for (let i = 0; i < currentText.length; i++) {
    html += '<span class="char char-pending" data-correct="">' + escHtml(currentText[i]) + '</span>';
  }
  display.innerHTML = html;
  const firstSpan = display.querySelector('.char');
  if (firstSpan) firstSpan.classList.replace('char-pending', 'char-current');
}

function escHtml(c) {
  if (c === '<') return '&lt;';
  if (c === '>') return '&gt;';
  if (c === '&') return '&amp;';
  if (c === ' ') return ' ';
  return c;
}

function focusInput() {
  input.focus();
  overlay.classList.add('hidden');
}

function startTimer() {
  started = true;
  startTime = Date.now();
  timeLeft = duration;
  timerInterval = setInterval(() => {
    const elapsed = (Date.now() - startTime) / 1000;
    timeLeft = Math.max(0, duration - elapsed);
    const pct = (timeLeft / duration) * 100;
    timerFill.style.width = pct + '%';
    updateStats();
    if (timeLeft <= 0) {
      finishTest();
    }
  }, 100);
}

function updateStats() {
  if (!started) return;
  const elapsed = (Date.now() - startTime) / 1000;
  const minutes = elapsed / 60;
  const wpm = minutes > 0 ? Math.round((correctTyped / 5) / minutes) : 0;
  const acc = totalTyped > 0 ? Math.round((correctTyped / totalTyped) * 100) : 100;
  document.getElementById('stat-wpm').textContent = wpm;
  document.getElementById('stat-acc').textContent = acc + '%';
  document.getElementById('stat-chars').textContent = totalTyped;
  document.getElementById('stat-errors').textContent = errors;
}

function finishTest() {
  finished = true;
  clearInterval(timerInterval);
  input.blur();

  const elapsed = Math.min(duration, (Date.now() - startTime) / 1000);
  const minutes = elapsed / 60;
  const wpm = minutes > 0 ? Math.round((correctTyped / 5) / minutes) : 0;
  const acc = totalTyped > 0 ? Math.round((correctTyped / totalTyped) * 100) : 100;

  // Save best
  const key = 'nextype_best_' + duration;
  const prevBest = parseInt(localStorage.getItem(key) || '0');
  const isNewBest = wpm > prevBest;
  if (isNewBest) localStorage.setItem(key, wpm);
  const best = Math.max(wpm, prevBest);

  document.getElementById('res-wpm').textContent = wpm;
  document.getElementById('res-acc').textContent = acc + '%';
  document.getElementById('res-chars').textContent = totalTyped;
  document.getElementById('res-errors').textContent = errors;
  document.getElementById('res-time').textContent = Math.round(elapsed) + 's';
  document.getElementById('res-best').textContent = best;
  document.getElementById('results-subtitle').textContent = duration + ' second test completed';

  const badgeWrap = document.getElementById('best-badge-wrap');
  badgeWrap.innerHTML = isNewBest
    ? '<div class="best-badge pop-in"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" width="14" height="14"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87L18.18 22 12 18.56 5.82 22 7 14.14l-5-4.87 6.91-1.01z"/></svg> New Personal Best!</div>'
    : '';

  display.style.display = 'none';
  overlay.style.display = 'none';
  activeControls.style.display = 'none';
  resultsOverlay.classList.add('show');
  resultsOverlay.classList.add('pop-in');
  timerFill.style.width = '0%';
}

function restartTest() {
  clearInterval(timerInterval);
  started = false;
  finished = false;
  charIndex = 0;
  errors = 0;
  totalTyped = 0;
  correctTyped = 0;
  timeLeft = duration;
  startTime = null;
  input.value = '';

  timerFill.style.width = '100%';
  document.getElementById('stat-wpm').textContent = '0';
  document.getElementById('stat-acc').textContent = '100%';
  document.getElementById('stat-chars').textContent = '0';
  document.getElementById('stat-errors').textContent = '0';

  display.style.display = '';
  overlay.style.display = '';
  overlay.classList.remove('hidden');
  activeControls.style.display = '';
  resultsOverlay.classList.remove('show');

  initText();
}

// Keyboard handling
input.addEventListener('input', function(e) {
  if (finished) return;
  const val = input.value;
  if (!val.length) return;

  if (!started) startTimer();

  const typed = val[val.length - 1];
  input.value = '';

  if (charIndex >= currentText.length) {
    finishTest();
    return;
  }

  const expected = currentText[charIndex];
  const spans = display.querySelectorAll('.char');
  totalTyped++;

  if (typed === expected) {
    correctTyped++;
    spans[charIndex].dataset.correct = '1';
  } else {
    errors++;
    spans[charIndex].dataset.correct = '0';
    display.classList.add('shake');
    setTimeout(() => display.classList.remove('shake'), 150);
  }

  charIndex++;
  renderTextState();

  if (charIndex >= currentText.length) {
    finishTest();
  }
});

// Handle backspace
document.addEventListener('keydown', function(e) {
  if (finished) return;
  if (document.activeElement !== input && !finished) {
    if (e.key.length === 1 || e.key === 'Backspace') {
      focusInput();
    }
  }
  if (e.key === 'Backspace' && charIndex > 0 && started) {
    e.preventDefault();
    charIndex--;
    const spans = display.querySelectorAll('.char');
    if (spans[charIndex].dataset.correct === '0') {
      errors = Math.max(0, errors - 1);
      totalTyped = Math.max(0, totalTyped - 1);
    } else {
      correctTyped = Math.max(0, correctTyped - 1);
      totalTyped = Math.max(0, totalTyped - 1);
    }
    spans[charIndex].dataset.correct = '';
    renderTextState();
    updateStats();
  }
});

// Prevent tab from leaving
input.addEventListener('keydown', function(e) {
  if (e.key === 'Tab') e.preventDefault();
});

// Init
initText();
</script>
<script src="/js/revenue.js" defer></script>
<script src="/js/lead-capture.js" defer></script>
<script src="/js/analytics-lite.js" defer></script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Primary Meta -->
  <title>Create Pack — Free AI Expertise Generator | ANIMA</title>
  <meta name="description" content="Describe your goal, answer smart questions, and get a complete AI expertise pack with 6 task prompts optimized for ChatGPT, Claude, or Gemini. 100% free.">
  <meta name="robots" content="index, follow">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Create Pack — Free AI Expertise Generator | ANIMA">
  <meta property="og:description" content="Describe your goal, answer smart questions, get a tailored AI expertise pack. Free, no signup required.">
  <meta property="og:url" content="https://nextool.app/create/">
  <meta property="og:image" content="https://nextool.app/img/og-image.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Create Pack — Free AI Expertise Generator | ANIMA">
  <meta name="twitter:description" content="Generate tailored AI expertise packs for ChatGPT, Claude, or Gemini. Completely free.">
  <meta name="twitter:image" content="https://nextool.app/img/og-image.png">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="../img/favicon.svg">

  <!-- Canonical -->
  <link rel="canonical" href="https://nextool.app/create/">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    /* ================================================================
       ANIMA Create Pack — Self-contained V2 Design
       Dark theme, glassmorphism, cyan/purple gradients
       ================================================================ */

    :root {
      --bg: #030303;
      --bg-alt: #060606;
      --text: #f0f0f0;
      --text-dim: rgba(255,255,255,0.55);
      --text-muted: rgba(255,255,255,0.28);
      --accent: #635BFF;
      --accent-light: #7B74FF;
      --cyan: #00D4FF;
      --purple: #a855f7;
      --border: rgba(255,255,255,0.07);
      --border-hover: rgba(255,255,255,0.14);
      --surface: rgba(255,255,255,0.025);
      --surface-2: rgba(255,255,255,0.04);
      --glow-accent: rgba(99,91,255,0.15);
      --glow-cyan: rgba(0,212,255,0.12);
      --glow-purple: rgba(168,85,247,0.12);
      --success: #22c55e;
      --glass: rgba(255,255,255,0.03);
      --glass-border: rgba(255,255,255,0.06);
      --radius: 14px;
      --radius-sm: 10px;
      --radius-xs: 8px;
    }

    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      font-size: 16px;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
      min-height: 100vh;
    }
    ::selection { background: rgba(99,91,255,0.3); color: white; }
    a { color: inherit; text-decoration: none; }
    button { font-family: inherit; cursor: pointer; }
    input, textarea { font-family: inherit; }
    ::-webkit-scrollbar { width: 5px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.15); }

    /* === BACKGROUND EFFECTS === */
    .bg-glow {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }
    .bg-glow::before {
      content: '';
      position: absolute;
      top: -20%;
      left: 30%;
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(99,91,255,0.04), transparent 70%);
      animation: glowFloat 12s ease-in-out infinite;
    }
    .bg-glow::after {
      content: '';
      position: absolute;
      bottom: -10%;
      right: 20%;
      width: 500px;
      height: 500px;
      background: radial-gradient(circle, rgba(0,212,255,0.03), transparent 70%);
      animation: glowFloat 15s ease-in-out infinite reverse;
    }
    @keyframes glowFloat {
      0%, 100% { transform: translate(0, 0) scale(1); }
      33% { transform: translate(30px, -20px) scale(1.1); }
      66% { transform: translate(-20px, 15px) scale(0.95); }
    }

    /* === PARTICLES === */
    .particles-canvas {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    /* === WIZARD CONTAINER === */
    .wizard {
      position: relative;
      z-index: 1;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* === NAV / HEADER === */
    .wizard__header {
      position: fixed;
      top: 0; left: 0; right: 0;
      z-index: 100;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 32px;
      background: rgba(3,3,3,0.8);
      backdrop-filter: blur(24px);
      -webkit-backdrop-filter: blur(24px);
      border-bottom: 1px solid var(--glass-border);
    }
    .wizard__logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-family: 'Space Grotesk', sans-serif;
      font-size: 18px;
      font-weight: 700;
      letter-spacing: -0.02em;
      color: var(--text);
      text-decoration: none;
    }
    .wizard__logo svg {
      width: 28px;
      height: 28px;
    }
    .wizard__close {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: var(--text-dim);
      padding: 7px 14px;
      border: 1px solid var(--border);
      border-radius: var(--radius-xs);
      transition: all 0.2s;
      text-decoration: none;
    }
    .wizard__close:hover {
      color: white;
      border-color: var(--border-hover);
      background: var(--surface);
    }

    /* === PROGRESS BAR === */
    .wizard__progress {
      position: fixed;
      top: 60px; left: 0; right: 0;
      z-index: 99;
      background: rgba(3,3,3,0.85);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-bottom: 1px solid var(--glass-border);
      padding: 16px 32px 12px;
    }
    .wizard__steps {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0;
      margin-bottom: 12px;
    }
    .wizard__step-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: var(--text-muted);
      font-weight: 500;
      transition: all 0.3s;
    }
    .wizard__step-indicator.active {
      color: var(--text);
    }
    .wizard__step-indicator.completed {
      color: var(--cyan);
    }
    .wizard__step-number {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
      font-family: 'Space Grotesk', sans-serif;
      border: 1.5px solid var(--border);
      background: transparent;
      transition: all 0.3s;
    }
    .wizard__step-indicator.active .wizard__step-number {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
      box-shadow: 0 0 16px var(--glow-accent);
    }
    .wizard__step-indicator.completed .wizard__step-number {
      background: var(--cyan);
      border-color: var(--cyan);
      color: #030303;
      box-shadow: 0 0 12px var(--glow-cyan);
    }
    .wizard__step-connector {
      width: 60px;
      height: 2px;
      background: var(--border);
      margin: 0 16px;
      border-radius: 1px;
      position: relative;
      overflow: hidden;
      transition: all 0.3s;
    }
    .wizard__step-connector.completed {
      background: var(--cyan);
      box-shadow: 0 0 8px var(--glow-cyan);
    }
    .wizard__progress-bar {
      width: 100%;
      height: 3px;
      background: rgba(255,255,255,0.04);
      border-radius: 2px;
      overflow: hidden;
    }
    .wizard__progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), var(--cyan));
      border-radius: 2px;
      transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }
    .wizard__progress-fill::after {
      content: '';
      position: absolute;
      right: 0;
      top: -1px;
      width: 6px;
      height: 5px;
      background: var(--cyan);
      border-radius: 50%;
      box-shadow: 0 0 10px var(--cyan), 0 0 20px var(--glow-cyan);
    }

    /* === CONTENT AREA === */
    .wizard__content {
      flex: 1;
      padding-top: 140px;
      padding-bottom: 60px;
    }

    /* === PANELS === */
    .wizard__panel {
      display: none;
      max-width: 720px;
      margin: 0 auto;
      padding: 0 24px;
      animation: panelIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .wizard__panel.active {
      display: block;
    }
    @keyframes panelIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* === STEP 1: GOAL === */
    .step-goal__header {
      text-align: center;
      margin-bottom: 40px;
    }
    .step-goal__title {
      font-family: 'Space Grotesk', sans-serif;
      font-size: clamp(1.6rem, 4vw, 2.4rem);
      font-weight: 700;
      letter-spacing: -0.03em;
      line-height: 1.1;
      margin-bottom: 12px;
      background: linear-gradient(135deg, #fff 40%, var(--cyan) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .step-goal__subtitle {
      font-size: 15px;
      color: var(--text-dim);
      line-height: 1.6;
      max-width: 500px;
      margin: 0 auto;
    }

    /* Textarea */
    .step-goal__input-area {
      position: relative;
      margin-bottom: 32px;
    }
    .step-goal__textarea {
      width: 100%;
      min-height: 120px;
      padding: 20px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      color: var(--text);
      font-size: 15px;
      line-height: 1.6;
      resize: vertical;
      outline: none;
      transition: all 0.3s;
      backdrop-filter: blur(8px);
    }
    .step-goal__textarea::placeholder {
      color: var(--text-muted);
    }
    .step-goal__textarea:focus {
      border-color: rgba(99,91,255,0.3);
      box-shadow: 0 0 0 3px rgba(99,91,255,0.08), 0 4px 20px rgba(0,0,0,0.3);
      background: rgba(255,255,255,0.04);
    }
    .step-goal__char-count {
      position: absolute;
      bottom: 12px;
      right: 16px;
      font-size: 12px;
      color: var(--text-muted);
      font-family: 'Space Grotesk', sans-serif;
    }

    /* Category chips */
    .step-goal__categories {
      margin-bottom: 32px;
    }
    .step-goal__categories-label {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-family: 'Space Grotesk', sans-serif;
      font-weight: 500;
    }
    .step-goal__category-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .step-goal__chip {
      display: inline-flex;
      align-items: center;
      gap: 7px;
      padding: 9px 16px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 100px;
      color: var(--text-dim);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      backdrop-filter: blur(4px);
    }
    .step-goal__chip svg {
      width: 15px;
      height: 15px;
      opacity: 0.6;
      transition: opacity 0.3s;
    }
    .step-goal__chip:hover {
      border-color: var(--border-hover);
      color: var(--text);
      background: var(--surface-2);
    }
    .step-goal__chip:hover svg { opacity: 1; }
    .step-goal__chip.selected {
      background: rgba(99,91,255,0.12);
      border-color: rgba(99,91,255,0.3);
      color: white;
      box-shadow: 0 0 16px rgba(99,91,255,0.1);
    }
    .step-goal__chip.selected svg { opacity: 1; color: var(--cyan); }

    /* Model buttons */
    .step-goal__model-select {
      margin-bottom: 36px;
    }
    .step-goal__model-label {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-family: 'Space Grotesk', sans-serif;
      font-weight: 500;
    }
    .step-goal__models {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .step-goal__model {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-sm);
      color: var(--text-dim);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      backdrop-filter: blur(4px);
    }
    .step-goal__model svg {
      opacity: 0.5;
      transition: opacity 0.3s;
    }
    .step-goal__model:hover {
      border-color: var(--border-hover);
      color: var(--text);
      background: var(--surface-2);
    }
    .step-goal__model:hover svg { opacity: 0.8; }
    .step-goal__model.selected {
      background: rgba(99,91,255,0.1);
      border-color: rgba(99,91,255,0.3);
      color: white;
      box-shadow: 0 0 20px rgba(99,91,255,0.1), inset 0 0 20px rgba(99,91,255,0.04);
    }
    .step-goal__model.selected svg { opacity: 1; color: var(--cyan); }

    /* Continue button area */
    .step-goal__actions {
      display: flex;
      justify-content: center;
    }

    /* === BUTTONS === */
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 13px 28px;
      border-radius: var(--radius-sm);
      font-family: 'Space Grotesk', sans-serif;
      font-weight: 600;
      font-size: 14px;
      letter-spacing: 0.01em;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      border: none;
    }
    .btn--primary {
      background: linear-gradient(135deg, var(--accent), var(--purple));
      color: white;
      box-shadow: 0 4px 20px rgba(99,91,255,0.2);
    }
    .btn--primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 30px rgba(99,91,255,0.35);
    }
    .btn--primary:disabled {
      opacity: 0.35;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    .btn--ghost {
      background: transparent;
      color: var(--text-dim);
      border: 1px solid var(--border);
    }
    .btn--ghost:hover {
      color: white;
      border-color: var(--border-hover);
      background: var(--surface);
    }
    .btn--lg {
      padding: 15px 32px;
      font-size: 15px;
    }
    .btn--sm {
      padding: 7px 14px;
      font-size: 12px;
    }
    .btn svg {
      flex-shrink: 0;
    }

    /* === STEP 2: QUESTIONS === */
    .step-questions__header {
      text-align: center;
      margin-bottom: 36px;
    }
    .step-questions__context {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 16px;
      background: rgba(0,212,255,0.06);
      border: 1px solid rgba(0,212,255,0.12);
      border-radius: 100px;
      font-size: 12px;
      font-weight: 500;
      color: var(--cyan);
      margin-bottom: 16px;
      font-family: 'Space Grotesk', sans-serif;
      letter-spacing: 0.03em;
    }
    .step-questions__title {
      font-family: 'Space Grotesk', sans-serif;
      font-size: clamp(1.4rem, 3.5vw, 2rem);
      font-weight: 700;
      letter-spacing: -0.03em;
      margin-bottom: 8px;
    }
    .step-questions__subtitle {
      font-size: 14px;
      color: var(--text-dim);
    }

    /* Question cards */
    .step-questions__list {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 32px;
    }
    .question-card {
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      padding: 24px;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      transition: all 0.3s;
    }
    .question-card:hover {
      border-color: var(--border-hover);
      background: var(--surface-2);
    }
    .question-card__number {
      font-size: 11px;
      color: var(--cyan);
      font-family: 'Space Grotesk', sans-serif;
      font-weight: 600;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      margin-bottom: 8px;
    }
    .question-card__text {
      font-size: 16px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
      font-family: 'Space Grotesk', sans-serif;
      letter-spacing: -0.01em;
    }
    .question-card__hint {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 14px;
    }
    .question-card__input {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255,255,255,0.03);
      border: 1px solid var(--border);
      border-radius: var(--radius-xs);
      color: var(--text);
      font-size: 14px;
      line-height: 1.5;
      outline: none;
      transition: all 0.3s;
      resize: vertical;
    }
    .question-card__input::placeholder {
      color: var(--text-muted);
    }
    .question-card__input:focus {
      border-color: rgba(99,91,255,0.3);
      box-shadow: 0 0 0 3px rgba(99,91,255,0.06);
      background: rgba(255,255,255,0.04);
    }
    .question-card__options {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .question-card__option {
      padding: 8px 14px;
      background: rgba(255,255,255,0.03);
      border: 1px solid var(--border);
      border-radius: 100px;
      color: var(--text-dim);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.25s;
    }
    .question-card__option:hover {
      border-color: var(--border-hover);
      color: var(--text);
      background: var(--surface-2);
    }
    .question-card__option.selected {
      background: rgba(0,212,255,0.1);
      border-color: rgba(0,212,255,0.25);
      color: var(--cyan);
      box-shadow: 0 0 12px rgba(0,212,255,0.08);
    }

    /* Question actions */
    .step-questions__actions {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      flex-wrap: wrap;
    }
    .step-questions__skip {
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 13px;
      cursor: pointer;
      padding: 8px 0;
      transition: color 0.2s;
    }
    .step-questions__skip:hover {
      color: var(--text-dim);
    }

    /* === STEP 3: PACK === */

    /* Generating state */
    .step-pack__generating {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 350px;
      text-align: center;
    }
    .generating__spinner {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: 2px solid var(--border);
      border-top-color: transparent;
      background: conic-gradient(from 0deg, var(--accent), var(--cyan), var(--purple), var(--accent));
      -webkit-mask: radial-gradient(farthest-side, transparent calc(100% - 3px), #000 calc(100% - 2px));
      mask: radial-gradient(farthest-side, transparent calc(100% - 3px), #000 calc(100% - 2px));
      animation: spinGradient 1.2s linear infinite;
      margin-bottom: 24px;
    }
    @keyframes spinGradient {
      to { transform: rotate(360deg); }
    }
    .generating__text {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 8px;
    }
    .generating__step {
      font-size: 13px;
      color: var(--text-dim);
      transition: opacity 0.3s;
      min-height: 20px;
    }

    /* Pack result */
    .step-pack__result {
      display: none;
    }
    .step-pack__result.visible {
      display: block;
      animation: panelIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .step-pack__header {
      text-align: center;
      margin-bottom: 32px;
    }
    .step-pack__title {
      font-family: 'Space Grotesk', sans-serif;
      font-size: clamp(1.5rem, 3.5vw, 2.2rem);
      font-weight: 700;
      letter-spacing: -0.03em;
      margin-bottom: 8px;
      background: linear-gradient(135deg, #fff 40%, var(--success) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .step-pack__subtitle {
      font-size: 14px;
      color: var(--text-dim);
    }

    /* Pack preview blocks */
    .pack-preview {
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      margin-bottom: 14px;
      overflow: hidden;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      transition: all 0.3s;
    }
    .pack-preview:hover {
      border-color: var(--border-hover);
    }
    .pack-preview__header {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 20px;
      border-bottom: 1px solid var(--glass-border);
      flex-wrap: wrap;
    }
    .pack-preview__label {
      font-size: 10px;
      font-weight: 700;
      font-family: 'Space Grotesk', sans-serif;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--cyan);
      padding: 3px 8px;
      background: rgba(0,212,255,0.08);
      border-radius: 4px;
    }
    .pack-preview__title {
      font-size: 13px;
      color: var(--text-dim);
      flex: 1;
    }
    .pack-copy-btn {
      margin-left: auto;
    }
    .pack-preview__content {
      padding: 20px;
      font-family: 'JetBrains Mono', 'SF Mono', 'Fira Code', monospace;
      font-size: 12px;
      line-height: 1.7;
      color: var(--text-dim);
      white-space: pre-wrap;
      word-break: break-word;
      max-height: 300px;
      overflow-y: auto;
      margin: 0;
      background: transparent;
    }
    .pack-preview__content::-webkit-scrollbar { width: 4px; }
    .pack-preview__content::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 2px; }

    /* Toggle section */
    .pack-preview[data-collapsed="true"] .pack-preview__content {
      max-height: 0;
      padding: 0 20px;
      overflow: hidden;
    }
    .pack-preview__header {
      cursor: pointer;
    }

    /* Pack branding */
    .pack-branding {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 20px;
      font-size: 13px;
      color: var(--text-muted);
    }
    .pack-branding__link {
      color: var(--cyan);
      font-weight: 600;
      transition: color 0.2s;
    }
    .pack-branding__link:hover { color: white; }
    .pack-branding__divider { opacity: 0.3; }

    /* Actions */
    .step-pack__actions {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 14px;
      margin-top: 24px;
      margin-bottom: 24px;
    }
    .step-pack__copy-all {
      width: 100%;
      max-width: 400px;
      justify-content: center;
    }

    /* Share */
    .step-pack__share {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      padding: 24px 0;
      border-top: 1px solid var(--border);
    }
    .step-pack__share-label {
      font-size: 13px;
      color: var(--text-muted);
      font-family: 'Space Grotesk', sans-serif;
    }
    .step-pack__share-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }

    /* Copy success animation */
    .btn--copy-success {
      color: var(--success) !important;
      border-color: rgba(34,197,94,0.3) !important;
    }

    /* === FOOTER === */
    .wizard__footer {
      position: relative;
      z-index: 1;
      border-top: 1px solid var(--border);
      padding: 24px 32px;
      text-align: center;
    }
    .wizard__footer p {
      font-size: 12px;
      color: var(--text-muted);
    }
    .wizard__footer a {
      color: var(--text-dim);
      transition: color 0.2s;
    }
    .wizard__footer a:hover { color: white; }

    /* === RESPONSIVE === */
    @media (max-width: 640px) {
      .wizard__header { padding: 0 16px; }
      .wizard__progress { padding: 14px 16px 10px; }
      .wizard__panel { padding: 0 16px; }
      .wizard__step-indicator span:not(.wizard__step-number) {
        display: none;
      }
      .wizard__step-connector { width: 32px; margin: 0 8px; }
      .step-goal__category-chips { gap: 6px; }
      .step-goal__chip { padding: 8px 12px; font-size: 12px; }
      .step-goal__models { flex-direction: column; }
      .step-goal__model { justify-content: center; }
      .step-questions__actions { flex-direction: column-reverse; align-items: stretch; text-align: center; }
      .pack-preview__header { padding: 12px 14px; }
      .pack-preview__content { padding: 14px; font-size: 11px; }
      .step-pack__share-buttons { flex-direction: column; align-items: center; }
      .wizard__footer { padding: 20px 16px; }
    }
  </style>
</head>
<body>

  <!-- Background effects -->
  <div class="bg-glow"></div>
  <canvas class="particles-canvas" id="particles-canvas"></canvas>

  <div class="wizard">

    <!-- ===== HEADER / NAV ===== -->
    <header class="wizard__header">
      <a href="/" class="wizard__logo">
        <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect width="32" height="32" rx="8" fill="#635BFF"/>
          <path d="M8 22V10l6 6 6-6v12" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="24" cy="10" r="2.5" fill="#00D4FF"/>
        </svg>
        ANIMA
      </a>
      <a href="/" class="wizard__close">
        <span>Close</span>
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </a>
    </header>

    <!-- ===== PROGRESS ===== -->
    <div class="wizard__progress">
      <div class="wizard__steps">
        <div class="wizard__step-indicator active" data-step="1">
          <span class="wizard__step-number">1</span>
          <span>Your goal</span>
        </div>
        <div class="wizard__step-connector"></div>
        <div class="wizard__step-indicator" data-step="2">
          <span class="wizard__step-number">2</span>
          <span>Smart questions</span>
        </div>
        <div class="wizard__step-connector"></div>
        <div class="wizard__step-indicator" data-step="3">
          <span class="wizard__step-number">3</span>
          <span>Your pack</span>
        </div>
      </div>
      <div class="wizard__progress-bar">
        <div class="wizard__progress-fill" style="width: 33%"></div>
      </div>
    </div>

    <!-- ===== WIZARD CONTENT ===== -->
    <div class="wizard__content">

      <!-- ===== STEP 1: GOAL ===== -->
      <div class="wizard__panel active" id="step-goal">

        <div class="step-goal__header">
          <h1 class="step-goal__title">What do you want to achieve?</h1>
          <p class="step-goal__subtitle">Describe your goal in your own words. Be as specific or as vague as you want -- we'll ask the right follow-up questions.</p>
        </div>

        <div class="step-goal__input-area">
          <textarea
            class="step-goal__textarea"
            id="goal-input"
            placeholder="Example: I need a professional landing page for my SaaS product that converts visitors into trial users..."
            maxlength="500"
            autofocus
          ></textarea>
          <span class="step-goal__char-count"><span id="char-count">0</span>/500</span>
        </div>

        <!-- Category chips -->
        <div class="step-goal__categories">
          <div class="step-goal__categories-label">Or pick a category to start:</div>
          <div class="step-goal__category-chips">
            <button class="step-goal__chip" data-category="website">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/></svg>
              Website
            </button>
            <button class="step-goal__chip" data-category="content">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/></svg>
              Content
            </button>
            <button class="step-goal__chip" data-category="business">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
              Business
            </button>
            <button class="step-goal__chip" data-category="code">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
              Code
            </button>
            <button class="step-goal__chip" data-category="research">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
              Research
            </button>
            <button class="step-goal__chip" data-category="automation">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
              Automation
            </button>
            <button class="step-goal__chip" data-category="design">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 19l7-7 3 3-7 7-3-3z"/><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="M2 2l7.586 7.586"/><circle cx="11" cy="11" r="2"/></svg>
              Design
            </button>
            <button class="step-goal__chip" data-category="education">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z"/><path d="M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z"/></svg>
              Education
            </button>
            <button class="step-goal__chip" data-category="legal">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
              Legal
            </button>
            <button class="step-goal__chip" data-category="personal">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg>
              Personal
            </button>
          </div>
        </div>

        <!-- AI Model selection -->
        <div class="step-goal__model-select">
          <div class="step-goal__model-label">Optimize for:</div>
          <div class="step-goal__models">
            <button class="step-goal__model selected" data-model="chatgpt">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M22.28 14.5a5.2 5.2 0 01-.46 4.33 5.26 5.26 0 01-5.69 2.56 5.2 5.2 0 01-3.88 1.73 5.26 5.26 0 01-5.04-3.63 5.2 5.2 0 01-3.47-2.53 5.26 5.26 0 01.64-6.2A5.2 5.2 0 014.84 6.4a5.26 5.26 0 015.69-2.56A5.2 5.2 0 0114.41 2a5.26 5.26 0 015.04 3.63 5.2 5.2 0 013.47 2.53 5.26 5.26 0 01-.64 6.34z"/></svg>
              ChatGPT
            </button>
            <button class="step-goal__model" data-model="claude">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><circle cx="12" cy="12" r="10"/></svg>
              Claude
            </button>
            <button class="step-goal__model" data-model="gemini">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M12 2L2 12l10 10 10-10L12 2z"/></svg>
              Gemini
            </button>
          </div>
        </div>

        <!-- Continue -->
        <div class="step-goal__actions">
          <button class="btn btn--primary btn--lg" id="btn-continue-goal" disabled>
            Continue
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
          </button>
        </div>

      </div>

      <!-- ===== STEP 2: QUESTIONS ===== -->
      <div class="wizard__panel" id="step-questions">

        <div class="step-questions__header">
          <div class="step-questions__context" id="questions-context">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
            <span id="context-label">Website -- ChatGPT</span>
          </div>
          <h2 class="step-questions__title">A few smart questions.</h2>
          <p class="step-questions__subtitle">Your answers shape the expertise we build. Skip any you're not sure about.</p>
        </div>

        <div class="step-questions__list" id="questions-list">
          <!-- Questions injected by JS -->
        </div>

        <div class="step-questions__actions">
          <button class="step-questions__skip" id="btn-skip-questions">Skip -- generate with defaults</button>
          <button class="btn btn--primary btn--lg" id="btn-generate">
            Generate Pack
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
          </button>
        </div>

      </div>

      <!-- ===== STEP 3: PACK RESULT ===== -->
      <div class="wizard__panel" id="step-pack">

        <!-- Generating state -->
        <div class="step-pack__generating" id="generating-state">
          <div class="generating__spinner"></div>
          <div class="generating__text">Building your expertise pack...</div>
          <div class="generating__step" id="generating-step">Analyzing your goal and context</div>
        </div>

        <!-- Result state -->
        <div class="step-pack__result" id="pack-result">
          <!-- Rendered by JS -->
        </div>

      </div>

    </div>

    <!-- ===== FOOTER ===== -->
    <footer class="wizard__footer">
      <p>&copy; 2025 <a href="/">ANIMA</a> by Christian Bucher. Free AI expertise packs.</p>
    </footer>

  </div>

  <!-- ===== INLINE JAVASCRIPT ===== -->
  <script>
  (function() {
    'use strict';

    /* --------------------------------------------------------------------------
       PARTICLES (lightweight background effect)
       -------------------------------------------------------------------------- */

    (function initParticles() {
      const canvas = document.getElementById('particles-canvas');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      let particles = [];
      let w, h;
      let animId;

      function resize() {
        w = canvas.width = window.innerWidth;
        h = canvas.height = window.innerHeight;
      }

      function createParticles() {
        particles = [];
        const count = Math.min(Math.floor((w * h) / 25000), 60);
        for (let i = 0; i < count; i++) {
          particles.push({
            x: Math.random() * w,
            y: Math.random() * h,
            vx: (Math.random() - 0.5) * 0.3,
            vy: (Math.random() - 0.5) * 0.3,
            r: Math.random() * 1.5 + 0.5,
            alpha: Math.random() * 0.15 + 0.03
          });
        }
      }

      function draw() {
        ctx.clearRect(0, 0, w, h);
        particles.forEach(p => {
          p.x += p.vx;
          p.y += p.vy;
          if (p.x < 0) p.x = w;
          if (p.x > w) p.x = 0;
          if (p.y < 0) p.y = h;
          if (p.y > h) p.y = 0;

          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fillStyle = 'rgba(99, 91, 255, ' + p.alpha + ')';
          ctx.fill();
        });
        animId = requestAnimationFrame(draw);
      }

      resize();
      createParticles();
      draw();

      window.addEventListener('resize', () => {
        resize();
        createParticles();
      });
    })();


    /* --------------------------------------------------------------------------
       STATE
       -------------------------------------------------------------------------- */

    const state = {
      step: 1,
      goal: '',
      category: null,
      model: 'chatgpt',
      answers: {},
      generatedPack: null
    };


    /* --------------------------------------------------------------------------
       LABEL MAP
       -------------------------------------------------------------------------- */

    const LABEL_MAP = {
      audience: 'Target audience', conversion: 'Conversion action', style: 'Style',
      pages: 'Sections needed', constraints: 'Constraints', type: 'Type',
      voice: 'Tone & voice', objective: 'Objective', context: 'Additional context',
      industry: 'Industry & stage', metrics: 'Key metrics', ask: 'Decision/ask',
      stack: 'Tech stack', requirements: 'Core features', quality: 'Quality standards',
      topic: 'Topic', depth: 'Depth & format', sources: 'Sources/methodology',
      output: 'Output use', tools: 'Current tools', trigger: 'Trigger',
      volume: 'Scale & frequency', brand: 'Brand personality', colors: 'Colors',
      inspiration: 'Inspiration', learners: 'Learners', method: 'Teaching method',
      duration: 'Duration & assessment', jurisdiction: 'Jurisdiction',
      parties: 'Parties involved', specifics: 'Specific requirements',
      priority: 'Priority', situation: 'Current situation', outcome: 'Desired outcome',
      preferences: 'Preferences', tried: 'Already tried'
    };


    /* --------------------------------------------------------------------------
       QUESTION BANK
       -------------------------------------------------------------------------- */

    const questionBank = {
      website: [
        { id: 'audience', text: 'Who is this website for?', hint: 'Be specific: demographics, needs, tech-savviness.', type: 'text', placeholder: 'e.g. SaaS founders aged 25-45, tech-savvy, value speed...' },
        { id: 'conversion', text: 'What should visitors DO on this site?', hint: 'The single most important conversion action.', type: 'text', placeholder: 'e.g. Sign up for free trial, book a demo, buy the product...' },
        { id: 'style', text: 'What style and tone?', hint: 'Pick all that match your vision.', type: 'chips', options: ['Minimalist', 'Bold', 'Professional', 'Playful', 'Luxury', 'Technical', 'Warm', 'Dark'] },
        { id: 'pages', text: 'What pages or sections do you need?', hint: 'Check all that apply.', type: 'chips', options: ['Hero / Landing', 'Features', 'Pricing', 'Testimonials', 'FAQ', 'Contact', 'Blog', 'Dashboard'] },
        { id: 'constraints', text: 'Any technical requirements or constraints?', hint: 'Framework, timeline, integrations, etc.', type: 'textarea', placeholder: 'e.g. Next.js, must launch in 2 weeks, integrate Stripe...' }
      ],
      content: [
        { id: 'type', text: 'What type of content?', hint: 'Select the primary format.', type: 'chips', options: ['Blog post', 'Social media', 'Newsletter', 'Ad copy', 'Email sequence', 'Video script', 'Whitepaper', 'Case study'] },
        { id: 'audience', text: 'Who is the target audience?', hint: 'The more specific, the better the output.', type: 'text', placeholder: 'e.g. B2B marketing managers at mid-size companies...' },
        { id: 'voice', text: 'What tone and voice?', hint: 'Pick all that match your brand.', type: 'chips', options: ['Professional', 'Conversational', 'Authoritative', 'Witty', 'Empathetic', 'Bold', 'Educational', 'Provocative'] },
        { id: 'objective', text: 'What should this content achieve?', hint: 'The specific outcome you want.', type: 'text', placeholder: 'e.g. Drive 500 signups, establish thought leadership, go viral...' },
        { id: 'context', text: 'Any brand guidelines or examples to follow?', hint: 'Reference competitors, style guides, or examples you love.', type: 'textarea', placeholder: "e.g. Write like Basecamp's blog \u2014 direct, opinionated, no fluff..." }
      ],
      business: [
        { id: 'type', text: 'What business document?', hint: 'Select the primary deliverable.', type: 'chips', options: ['Business plan', 'Pitch deck', 'Market analysis', 'SWOT', 'Financial model', 'Go-to-market', 'Competitive analysis', 'Executive summary'] },
        { id: 'industry', text: 'What industry and stage?', hint: 'Context helps us tailor the framework.', type: 'text', placeholder: 'e.g. B2B SaaS, pre-seed, fintech space...' },
        { id: 'audience', text: 'Who will read this?', hint: 'This shapes the depth and format.', type: 'chips', options: ['Investors / VCs', 'Board / Executives', 'Co-founders', 'Employees', 'Partners', 'Customers', 'Government', 'Self'] },
        { id: 'metrics', text: 'What key metrics or data do you have?', hint: 'Revenue, users, growth rate, market size, etc.', type: 'textarea', placeholder: 'e.g. $15K MRR, 200 users, 15% MoM growth, $4.2B TAM...' },
        { id: 'ask', text: 'What is the specific ask or decision?', hint: 'What should the reader do after reading?', type: 'text', placeholder: 'e.g. Invest $500K at $5M valuation, approve budget...' }
      ],
      code: [
        { id: 'type', text: 'What are you building?', hint: 'Select the primary project type.', type: 'chips', options: ['Web app', 'API / Backend', 'Mobile app', 'CLI tool', 'Database', 'DevOps / CI/CD', 'Chrome extension', 'Automation script'] },
        { id: 'stack', text: 'What tech stack?', hint: 'Languages, frameworks, databases.', type: 'text', placeholder: 'e.g. TypeScript, Next.js, PostgreSQL, Vercel...' },
        { id: 'requirements', text: 'What are the core features?', hint: 'List the must-have functionality.', type: 'textarea', placeholder: 'e.g. User auth (OAuth + email), real-time dashboard, Stripe billing, admin panel...' },
        { id: 'quality', text: 'What quality standards?', hint: 'Select all that apply.', type: 'chips', options: ['Tests required', 'TypeScript strict', 'CI/CD pipeline', 'Documentation', 'Performance focus', 'Security audit', 'Accessibility', 'Mobile-first'] },
        { id: 'context', text: 'Anything else the AI should know?', hint: 'Existing codebase, team size, deadline, etc.', type: 'textarea', placeholder: 'e.g. Migrating from PHP monolith, team of 3, launch in March...' }
      ],
      research: [
        { id: 'type', text: 'What type of research?', hint: 'Select the primary research format.', type: 'chips', options: ['Market research', 'Academic paper', 'Competitive intel', 'User research', 'Literature review', 'Data analysis', 'Trend report', 'Feasibility study'] },
        { id: 'topic', text: 'What is the specific research question?', hint: 'The more precise, the better.', type: 'text', placeholder: 'e.g. What is the market size for AI-powered code review tools in 2025?' },
        { id: 'depth', text: 'What depth and format?', hint: 'Select the level of analysis.', type: 'chips', options: ['Quick overview', 'Detailed report', 'Executive summary', 'Full analysis', 'Data-heavy', 'Visual / Charts', 'Actionable insights', 'Academic rigor'] },
        { id: 'sources', text: 'Any preferred sources or methodologies?', hint: 'Databases, frameworks, or approaches to use.', type: 'textarea', placeholder: "e.g. Use Porter's Five Forces, cite recent Gartner/McKinsey reports..." },
        { id: 'output', text: 'How will you use this research?', hint: 'This shapes the output format and recommendations.', type: 'text', placeholder: 'e.g. Present to board for market-entry decision, write blog series...' }
      ],
      automation: [
        { id: 'type', text: 'What do you want to automate?', hint: 'Select the primary automation area.', type: 'chips', options: ['Email workflows', 'CRM automation', 'Report generation', 'Data pipeline', 'Social posting', 'Customer onboarding', 'Invoice processing', 'Monitoring / Alerts'] },
        { id: 'tools', text: 'What tools do you currently use?', hint: 'List your current tech stack.', type: 'text', placeholder: 'e.g. Zapier, Google Sheets, Slack, HubSpot, Stripe...' },
        { id: 'trigger', text: 'What triggers the automation?', hint: 'What event or condition starts the workflow.', type: 'text', placeholder: 'e.g. New form submission, daily at 9am, when payment received...' },
        { id: 'volume', text: 'What scale and frequency?', hint: 'How often and how much data.', type: 'chips', options: ['< 10/day', '10-100/day', '100-1000/day', '1000+/day', 'Real-time', 'Batch daily', 'Batch weekly', 'On-demand'] },
        { id: 'constraints', text: 'Any constraints or requirements?', hint: 'Budget, security, compliance, existing systems.', type: 'textarea', placeholder: 'e.g. GDPR compliant, no-code preferred, budget under $50/month...' }
      ],
      design: [
        { id: 'type', text: 'What are you designing?', hint: 'Select the primary deliverable.', type: 'chips', options: ['Logo', 'UI/UX', 'Brand identity', 'Illustration', 'Social graphics', 'Presentation', 'Icon set', 'Marketing materials'] },
        { id: 'brand', text: 'Describe the brand personality.', hint: 'If it were a person, how would you describe them?', type: 'text', placeholder: 'e.g. Innovative, trustworthy, young, premium but accessible...' },
        { id: 'style', text: 'Visual style preferences?', hint: 'Select all that resonate.', type: 'chips', options: ['Minimalist', 'Bold / Graphic', 'Organic / Natural', 'Geometric', 'Retro / Vintage', 'Futuristic', 'Handmade', 'Corporate'] },
        { id: 'colors', text: 'Any color or visual constraints?', hint: "Existing brand colors, do's and don'ts.", type: 'text', placeholder: 'e.g. Primary: #635BFF, avoid red, dark mode preferred...' },
        { id: 'inspiration', text: 'Any brands or designs you admire?', hint: 'References help us calibrate the output.', type: 'textarea', placeholder: 'e.g. Apple for minimalism, Stripe for illustrations, Linear for UI...' }
      ],
      education: [
        { id: 'type', text: 'What educational content?', hint: 'Select the primary format.', type: 'chips', options: ['Course plan', 'Lesson plan', 'Study guide', 'Tutorial', 'Quiz / Assessment', 'Workshop', 'Curriculum', 'Flashcards'] },
        { id: 'topic', text: 'What subject and level?', hint: 'Be specific about the topic and student level.', type: 'text', placeholder: 'e.g. Intro to Python for complete beginners, ages 16-20...' },
        { id: 'learners', text: 'Who are the learners?', hint: 'Age, background, motivation.', type: 'text', placeholder: 'e.g. College freshmen, no programming experience, visual learners...' },
        { id: 'method', text: 'Teaching approach?', hint: 'Select preferred methods.', type: 'chips', options: ['Hands-on / Projects', 'Lecture-based', 'Discussion', 'Gamified', 'Self-paced', 'Peer learning', 'Case studies', 'Flipped classroom'] },
        { id: 'duration', text: 'Duration and assessment needs?', hint: 'How long and how to measure success.', type: 'textarea', placeholder: 'e.g. 8-week course, weekly quizzes, final project, certificate...' }
      ],
      legal: [
        { id: 'type', text: 'What legal/finance document?', hint: 'Select the primary deliverable.', type: 'chips', options: ['Contract', 'Terms of Service', 'Privacy Policy', 'NDA', 'Tax planning', 'Budget', 'Compliance review', 'Invoice template'] },
        { id: 'jurisdiction', text: 'What jurisdiction or context?', hint: 'Country, state, industry regulations.', type: 'text', placeholder: 'e.g. EU/GDPR, US Delaware LLC, Austrian tax law...' },
        { id: 'parties', text: 'Who are the parties involved?', hint: 'Describe the entities and relationship.', type: 'text', placeholder: 'e.g. SaaS company (us) and enterprise client (them)...' },
        { id: 'specifics', text: 'Any specific clauses or requirements?', hint: 'Key terms, amounts, special conditions.', type: 'textarea', placeholder: 'e.g. 30-day termination, IP ownership stays with us, liability cap at contract value...' },
        { id: 'priority', text: 'What matters most?', hint: 'Select your priorities.', type: 'chips', options: ['Protection', 'Simplicity', 'Fairness', 'Compliance', 'Flexibility', 'Speed', 'Cost savings', 'Thoroughness'] }
      ],
      personal: [
        { id: 'type', text: 'What do you need help with?', hint: 'Select the primary area.', type: 'chips', options: ['Travel plan', 'Fitness routine', 'Meal plan / Recipes', 'Coaching', 'Journaling', 'Goal setting', 'Habit building', 'Life organization'] },
        { id: 'situation', text: 'Describe your current situation.', hint: 'Context helps personalize the output.', type: 'text', placeholder: 'e.g. 30yo, desk job, want to get fit, 3x/week available...' },
        { id: 'outcome', text: 'What specific outcome do you want?', hint: 'The more specific, the better.', type: 'text', placeholder: 'e.g. Lose 10kg in 6 months, visit 5 countries in 3 weeks...' },
        { id: 'preferences', text: 'Any preferences or constraints?', hint: 'Select all that apply.', type: 'chips', options: ['Budget-friendly', 'Time-efficient', 'Science-based', 'Fun / Creative', 'Structured', 'Flexible', 'Social', 'Solo'] },
        { id: 'context', text: 'Anything else important?', hint: 'Allergies, injuries, travel dates, etc.', type: 'textarea', placeholder: 'e.g. Vegetarian, bad knees, traveling in July, budget $3000...' }
      ]
    };

    const defaultQuestions = [
      { id: 'audience', text: 'Who is this for?', hint: 'The primary audience or end user.', type: 'text', placeholder: 'e.g. My team, my clients, myself...' },
      { id: 'outcome', text: 'What is the ideal outcome?', hint: 'What does success look like?', type: 'text', placeholder: 'e.g. A complete, ready-to-use deliverable...' },
      { id: 'style', text: 'What tone and style?', hint: 'Pick all that match.', type: 'chips', options: ['Professional', 'Friendly', 'Bold', 'Minimalist', 'Playful', 'Technical', 'Casual', 'Authoritative'] },
      { id: 'constraints', text: 'Any constraints or requirements?', hint: 'Timeline, budget, tools, etc.', type: 'textarea', placeholder: 'e.g. Need it by Friday, use Google Docs format...' },
      { id: 'tried', text: 'What have you tried so far?', hint: 'Helps us avoid generic suggestions.', type: 'textarea', placeholder: 'e.g. I asked ChatGPT but the output was too vague...' }
    ];


    /* --------------------------------------------------------------------------
       PACK TEMPLATES
       -------------------------------------------------------------------------- */

    const packTemplates = {
      website: {
        role: 'senior web designer and conversion specialist with 15+ years of experience building high-converting websites',
        systemPrefix: 'You specialize in the intersection of visual design, user psychology, and conversion rate optimization.',
        tasks: [
          { title: 'Hero Section', desc: 'Design the above-the-fold experience that captures attention in 3 seconds and drives the primary CTA.' },
          { title: 'Value Proposition', desc: 'Craft the messaging framework: headline, sub-headline, and supporting copy that communicates unique value.' },
          { title: 'Social Proof Section', desc: 'Design the trust layer: testimonials, logos, metrics, and case study snippets that eliminate doubt.' },
          { title: 'CTA & Conversion Flow', desc: 'Optimize the conversion path: button copy, form design, micro-interactions, and friction reduction.' },
          { title: 'Mobile Optimization', desc: 'Ensure the design works flawlessly on mobile: touch targets, load speed, responsive layout.' },
          { title: 'SEO Foundation', desc: 'Set up the technical SEO: meta tags, heading structure, schema markup, and page speed optimization.' }
        ],
        checklist: ['Mobile responsive', 'Load time < 3s', 'Clear conversion path', 'Consistent brand', 'Accessible (WCAG 2.1)', 'SEO meta tags']
      },
      content: {
        role: 'senior content strategist and copywriter who has driven millions in revenue through words',
        systemPrefix: 'You understand that great content is strategy made visible \u2014 every word serves the goal.',
        tasks: [
          { title: 'Content Strategy Brief', desc: 'Define the content angle, hook, structure, and distribution plan aligned with the goal.' },
          { title: 'Headline Variations', desc: 'Generate 10 headline options using proven frameworks: AIDA, PAS, curiosity gap, benefit-driven.' },
          { title: 'Full Draft', desc: 'Write the complete first draft following the approved strategy, with proper formatting and flow.' },
          { title: 'CTA & Distribution', desc: 'Craft the call-to-action copy and plan the distribution across channels for maximum reach.' },
          { title: 'SEO Optimization', desc: 'Optimize for search: keyword placement, meta description, internal linking, and featured snippet targeting.' },
          { title: 'Repurpose Plan', desc: 'Create a repurposing strategy: turn one piece into 5+ formats (social, email, video script, etc.).' }
        ],
        checklist: ['Hooks reader in first line', 'Matches brand voice', 'Clear CTA', 'SEO optimized', 'Scannable formatting', 'Proofread']
      },
      business: {
        role: 'senior business strategist and management consultant from a top-tier firm (McKinsey/BCG level)',
        systemPrefix: 'You think in frameworks, communicate with data, and always tie analysis to actionable recommendations.',
        tasks: [
          { title: 'Executive Summary', desc: 'Write a compelling 1-page summary that captures the opportunity, strategy, and ask.' },
          { title: 'Market Analysis', desc: 'Size the market (TAM/SAM/SOM), identify trends, and map the competitive landscape.' },
          { title: 'Strategy Framework', desc: 'Apply the appropriate strategic framework and derive concrete, actionable recommendations.' },
          { title: 'Financial Projections', desc: 'Build the financial model: revenue forecast, unit economics, and key assumptions.' },
          { title: 'Risk Assessment', desc: 'Identify top risks, mitigation strategies, and scenario analysis (best/base/worst case).' },
          { title: 'Action Plan', desc: 'Create a 90-day action plan with milestones, owners, and success metrics.' }
        ],
        checklist: ['Data-backed claims', 'Clear recommendations', 'Realistic financials', 'Risk mitigation', 'Professional formatting', 'Compelling narrative']
      },
      code: {
        role: 'senior software engineer and architect with expertise across the full stack',
        systemPrefix: 'You write clean, maintainable, well-tested code. You think about edge cases, scalability, and developer experience.',
        tasks: [
          { title: 'Architecture Design', desc: 'Design the system architecture: components, data flow, API contracts, and technology choices.' },
          { title: 'Data Model', desc: 'Design the database schema: tables/collections, relationships, indexes, and migrations.' },
          { title: 'Core Implementation', desc: 'Implement the primary feature with proper error handling, typing, and documentation.' },
          { title: 'API Design', desc: 'Design RESTful or GraphQL endpoints: routes, request/response schemas, authentication.' },
          { title: 'Testing Strategy', desc: 'Write unit tests, integration tests, and define the testing strategy and CI pipeline.' },
          { title: 'Deployment & DevOps', desc: 'Set up the deployment pipeline: containerization, CI/CD, monitoring, and environment management.' }
        ],
        checklist: ['Type-safe', 'Error handling', 'Tests passing', 'Documentation', 'Security reviewed', 'Performance optimized']
      },
      research: {
        role: 'senior research analyst with expertise in systematic research methodology and data-driven insights',
        systemPrefix: 'You conduct thorough, methodical research and present findings with clarity and actionable conclusions.',
        tasks: [
          { title: 'Research Framework', desc: 'Define the research question, methodology, scope, and success criteria.' },
          { title: 'Data Collection Plan', desc: 'Identify sources, data collection methods, and quality criteria.' },
          { title: 'Analysis Framework', desc: 'Apply the appropriate analytical framework and synthesize key findings.' },
          { title: 'Key Findings', desc: 'Present the top insights with supporting evidence and visualizations.' },
          { title: 'Recommendations', desc: 'Derive actionable recommendations ranked by impact and feasibility.' },
          { title: 'Executive Report', desc: 'Compile the final report with executive summary, methodology, findings, and appendix.' }
        ],
        checklist: ['Sources cited', 'Methodology clear', 'Data reliable', 'Insights actionable', 'Bias acknowledged', 'Well-structured']
      },
      automation: {
        role: 'senior automation engineer and workflow architect who builds systems that run themselves',
        systemPrefix: 'You design robust, maintainable automations that save time and eliminate human error.',
        tasks: [
          { title: 'Workflow Map', desc: 'Map the complete automation workflow: triggers, conditions, actions, and error handling.' },
          { title: 'Tool Selection', desc: 'Select the optimal tools and integrations for each step of the workflow.' },
          { title: 'Implementation Plan', desc: 'Step-by-step implementation guide with code snippets and configuration details.' },
          { title: 'Error Handling', desc: 'Design the error handling and notification system for when things go wrong.' },
          { title: 'Testing Plan', desc: 'Create test scenarios: happy path, edge cases, failure modes, and load testing.' },
          { title: 'Monitoring & Maintenance', desc: 'Set up monitoring dashboards, alerts, and a maintenance schedule.' }
        ],
        checklist: ['Idempotent', 'Error handling', 'Monitoring', 'Documentation', 'Scalable', 'Cost-efficient']
      },
      design: {
        role: 'senior creative director and brand designer with a portfolio of award-winning work',
        systemPrefix: 'You understand that great design is invisible \u2014 it solves problems while looking effortless.',
        tasks: [
          { title: 'Creative Brief', desc: 'Define the design direction: mood, references, constraints, and success criteria.' },
          { title: 'Concept Exploration', desc: 'Generate 3-5 distinct design concepts with rationale for each direction.' },
          { title: 'Design System', desc: 'Define the visual language: colors, typography, spacing, components, and usage rules.' },
          { title: 'Primary Deliverable', desc: 'Create the main design asset with variations and usage guidelines.' },
          { title: 'Brand Guidelines', desc: "Document the brand rules: do's and don'ts, spacing, color usage, and examples." },
          { title: 'Asset Package', desc: 'List all deliverable formats, sizes, and file types needed for production.' }
        ],
        checklist: ['Brand consistent', 'Scalable / Vector', 'Accessible colors', 'Multiple formats', 'Usage guidelines', 'Print + digital ready']
      },
      education: {
        role: 'senior instructional designer and educator who makes complex topics accessible and engaging',
        systemPrefix: 'You apply proven learning science: spaced repetition, active recall, scaffolding, and engagement techniques.',
        tasks: [
          { title: 'Learning Objectives', desc: "Define SMART learning objectives using Bloom's taxonomy." },
          { title: 'Curriculum Map', desc: 'Structure the content: modules, lessons, progression, and prerequisite mapping.' },
          { title: 'Lesson Content', desc: 'Create engaging lesson content with explanations, examples, and activities.' },
          { title: 'Assessments', desc: 'Design formative and summative assessments that measure actual understanding.' },
          { title: 'Engagement Plan', desc: 'Add interactive elements: discussions, projects, gamification, and real-world applications.' },
          { title: 'Resources & Materials', desc: 'Compile supplementary materials: readings, videos, tools, and reference guides.' }
        ],
        checklist: ['Clear objectives', 'Progressive difficulty', 'Active learning', 'Assessment aligned', 'Inclusive design', 'Feedback loops']
      },
      legal: {
        role: 'senior legal consultant specializing in business law, contracts, and regulatory compliance',
        systemPrefix: 'You draft precise, clear legal language that protects interests while remaining accessible to non-lawyers.',
        tasks: [
          { title: 'Requirements Analysis', desc: 'Identify all legal requirements, regulations, and compliance needs.' },
          { title: 'Document Structure', desc: 'Outline the document with all necessary sections, clauses, and definitions.' },
          { title: 'Core Clauses', desc: 'Draft the key clauses with appropriate legal language and protections.' },
          { title: 'Risk Provisions', desc: 'Add limitation of liability, indemnification, and dispute resolution clauses.' },
          { title: 'Compliance Check', desc: 'Review against applicable regulations (GDPR, industry-specific, jurisdictional).' },
          { title: 'Plain Language Summary', desc: 'Create a non-lawyer-friendly summary of the key terms and obligations.' }
        ],
        checklist: ['Jurisdiction correct', 'All parties named', 'Terms defined', 'Liability limited', 'Compliance met', 'Plain language available']
      },
      personal: {
        role: 'senior life coach and personal strategist who helps people achieve their goals systematically',
        systemPrefix: 'You combine behavioral science with practical planning to create sustainable, enjoyable paths to goals.',
        tasks: [
          { title: 'Goal Definition', desc: 'Define SMART goals with clear metrics and timeline.' },
          { title: 'Current State Assessment', desc: 'Assess the starting point: strengths, gaps, resources, and constraints.' },
          { title: 'Action Plan', desc: 'Create a structured weekly/monthly plan with specific, manageable steps.' },
          { title: 'Habit System', desc: 'Design the habit stack: triggers, routines, rewards, and tracking method.' },
          { title: 'Progress Tracking', desc: 'Set up milestones, check-ins, and adjustment criteria.' },
          { title: 'Motivation & Accountability', desc: 'Build in accountability mechanisms and motivational strategies for tough days.' }
        ],
        checklist: ['Realistic timeline', 'Specific actions', 'Built-in flexibility', 'Progress measurable', 'Sustainability focus', 'Enjoyable process']
      }
    };

    const modelTips = {
      chatgpt: {
        name: 'ChatGPT',
        format: 'Use markdown headers (##) for structure. ChatGPT responds best to clear role assignments and step-by-step instructions.',
        tip: 'Start with "You are..." and use numbered lists for multi-step tasks. Use "Let\'s think step by step" for complex reasoning.',
        systemTag: '## System Prompt'
      },
      claude: {
        name: 'Claude',
        format: 'Use XML tags (<role>, <context>, <task>) for structure. Claude excels with explicit constraints and examples.',
        tip: 'Claude responds exceptionally well to XML-structured prompts and explicit thinking instructions. Use <thinking> tags for complex analysis.',
        systemTag: '<system>'
      },
      gemini: {
        name: 'Gemini',
        format: 'Use clear sections with bold headers. Gemini works best with specific examples and source-requesting patterns.',
        tip: 'Ask Gemini to cite sources and verify claims. Use "Based on current data..." prefixes for factual queries.',
        systemTag: '## System Instructions'
      }
    };


    /* --------------------------------------------------------------------------
       DOM REFS
       -------------------------------------------------------------------------- */

    const dom = {
      panels: document.querySelectorAll('.wizard__panel'),
      stepIndicators: document.querySelectorAll('.wizard__step-indicator'),
      connectors: document.querySelectorAll('.wizard__step-connector'),
      progressFill: document.querySelector('.wizard__progress-fill'),

      goalInput: document.getElementById('goal-input'),
      charCount: document.getElementById('char-count'),
      categoryChips: document.querySelectorAll('.step-goal__chip'),
      modelButtons: document.querySelectorAll('.step-goal__model'),
      continueBtn: document.getElementById('btn-continue-goal'),

      contextLabel: document.getElementById('context-label'),
      questionsList: document.getElementById('questions-list'),
      generateBtn: document.getElementById('btn-generate'),
      skipBtn: document.getElementById('btn-skip-questions'),

      generatingState: document.getElementById('generating-state'),
      generatingStep: document.getElementById('generating-step'),
      packResult: document.getElementById('pack-result')
    };


    /* --------------------------------------------------------------------------
       URL PARAMS
       -------------------------------------------------------------------------- */

    function loadUrlParams() {
      const params = new URLSearchParams(window.location.search);
      const query = params.get('q');
      if (query && dom.goalInput) {
        dom.goalInput.value = query;
        state.goal = query;
        updateCharCount();
        updateContinueButton();
      }
      const cat = params.get('cat');
      if (cat) {
        selectCategory(cat);
      }
    }


    /* --------------------------------------------------------------------------
       STEP NAVIGATION
       -------------------------------------------------------------------------- */

    function goToStep(stepNumber) {
      state.step = stepNumber;

      dom.panels.forEach(function(panel) { panel.classList.remove('active'); });
      var targetId = stepNumber === 1 ? 'step-goal' : stepNumber === 2 ? 'step-questions' : 'step-pack';
      var targetPanel = document.getElementById(targetId);
      if (targetPanel) targetPanel.classList.add('active');

      dom.stepIndicators.forEach(function(indicator, index) {
        var step = index + 1;
        indicator.classList.remove('active', 'completed');
        if (step < stepNumber) indicator.classList.add('completed');
        if (step === stepNumber) indicator.classList.add('active');
      });

      dom.connectors.forEach(function(connector, index) {
        connector.classList.toggle('completed', index + 1 < stepNumber);
      });

      var progress = (stepNumber / 3) * 100;
      if (dom.progressFill) {
        dom.progressFill.style.width = progress + '%';
      }

      window.scrollTo({ top: 0, behavior: 'smooth' });
    }


    /* --------------------------------------------------------------------------
       STEP 1 -- Goal Input
       -------------------------------------------------------------------------- */

    function updateCharCount() {
      if (!dom.goalInput || !dom.charCount) return;
      dom.charCount.textContent = dom.goalInput.value.length;
    }

    function updateContinueButton() {
      if (!dom.continueBtn) return;
      var hasInput = dom.goalInput && dom.goalInput.value.trim().length > 5;
      var hasCategory = state.category !== null;
      dom.continueBtn.disabled = !(hasInput || hasCategory);
    }

    function selectCategory(cat) {
      state.category = cat;
      dom.categoryChips.forEach(function(chip) {
        chip.classList.toggle('selected', chip.dataset.category === cat);
      });
      updateContinueButton();
    }

    function selectModel(model) {
      state.model = model;
      dom.modelButtons.forEach(function(btn) {
        btn.classList.toggle('selected', btn.dataset.model === model);
      });
    }

    function initStep1() {
      if (dom.goalInput) {
        dom.goalInput.addEventListener('input', function() {
          state.goal = dom.goalInput.value;
          updateCharCount();
          updateContinueButton();
        });
      }

      dom.categoryChips.forEach(function(chip) {
        chip.addEventListener('click', function() {
          var cat = chip.dataset.category;
          if (state.category === cat) {
            state.category = null;
            chip.classList.remove('selected');
          } else {
            selectCategory(cat);
          }
          updateContinueButton();
        });
      });

      dom.modelButtons.forEach(function(btn) {
        btn.addEventListener('click', function() {
          selectModel(btn.dataset.model);
        });
      });

      if (dom.continueBtn) {
        dom.continueBtn.addEventListener('click', function() {
          if (dom.continueBtn.disabled) return;

          var catName = state.category
            ? state.category.charAt(0).toUpperCase() + state.category.slice(1)
            : 'Custom';
          var modelName = modelTips[state.model] ? modelTips[state.model].name : state.model;
          if (dom.contextLabel) {
            dom.contextLabel.textContent = catName + ' \u2014 ' + modelName;
          }

          renderQuestions();
          goToStep(2);
        });
      }
    }


    /* --------------------------------------------------------------------------
       STEP 2 -- Dynamic Questions
       -------------------------------------------------------------------------- */

    function renderQuestions() {
      if (!dom.questionsList) return;

      var questions = state.category && questionBank[state.category]
        ? questionBank[state.category]
        : defaultQuestions;

      dom.questionsList.innerHTML = '';

      questions.forEach(function(q, index) {
        var card = document.createElement('div');
        card.className = 'question-card';
        card.dataset.questionId = q.id;

        var inputHtml = '';
        if (q.type === 'text') {
          inputHtml = '<input type="text" class="question-card__input" data-qid="' + q.id + '" placeholder="' + escapeHtml(q.placeholder || '') + '">';
        } else if (q.type === 'textarea') {
          inputHtml = '<textarea class="question-card__input" data-qid="' + q.id + '" rows="3" placeholder="' + escapeHtml(q.placeholder || '') + '"></textarea>';
        } else if (q.type === 'chips') {
          inputHtml = '<div class="question-card__options">' +
            q.options.map(function(opt) {
              return '<button class="question-card__option" data-qid="' + q.id + '">' + escapeHtml(opt) + '</button>';
            }).join('') +
            '</div>';
        }

        card.innerHTML =
          '<div class="question-card__number">Question ' + (index + 1) + ' of ' + questions.length + '</div>' +
          '<div class="question-card__text">' + escapeHtml(q.text) + '</div>' +
          '<div class="question-card__hint">' + escapeHtml(q.hint) + '</div>' +
          inputHtml;

        dom.questionsList.appendChild(card);
      });

      // Bind chip selection
      dom.questionsList.querySelectorAll('.question-card__option').forEach(function(btn) {
        btn.addEventListener('click', function() {
          btn.classList.toggle('selected');
        });
      });
    }

    function collectAnswers() {
      state.answers = {};

      document.querySelectorAll('.question-card__input').forEach(function(input) {
        var qid = input.dataset.qid;
        if (qid && input.value.trim()) {
          state.answers[qid] = input.value.trim();
        }
      });

      var chipsByQuestion = {};
      document.querySelectorAll('.question-card__option.selected').forEach(function(btn) {
        var qid = btn.dataset.qid;
        if (qid) {
          if (!chipsByQuestion[qid]) chipsByQuestion[qid] = [];
          chipsByQuestion[qid].push(btn.textContent.trim());
        }
      });
      Object.assign(state.answers, chipsByQuestion);
    }

    function initStep2() {
      if (dom.generateBtn) {
        dom.generateBtn.addEventListener('click', function() {
          collectAnswers();
          goToStep(3);
          startGeneration();
        });
      }

      if (dom.skipBtn) {
        dom.skipBtn.addEventListener('click', function() {
          goToStep(3);
          startGeneration();
        });
      }
    }


    /* --------------------------------------------------------------------------
       STEP 3 -- Pack Generation
       -------------------------------------------------------------------------- */

    function startGeneration() {
      if (!dom.generatingState || !dom.packResult) return;

      dom.generatingState.style.display = 'flex';
      dom.packResult.classList.remove('visible');

      var modelName = modelTips[state.model] ? modelTips[state.model].name : state.model;
      var steps = [
        'Analyzing your goal and context',
        'Mapping expertise requirements',
        'Designing prompt architecture',
        'Building system prompt',
        'Creating task-specific prompts',
        'Optimizing for ' + modelName,
        'Adding quality checks',
        'Finalizing your pack'
      ];

      var currentStep = 0;

      function nextStep() {
        if (currentStep < steps.length) {
          if (dom.generatingStep) {
            dom.generatingStep.textContent = steps[currentStep];
          }
          currentStep++;
          setTimeout(nextStep, 500 + Math.random() * 500);
        } else {
          generatePack();
          showResult();
        }
      }

      nextStep();
    }

    function generatePack() {
      var cat = state.category || 'website';
      var template = packTemplates[cat] || packTemplates.website;
      var model = modelTips[state.model] || modelTips.chatgpt;

      // Build context from answers
      var contextParts = [];
      if (state.goal) contextParts.push('Goal: ' + state.goal);
      Object.entries(state.answers).forEach(function(entry) {
        var key = entry[0], value = entry[1];
        var val = Array.isArray(value) ? value.join(', ') : value;
        if (val) {
          var label = LABEL_MAP[key] || key.charAt(0).toUpperCase() + key.slice(1);
          contextParts.push(label + ': ' + val);
        }
      });
      var contextBlock = contextParts.join('\n');

      // Build system prompt based on model
      var systemPrompt = '';
      if (state.model === 'claude') {
        systemPrompt = '<role>\nYou are a ' + template.role + '.\n' + template.systemPrefix + '\n</role>\n\n<context>\n' + (contextBlock || 'The user wants a high-quality deliverable tailored to their specific needs.') + '\n</context>\n\n<instructions>\n- Apply industry best practices at every step\n- Ask clarifying questions if requirements are ambiguous\n- Provide specific, actionable output (not generic advice)\n- Consider edge cases and potential issues proactively\n- Optimize for the stated goal and audience\n</instructions>\n\n<format>\nUse clear sections with headers. Provide concrete examples where helpful.\nThink through your approach in <thinking> tags before delivering the final output.\n</format>';
      } else if (state.model === 'gemini') {
        systemPrompt = '## Role & Expertise\nYou are a ' + template.role + '.\n' + template.systemPrefix + '\n\n## Context\n' + (contextBlock || 'The user wants a high-quality deliverable tailored to their specific needs.') + '\n\n## Instructions\n- Apply industry best practices at every step\n- Cite sources and data when making claims\n- Provide specific, actionable output (not generic advice)\n- Consider edge cases and potential issues proactively\n- When uncertain, note your confidence level and suggest verification steps\n\n## Output Format\nUse clear sections with **bold headers**. Include concrete examples and reference current best practices (2024-2025).';
      } else {
        systemPrompt = '## Role & Expertise\nYou are a ' + template.role + '.\n' + template.systemPrefix + '\n\n## Context\n' + (contextBlock || 'The user wants a high-quality deliverable tailored to their specific needs.') + '\n\n## Approach\n- Apply industry best practices at every step\n- Provide specific, actionable output (not generic advice)\n- Consider edge cases and potential issues proactively\n- Optimize for the stated goal and audience\n- When in doubt, ask clarifying questions before proceeding\n\n## Output Format\nUse markdown with clear ## headers for sections. Use numbered lists for sequential steps and bullet points for options. Include concrete examples.';
      }

      // Build ALL 6 task prompts (everything is free)
      var allTasks = template.tasks.map(function(task, i) {
        return {
          title: 'Task ' + (i + 1) + ': ' + task.title,
          prompt: buildTaskPrompt(task, template, model)
        };
      });

      // Build quick-start guide
      var quickStart = buildQuickStartGuide(template, model, cat);

      state.generatedPack = {
        systemPrompt: systemPrompt,
        allTasks: allTasks,
        quickStart: quickStart,
        checklist: template.checklist,
        model: model.name,
        category: cat
      };
    }

    function buildTaskPrompt(task, template, model) {
      var contextLines = [];
      if (state.goal) contextLines.push('Goal: ' + state.goal);

      var answers = state.answers || {};
      Object.entries(answers).forEach(function(entry) {
        var key = entry[0], value = entry[1];
        var val = Array.isArray(value) ? value.join(', ') : value;
        if (val) {
          var label = LABEL_MAP[key] || key.charAt(0).toUpperCase() + key.slice(1);
          contextLines.push(label + ': ' + val);
        }
      });

      var contextBlock = contextLines.length
        ? '\n\nContext from user:\n' + contextLines.map(function(l) { return '- ' + l; }).join('\n')
        : '';

      if (state.model === 'claude') {
        return '<task>\n## ' + task.title + '\n' + task.desc + contextBlock + '\n</task>\n\n<requirements>\n- Follow the system prompt context and guidelines above\n- Be specific and actionable \u2014 no generic filler\n- Include concrete examples, code, or templates where applicable\n- Consider all stated constraints from the context\n- Deliver output ready to use, not just advice\n- Tailor everything to the user\'s specific situation described above\n</requirements>';
      }

      if (state.model === 'gemini') {
        return '## ' + task.title + '\n\n' + task.desc + contextBlock + '\n\n**Requirements:**\n- Follow the system prompt guidelines above\n- Tailor output to the user\'s specific situation described above\n- Cite sources and current best practices (2024-2025)\n- Be specific and actionable \u2014 no generic filler\n- Include concrete examples where helpful\n- Note confidence level where claims are uncertain\n- Format with **bold headers** for scannability';
      }

      // ChatGPT default
      return '## ' + task.title + '\n\n' + task.desc + contextBlock + '\n\n**Requirements:**\n- Follow the system prompt guidelines above\n- Tailor output to the user\'s specific situation described above\n- Be specific and actionable \u2014 no generic filler\n- Include concrete examples where helpful\n- Consider the stated audience and constraints\n- Format the output for easy implementation';
    }

    function buildQuickStartGuide(template, model, cat) {
      var catName = cat.charAt(0).toUpperCase() + cat.slice(1);
      return '## Quick-Start Guide: ' + catName + ' Pack\n\n### How to use this pack:\n\n1. **Copy the System Prompt** into your AI\'s system/custom instructions\n2. **Start with Task 1** \u2014 paste it as your first message\n3. **Review the output** and provide feedback if needed\n4. **Continue with Tasks 2-6** sequentially\n5. **Run the Quality Checklist** before finalizing\n\n### ' + model.name + '-Specific Tips:\n' + model.tip + '\n\n### Quality Checklist:\n' + template.checklist.map(function(item) { return '- [ ] ' + item; }).join('\n') + '\n\n### Pro Tip:\nAfter completing all tasks, paste this: "Review everything you\'ve created against the quality checklist. Fix any issues and provide a final summary of what was delivered."';
    }


    /* --------------------------------------------------------------------------
       RENDER PACK RESULT
       -------------------------------------------------------------------------- */

    function showResult() {
      if (!dom.generatingState || !dom.packResult || !state.generatedPack) return;

      dom.generatingState.style.display = 'none';

      var pack = state.generatedPack;
      var taskCount = pack.allTasks.length;

      // Build result HTML -- all 6 tasks unlocked, no Pro upsell
      var html = '';

      // Header
      html += '<div class="step-pack__header">';
      html += '<h2 class="step-pack__title">Your pack is ready.</h2>';
      html += '<p class="step-pack__subtitle">Copy each section into ' + escapeHtml(pack.model) + '. Start with the System Prompt. All ' + taskCount + ' tasks included.</p>';
      html += '</div>';

      // System Prompt
      html += '<div class="pack-preview" data-section="system">';
      html += '<div class="pack-preview__header">';
      html += '<span class="pack-preview__label">SYSTEM PROMPT</span>';
      html += '<span class="pack-preview__title">The AI\'s brain \u2014 paste this first</span>';
      html += '<button class="btn btn--ghost btn--sm pack-copy-btn" data-target="pack-system">';
      html += '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>';
      html += ' Copy';
      html += '</button>';
      html += '</div>';
      html += '<pre class="pack-preview__content" id="pack-system">' + escapeHtml(pack.systemPrompt) + '</pre>';
      html += '</div>';

      // All 6 Task Prompts
      pack.allTasks.forEach(function(task, i) {
        html += '<div class="pack-preview" data-section="task-' + i + '">';
        html += '<div class="pack-preview__header">';
        html += '<span class="pack-preview__label">TASK PROMPT</span>';
        html += '<span class="pack-preview__title">' + escapeHtml(task.title) + '</span>';
        html += '<button class="btn btn--ghost btn--sm pack-copy-btn" data-target="pack-task-' + i + '">';
        html += '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>';
        html += ' Copy';
        html += '</button>';
        html += '</div>';
        html += '<pre class="pack-preview__content" id="pack-task-' + i + '">' + escapeHtml(task.prompt) + '</pre>';
        html += '</div>';
      });

      // Quick-Start Guide
      html += '<div class="pack-preview" data-section="guide">';
      html += '<div class="pack-preview__header">';
      html += '<span class="pack-preview__label">GUIDE</span>';
      html += '<span class="pack-preview__title">Quick-start guide</span>';
      html += '<button class="btn btn--ghost btn--sm pack-copy-btn" data-target="pack-guide">';
      html += '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>';
      html += ' Copy';
      html += '</button>';
      html += '</div>';
      html += '<pre class="pack-preview__content" id="pack-guide">' + escapeHtml(pack.quickStart) + '</pre>';
      html += '</div>';

      // Branding
      html += '<div class="pack-branding">';
      html += '<span class="pack-branding__text">Generated with</span>';
      html += '<a href="https://nextool.app" class="pack-branding__link">ANIMA</a>';
      html += '<span class="pack-branding__divider">&middot;</span>';
      html += '<span class="pack-branding__text">Your AI deserves expertise</span>';
      html += '</div>';

      // Actions
      html += '<div class="step-pack__actions">';
      html += '<button class="btn btn--primary btn--lg step-pack__copy-all" id="btn-copy-all-new">';
      html += '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>';
      html += ' Copy entire pack';
      html += '</button>';
      html += '<button class="btn btn--ghost btn--lg" id="btn-new-pack">';
      html += '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M12 5v14M5 12h14"/></svg>';
      html += ' Create another pack';
      html += '</button>';
      html += '</div>';

      // Share
      html += '<div class="step-pack__share">';
      html += '<span class="step-pack__share-label">Share your pack:</span>';
      html += '<div class="step-pack__share-buttons">';
      html += '<button class="btn btn--ghost btn--sm" id="btn-share-x">';
      html += '<svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>';
      html += ' Post on X';
      html += '</button>';
      html += '<button class="btn btn--ghost btn--sm" id="btn-share-linkedin">';
      html += '<svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>';
      html += ' LinkedIn';
      html += '</button>';
      html += '<button class="btn btn--ghost btn--sm" id="btn-share-copy-link">';
      html += '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg>';
      html += ' Copy link';
      html += '</button>';
      html += '</div>';
      html += '</div>';

      dom.packResult.innerHTML = html;

      // Bind copy buttons
      dom.packResult.querySelectorAll('.pack-copy-btn').forEach(function(btn) {
        btn.addEventListener('click', function(e) {
          e.stopPropagation();
          var targetId = btn.dataset.target;
          var content = document.getElementById(targetId);
          if (content) copyToClipboard(content.textContent, btn);
        });
      });

      // Bind copy all
      var copyAllBtn = document.getElementById('btn-copy-all-new');
      if (copyAllBtn) {
        copyAllBtn.addEventListener('click', function() {
          var parts = [state.generatedPack.systemPrompt, '', '---', ''];
          state.generatedPack.allTasks.forEach(function(t) {
            parts.push(t.prompt);
            parts.push('');
          });
          parts.push('---', '', state.generatedPack.quickStart, '', '---', 'Generated with ANIMA \u2014 https://nextool.app');
          copyToClipboard(parts.join('\n\n'), copyAllBtn);
        });
      }

      // Bind new pack button
      var newPackBtn = document.getElementById('btn-new-pack');
      if (newPackBtn) {
        newPackBtn.addEventListener('click', function() {
          state.answers = {};
          state.generatedPack = null;
          if (dom.goalInput) dom.goalInput.value = '';
          state.goal = '';
          updateCharCount();
          updateContinueButton();
          goToStep(1);
        });
      }

      // Share buttons
      var catName = (state.category || 'custom').charAt(0).toUpperCase() + (state.category || 'custom').slice(1);
      var shareText = encodeURIComponent('Just generated a free ' + catName + ' expertise pack for ' + pack.model + ' with ANIMA. This is incredible.\n\n');
      var shareUrl = encodeURIComponent('https://nextool.app/create/');

      var shareX = document.getElementById('btn-share-x');
      if (shareX) {
        shareX.addEventListener('click', function() {
          window.open('https://x.com/intent/tweet?text=' + shareText + '&url=' + shareUrl, '_blank', 'width=550,height=420');
        });
      }

      var shareLI = document.getElementById('btn-share-linkedin');
      if (shareLI) {
        shareLI.addEventListener('click', function() {
          window.open('https://www.linkedin.com/sharing/share-offsite/?url=' + shareUrl, '_blank', 'width=550,height=420');
        });
      }

      var shareCopyLink = document.getElementById('btn-share-copy-link');
      if (shareCopyLink) {
        shareCopyLink.addEventListener('click', function() {
          copyToClipboard('https://nextool.app/create/', shareCopyLink);
        });
      }

      // Make pack-preview headers toggle collapse
      dom.packResult.querySelectorAll('.pack-preview__header').forEach(function(header) {
        header.addEventListener('click', function(e) {
          // Don't toggle if clicking the copy button
          if (e.target.closest('.pack-copy-btn')) return;
          var preview = header.closest('.pack-preview');
          var isCollapsed = preview.getAttribute('data-collapsed') === 'true';
          preview.setAttribute('data-collapsed', isCollapsed ? 'false' : 'true');
        });
      });

      dom.packResult.classList.add('visible');
    }


    /* --------------------------------------------------------------------------
       COPY FUNCTIONALITY
       -------------------------------------------------------------------------- */

    function copyToClipboard(text, button) {
      var cleanText = text.trim();

      navigator.clipboard.writeText(cleanText).then(function() {
        showCopySuccess(button);
      }).catch(function() {
        // Fallback
        var textarea = document.createElement('textarea');
        textarea.value = cleanText;
        textarea.style.cssText = 'position:fixed;opacity:0;pointer-events:none';
        document.body.appendChild(textarea);
        textarea.select();
        try { document.execCommand('copy'); } catch (e) { /* silent */ }
        document.body.removeChild(textarea);
        showCopySuccess(button);
      });
    }

    function showCopySuccess(button) {
      var originalHTML = button.innerHTML;
      button.innerHTML = '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> Copied!';
      button.classList.add('btn--copy-success');

      setTimeout(function() {
        button.innerHTML = originalHTML;
        button.classList.remove('btn--copy-success');
      }, 2000);
    }


    /* --------------------------------------------------------------------------
       KEYBOARD SHORTCUTS
       -------------------------------------------------------------------------- */

    function initKeyboard() {
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          if (state.step > 1) {
            goToStep(state.step - 1);
          } else {
            window.location.href = '/';
          }
        }

        if ((e.metaKey || e.ctrlKey) && e.key === 'Enter') {
          if (state.step === 1 && dom.continueBtn && !dom.continueBtn.disabled) {
            dom.continueBtn.click();
          } else if (state.step === 2 && dom.generateBtn) {
            dom.generateBtn.click();
          }
        }
      });
    }


    /* --------------------------------------------------------------------------
       UTILITIES
       -------------------------------------------------------------------------- */

    function escapeHtml(str) {
      var div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }


    /* --------------------------------------------------------------------------
       INIT
       -------------------------------------------------------------------------- */

    function init() {
      loadUrlParams();
      initStep1();
      initStep2();
      initKeyboard();
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }

  })();
  </script>

  <script src="/js/analytics-lite.js" defer></script>
  <script src="/js/revenue.js" defer></script>
  <script src="/js/lead-capture.js" defer></script>
</body>
</html>
